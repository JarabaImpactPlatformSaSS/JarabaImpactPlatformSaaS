<?php

/**
 * @file
 * Defines the Currency entity and the Price field.
 */

use Drupal\commerce_price\Hook\CommercePriceHooks;
use Drupal\commerce_price\Hook\CommercePriceThemeHooks;
use Drupal\commerce_price\Hook\CommercePriceViewsHooks;
use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Hook\Attribute\LegacyHook;
use Drupal\field\FieldStorageConfigInterface;
use Drupal\language\Entity\ConfigurableLanguage;

/**
 * Implements hook_theme().
 */
#[LegacyHook]
function commerce_price_theme() {
  return \Drupal::service(CommercePriceThemeHooks::class)->theme();
}

/**
 * Implements hook_ENTITY_TYPE_insert() for 'configurable_language'.
 */
#[LegacyHook]
function commerce_price_configurable_language_insert(ConfigurableLanguage $language) {
  \Drupal::service(CommercePriceHooks::class)->configurableLanguageInsert($language);
}

/**
 * Implements hook_form_FORM_ID_alter().
 *
 * Removes the "Calculated price" formatter from views field options, if
 * it is not applicable. Since the formatter is product variation specific,
 * this prevents it from accidentally being used on other entity types.
 *
 * @todo Remove when https://www.drupal.org/node/2991660 gets fixed.
 */
#[LegacyHook]
function commerce_price_form_views_ui_config_item_form_alter(&$form, FormStateInterface $form_state): void {
  \Drupal::service(CommercePriceHooks::class)->formViewsUiConfigItemFormAlter($form, $form_state);
}

/**
 * Implements hook_field_views_data().
 *
 * Views integration for price fields.
 */
#[LegacyHook]
function commerce_price_field_views_data(FieldStorageConfigInterface $field_storage) {
  return \Drupal::service(CommercePriceViewsHooks::class)->fieldViewsData($field_storage);
}
