<?php

/**
 * @file
 * Provides tax functionality.
 */

use Drupal\commerce_tax\Hook\CommerceTaxHooks;
use Drupal\commerce_tax\Hook\CommerceTaxThemeHooks;
use Drupal\Core\Entity\EntityTypeInterface;
use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Hook\Attribute\LegacyHook;
use Drupal\field\FieldStorageConfigInterface;

/**
 * Implements hook_theme().
 */
#[LegacyHook]
function commerce_tax_theme() {
  return \Drupal::service(CommerceTaxThemeHooks::class)->theme();
}

/**
 * Implements hook_entity_base_field_info().
 */
#[LegacyHook]
function commerce_tax_entity_base_field_info(EntityTypeInterface $entity_type): array {
  return \Drupal::service(CommerceTaxHooks::class)->entityBaseFieldInfo($entity_type);
}

/**
 * Implements hook_ENTITY_TYPE_access().
 *
 * Forbids the profile "tax_number" field from being deletable.
 * This is an alternative to locking the field which still leaves
 * the field editable.
 */
#[LegacyHook]
function commerce_tax_field_storage_config_access(FieldStorageConfigInterface $field_storage, $operation) {
  return \Drupal::service(CommerceTaxHooks::class)->fieldStorageConfigAccess($field_storage, $operation);
}

/**
 * Implements hook_form_BASE_FORM_ID_alter() for 'commerce_store_form'.
 */
#[LegacyHook]
function commerce_tax_form_commerce_store_form_alter(&$form, FormStateInterface $form_state): void {
  \Drupal::service(CommerceTaxHooks::class)->formCommerceStoreFormAlter($form, $form_state);
}

/**
 * Implements hook_form_FORM_ID_alter() for 'commerce_order_item_type_form'.
 */
#[LegacyHook]
function commerce_tax_form_commerce_order_item_type_form_alter(array &$form, FormStateInterface $form_state): void {
  \Drupal::service(CommerceTaxHooks::class)->formCommerceOrderItemTypeFormAlter($form, $form_state);
}

/**
 * Implements hook_field_formatter_info_alter().
 */
#[LegacyHook]
function commerce_tax_field_formatter_info_alter(array &$info): void {
  \Drupal::service(CommerceTaxHooks::class)->fieldFormatterInfoAlter($info);
}

/**
 * Implements hook_field_widget_info_alter().
 */
#[LegacyHook]
function commerce_tax_field_widget_info_alter(array &$info): void {
  \Drupal::service(CommerceTaxHooks::class)->fieldWidgetInfoAlter($info);
}
