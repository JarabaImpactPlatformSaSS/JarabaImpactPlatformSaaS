# AUDIT-CONS-N05: Normalized all service IDs from jaraba_agroconecta.* to jaraba_agroconecta_core.*
# to match the canonical module name.
# Servicios del módulo AgroConecta Core
services:
  logger.channel.jaraba_agroconecta_core:
    parent: logger.channel_base
    arguments: ['jaraba_agroconecta_core']

  # AUDIT-CONS-N05: jaraba_agroconecta.product_service -> jaraba_agroconecta_core.product_service
  jaraba_agroconecta_core.product_service:
    class: Drupal\jaraba_agroconecta_core\Service\ProductAgroService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.factory'
      - '@ecosistema_jaraba_core.agroconecta_feature_gate'

  # AUDIT-CONS-N05: jaraba_agroconecta.producer_service -> jaraba_agroconecta_core.producer_service
  jaraba_agroconecta_core.producer_service:
    class: Drupal\jaraba_agroconecta_core\Service\ProducerProfileService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.factory'

  # AUDIT-CONS-N05: jaraba_agroconecta.marketplace_service -> jaraba_agroconecta_core.marketplace_service
  jaraba_agroconecta_core.marketplace_service:
    class: Drupal\jaraba_agroconecta_core\Service\MarketplaceService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@jaraba_agroconecta_core.product_service'
      - '@jaraba_agroconecta_core.producer_service'

  # AUDIT-CONS-N05: jaraba_agroconecta.order_service -> jaraba_agroconecta_core.order_service
  jaraba_agroconecta_core.order_service:
    class: Drupal\jaraba_agroconecta_core\Service\OrderService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.factory'
      - '@ecosistema_jaraba_core.agroconecta_feature_gate'

  # AUDIT-CONS-N05: jaraba_agroconecta.stripe_payment_service -> jaraba_agroconecta_core.stripe_payment_service
  jaraba_agroconecta_core.stripe_payment_service:
    class: Drupal\jaraba_agroconecta_core\Service\StripePaymentService
    arguments:
      - '@jaraba_foc.stripe_connect'
      - '@entity_type.manager'
      - '@logger.factory'
      - '@config.factory'
      - '@ecosistema_jaraba_core.agroconecta_feature_gate'

  # AUDIT-CONS-N05: jaraba_agroconecta.producer_dashboard_service -> jaraba_agroconecta_core.producer_dashboard_service
  jaraba_agroconecta_core.producer_dashboard_service:
    class: Drupal\jaraba_agroconecta_core\Service\ProducerDashboardService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@database'

  # Fase 4: Reviews + Notificaciones

  # AUDIT-CONS-N05: jaraba_agroconecta.review_service -> jaraba_agroconecta_core.review_service
  jaraba_agroconecta_core.review_service:
    class: Drupal\jaraba_agroconecta_core\Service\ReviewAgroService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.factory'

  # AUDIT-CONS-N05: jaraba_agroconecta.notification_service -> jaraba_agroconecta_core.notification_service
  jaraba_agroconecta_core.notification_service:
    class: Drupal\jaraba_agroconecta_core\Service\NotificationService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@plugin.manager.mail'
      - '@logger.factory'

  # Fase 5: Search & Discovery

  # AUDIT-CONS-N05: jaraba_agroconecta.search_service -> jaraba_agroconecta_core.search_service
  jaraba_agroconecta_core.search_service:
    class: Drupal\jaraba_agroconecta_core\Service\AgroSearchService
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@logger.factory'

  # Fase 5: Promotions & Coupons

  # AUDIT-CONS-N05: jaraba_agroconecta.promotion_service -> jaraba_agroconecta_core.promotion_service
  jaraba_agroconecta_core.promotion_service:
    class: Drupal\jaraba_agroconecta_core\Service\PromotionService
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@current_user'

  jaraba_agroconecta_core.fraud_rule.weight:
    class: Drupal\jaraba_agroconecta_core\Fraud\WeightDiscrepancyRule
    tags:
      - { name: jaraba_predictive.fraud_rule }

  # Fase 5: Shipping Core

  # AUDIT-CONS-N05: jaraba_agroconecta.shipping_service -> jaraba_agroconecta_core.shipping_service
  jaraba_agroconecta_core.shipping_service:
    class: Drupal\jaraba_agroconecta_core\Service\AgroShippingService
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@logger.channel.jaraba_agroconecta_core'
      - '@jaraba_agroconecta_core.carrier_manager'
      - '@?jaraba_pwa.push'
    tags:
      - { name: jaraba_ai_agents.tool }

  jaraba_agroconecta_core.carrier_manager:
    class: Drupal\jaraba_agroconecta_core\Shipping\CarrierManager

  jaraba_agroconecta_core.carrier_mrw:
    class: Drupal\jaraba_agroconecta_core\Shipping\MrwCarrierAdapter
    arguments: ['@http_client', '@logger.channel.jaraba_agroconecta_core']
    tags:
      - { name: jaraba_agroconecta_core_carrier }

  jaraba_agroconecta_core.carrier_seur:
    class: Drupal\jaraba_agroconecta_core\Shipping\SeurCarrierAdapter
    arguments: ['@http_client', '@logger.channel.jaraba_agroconecta_core']
    tags:
      - { name: jaraba_agroconecta_core_carrier }

  # Fase 6: Traceability + QR

  # AUDIT-CONS-N05: jaraba_agroconecta.traceability_service -> jaraba_agroconecta_core.traceability_service
  jaraba_agroconecta_core.traceability_service:
    class: Drupal\jaraba_agroconecta_core\Service\AgroTraceabilityService
    arguments:
      - '@entity_type.manager'
      - '@logger.factory'

  # AUDIT-CONS-N05: jaraba_agroconecta.qr_service -> jaraba_agroconecta_core.qr_service
  jaraba_agroconecta_core.qr_service:
    class: Drupal\jaraba_agroconecta_core\Service\QrAgroService
    arguments:
      - '@entity_type.manager'

  # Fase 7: Analytics

  # AUDIT-CONS-N05: jaraba_agroconecta.analytics_service -> jaraba_agroconecta_core.analytics_service
  jaraba_agroconecta_core.analytics_service:
    class: Drupal\jaraba_agroconecta_core\Service\AgroAnalyticsService
    arguments:
      - '@entity_type.manager'

  # Fase 9: Producer Copilot

  # AUDIT-CONS-N05: jaraba_agroconecta.copilot_service -> jaraba_agroconecta_core.copilot_service
  jaraba_agroconecta_core.copilot_service:
    class: Drupal\jaraba_agroconecta_core\Service\ProducerCopilotService
    arguments:
      - '@entity_type.manager'
      - '@jaraba_ai_agents.producer_copilot_agent'
      - '@ecosistema_jaraba_core.agroconecta_feature_gate'

  # Fase 9: Demand Forecaster (Doc 67 §4.4)

  # AUDIT-CONS-N05: jaraba_agroconecta.demand_forecaster -> jaraba_agroconecta_core.demand_forecaster
  jaraba_agroconecta_core.demand_forecaster:
    class: Drupal\jaraba_agroconecta_core\Service\DemandForecasterService
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@logger.channel.default'

  # Fase 9: Market Intelligence (Doc 67 §4.4)

  # AUDIT-CONS-N05: jaraba_agroconecta.market_spy -> jaraba_agroconecta_core.market_spy
  jaraba_agroconecta_core.market_spy:
    class: Drupal\jaraba_agroconecta_core\Service\MarketSpyService
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@logger.channel.default'

  # Fase 10: Cross-Sell Engine (Doc 68 §4.3)

  jaraba_agroconecta_core.cross_sell_engine:
    class: Drupal\jaraba_agroconecta_core\Service\CrossSellEngine
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@logger.channel.default'

  # Fase 10: Sales Agent

  jaraba_agroconecta_core.sales_agent:
    class: Drupal\jaraba_agroconecta_core\Service\SalesAgentService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.channel.default'

  # Fase 10: Cart Recovery (Doc 68 §4.4)

  jaraba_agroconecta_core.cart_recovery:
    class: Drupal\jaraba_agroconecta_core\Service\CartRecoveryService
    arguments:
      - '@entity_type.manager'
      - '@plugin.manager.mail'
      - '@logger.channel.default'

  # Fase 10: WhatsApp Business API (Doc 68 §5)

  jaraba_agroconecta_core.whatsapp:
    class: Drupal\jaraba_agroconecta_core\Service\WhatsAppApiService
    arguments:
      - '@http_client'
      - '@config.factory'
      - '@entity_type.manager'
      - '@logger.channel.default'

  # Fase 11: Partner Document Hub B2B (Sprint AC6-2)

  jaraba_agroconecta_core.partner_document:
    class: Drupal\jaraba_agroconecta_core\Service\PartnerDocumentService
    arguments:
      - '@entity_type.manager'

  # Breadcrumb builder for AgroConecta routes.
  jaraba_agroconecta_core.breadcrumb_builder:
    class: Drupal\jaraba_agroconecta_core\Breadcrumb\AgroConectaBreadcrumbBuilder
    tags:
      - { name: breadcrumb_builder, priority: 100 }

  # Plan Elevacion AgroConecta Clase Mundial v1 — Fase 2: CopilotBridge
  # AUDIT-CONS-N05: jaraba_agroconecta.copilot_bridge -> jaraba_agroconecta_core.copilot_bridge
  jaraba_agroconecta_core.copilot_bridge:
    class: Drupal\jaraba_agroconecta_core\Service\AgroConectaCopilotBridgeService
    arguments:
      - '@entity_type.manager'
      - '@ecosistema_jaraba_core.agroconecta_feature_gate'
      - '@logger.channel.jaraba_agroconecta_core'
