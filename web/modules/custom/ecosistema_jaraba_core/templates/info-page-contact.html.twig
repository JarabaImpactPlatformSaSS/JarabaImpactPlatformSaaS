{#
/**
 * @file info-page-contact.html.twig
 * Página de Contacto — /contacto
 *
 * Template Zero Region Policy con formulario de contacto funcional,
 * datos de contacto y Schema.org ContactPage.
 *
 * VARIABLES (desde InfoPagesController::contact()):
 * - content: string — HTML del contenido configurado en theme settings
 * - contact_email: string — Email de contacto
 * - contact_phone: string — Teléfono
 * - contact_address: string — Dirección
 *
 * DIRECTRICES:
 * - i18n: {% trans %} en todos los textos estáticos
 * - CSS: BEM .contact-page__*, var(--ej-*)
 * - A11Y: aria-*, for/id en labels, role alerts
 * - SEO: Schema.org ContactPage
 * - TWIG-XSS-001: Autoescaping
 *
 * @see \Drupal\ecosistema_jaraba_core\Controller\InfoPagesController::contact()
 */
#}

{{ attach_library('ecosistema_jaraba_theme/contact-form') }}

{# === HERO === #}
<section class="contact-page__hero reveal-element reveal-fade-up">
  <div class="contact-page__hero-container">
    <span class="contact-page__eyebrow">{% trans %}Estamos aquí para ayudarte{% endtrans %}</span>
    <h1 class="contact-page__title">{% trans %}Contacta con nosotros{% endtrans %}</h1>
    <p class="contact-page__subtitle">
      {% trans %}Cuéntanos tu proyecto, tu idea o tu duda. Te respondemos en menos de 24h laborables.{% endtrans %}
    </p>
  </div>
</section>

{# === GRID: Form + Info === #}
<section class="contact-page__grid reveal-element reveal-fade-up">
  <div class="contact-page__container">

    {# Columna izquierda: Formulario #}
    <div class="contact-page__form-col">
      <form id="contact-form"
            class="contact-page__form"
            novalidate
            aria-label="{% trans %}Formulario de contacto{% endtrans %}">

        <div class="contact-page__field">
          <label for="contact-name" class="contact-page__label">
            {% trans %}Nombre completo{% endtrans %} <span aria-hidden="true">*</span>
          </label>
          <input type="text" id="contact-name" name="name"
                 class="contact-page__input" required autocomplete="name"
                 placeholder="{% trans %}Tu nombre{% endtrans %}">
        </div>

        <div class="contact-page__field">
          <label for="contact-email" class="contact-page__label">
            {% trans %}Correo electrónico{% endtrans %} <span aria-hidden="true">*</span>
          </label>
          <input type="email" id="contact-email" name="email"
                 class="contact-page__input" required autocomplete="email"
                 placeholder="{% trans %}tu@email.com{% endtrans %}">
        </div>

        <div class="contact-page__field">
          <label for="contact-subject" class="contact-page__label">{% trans %}Asunto{% endtrans %}</label>
          <select id="contact-subject" name="subject" class="contact-page__select">
            <option value="">{% trans %}Selecciona un asunto{% endtrans %}</option>
            <option value="informacion">{% trans %}Información general{% endtrans %}</option>
            <option value="demo">{% trans %}Solicitar una demo{% endtrans %}</option>
            <option value="plan-empresa">{% trans %}Plan Empresa / Institucional{% endtrans %}</option>
            <option value="soporte">{% trans %}Soporte técnico{% endtrans %}</option>
            <option value="partnership">{% trans %}Colaboración / Partnership{% endtrans %}</option>
            <option value="otro">{% trans %}Otro{% endtrans %}</option>
          </select>
        </div>

        <div class="contact-page__field">
          <label for="contact-message" class="contact-page__label">
            {% trans %}Mensaje{% endtrans %} <span aria-hidden="true">*</span>
          </label>
          <textarea id="contact-message" name="message"
                    class="contact-page__textarea" required rows="5"
                    placeholder="{% trans %}¿En qué podemos ayudarte?{% endtrans %}"></textarea>
        </div>

        {# GDPR #}
        <div class="contact-page__field contact-page__field--checkbox">
          <input type="checkbox" id="contact-gdpr" name="gdpr_consent" required>
          <label for="contact-gdpr" class="contact-page__label contact-page__label--small">
            {% trans %}Acepto la <a href="/privacidad" target="_blank">política de privacidad</a> y el tratamiento de mis datos.{% endtrans %}
          </label>
        </div>

        {# Honeypot anti-bot #}
        <div class="contact-page__hp" aria-hidden="true" tabindex="-1">
          <input type="text" name="website" tabindex="-1" autocomplete="off">
        </div>

        <button type="submit" class="btn-primary btn-primary--large contact-page__submit" id="contact-submit">
          <span class="contact-page__submit-text">{% trans %}Enviar mensaje{% endtrans %}</span>
          <span class="contact-page__submit-loading" hidden>{% trans %}Enviando...{% endtrans %}</span>
        </button>

        <div id="contact-success" class="contact-page__message contact-page__message--success" hidden role="alert">
          {% trans %}¡Mensaje enviado! Te responderemos en menos de 24h laborables.{% endtrans %}
        </div>
        <div id="contact-error" class="contact-page__message contact-page__message--error" hidden role="alert"></div>
      </form>
    </div>

    {# Columna derecha: Info #}
    <div class="contact-page__info-col">
      <div class="contact-page__info-card">
        <h2 class="contact-page__info-title">{% trans %}Información de contacto{% endtrans %}</h2>

        {% if contact_email %}
          <div class="contact-page__info-item">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
              <rect x="2" y="4" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
              <path d="M2 6l8 5 8-5" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <div>
              <span class="contact-page__info-label">{% trans %}Email{% endtrans %}</span>
              <a href="mailto:{{ contact_email }}">{{ contact_email }}</a>
            </div>
          </div>
        {% endif %}

        {% if contact_phone %}
          <div class="contact-page__info-item">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
              <path d="M3 2h4l2 5-3 2a11 11 0 005 5l2-3 5 2v4a2 2 0 01-2 2A16 16 0 011 4a2 2 0 012-2z" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <div>
              <span class="contact-page__info-label">{% trans %}Teléfono{% endtrans %}</span>
              <a href="tel:{{ contact_phone|replace({' ': ''}) }}">{{ contact_phone }}</a>
            </div>
          </div>
        {% endif %}

        {% if contact_address %}
          <div class="contact-page__info-item">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
              <path d="M10 1C6.13 1 3 4.13 3 8c0 5.25 7 11 7 11s7-5.75 7-11c0-3.87-3.13-7-7-7z" stroke="currentColor" stroke-width="1.5"/>
              <circle cx="10" cy="8" r="2.5" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <div>
              <span class="contact-page__info-label">{% trans %}Dirección{% endtrans %}</span>
              <span>{{ contact_address }}</span>
            </div>
          </div>
        {% endif %}

        <div class="contact-page__info-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
            <path d="M10 5v5l3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <div>
            <span class="contact-page__info-label">{% trans %}Horario{% endtrans %}</span>
            <span>{% trans %}L-V, 9:00 - 18:00 (CET){% endtrans %}</span>
          </div>
        </div>
      </div>

      <a href="https://wa.me/34600000000" target="_blank" rel="noopener noreferrer"
         class="btn-secondary btn-secondary--large contact-page__wa-btn"
         data-track-cta="contact_whatsapp" data-track-position="contact_page">
        {% trans %}Escríbenos por WhatsApp{% endtrans %}
      </a>
    </div>

  </div>
</section>

{# Schema.org ContactPage #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ContactPage",
  "name": "{{ 'Contacto - Jaraba Impact Platform'|t }}",
  "mainEntity": {
    "@type": "Organization",
    "name": "Jaraba Impact Platform"
    {% if contact_email %},"email": "{{ contact_email }}"{% endif %}
    {% if contact_phone %},"telephone": "{{ contact_phone }}"{% endif %}
  }
}
</script>
