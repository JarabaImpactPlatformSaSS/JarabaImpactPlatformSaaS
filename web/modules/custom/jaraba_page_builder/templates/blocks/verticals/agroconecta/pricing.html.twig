{#
 # Template: AgroConecta - Cajas de Suscripción
 # Category: agroconecta
 # Type: pricing
 #
 # Header + 3 pricing cards
 # Premium: animations, annual/monthly toggle, jaraba_icon checkmarks, featured ribbon
 # - Usa jaraba_icon(category, name, { variant, size, color }) para iconos
 #}
<section class="pb-section pb-section--pricing pb-section--agroconecta jaraba-block jaraba-block--premium"
         aria-label="{{ title|default('Nuestras Cajas')|t }}"
         data-effect="fade-up">
  <div class="pb-section__container">
    <div class="pb-section__header">
      <span class="pb-section__eyebrow">{{ eyebrow|default('Suscripciones')|t }}</span>
      <h2 class="pb-section__title">{{ title|default('Elige tu caja de productos frescos')|t }}</h2>
      <p class="pb-section__subtitle">{{ subtitle|default('Recibe productos de temporada directamente del productor cada semana.')|t }}</p>
    </div>
    {% if show_toggle|default(false) %}
      <div class="pb-section__pricing-toggle" role="radiogroup" aria-label="{{ 'Frecuencia de pago'|t }}">
        <button type="button"
                class="pb-section__pricing-toggle-btn pb-section__pricing-toggle-btn--active"
                data-pricing-period="weekly"
                aria-pressed="true">
          {{ toggle_label_weekly|default('Semanal')|t }}
        </button>
        <button type="button"
                class="pb-section__pricing-toggle-btn"
                data-pricing-period="monthly"
                aria-pressed="false">
          {{ toggle_label_monthly|default('Mensual')|t }}
          {% if toggle_discount|default('') %}
            <span class="pb-section__pricing-toggle-discount">{{ toggle_discount }}</span>
          {% endif %}
        </button>
      </div>
    {% endif %}
    <div class="pb-section__pricing-grid">
      {% set default_plans = [
        { name: 'Caja Huerta', price: '19€', period: '/semana', featured: false, cta: 'Suscribirse', features: ['5 kg de verduras', 'Productos de temporada', 'Entrega semanal'] },
        { name: 'Caja Familiar', price: '35€', period: '/semana', featured: true, badge: 'Más popular', cta: 'Probar ahora', features: ['10 kg verduras y fruta', 'Recetas incluidas', 'Entrega flexible', 'Productos orgánicos'] },
        { name: 'Caja Gourmet', price: '55€', period: '/semana', featured: false, cta: 'Contactar', features: ['Todo en Familiar', 'Quesos artesanales', 'Aceite de oliva', 'Productos premium'] }
      ] %}
      {% set items = plans|default(default_plans) %}
      {% for plan in items %}
        <div class="pb-section__pricing-card{{ plan.featured|default(false) ? ' pb-section__pricing-card--featured' : '' }}"
             aria-label="{{ 'Plan @name por @price @period'|t({'@name': plan.name|default('Plan'), '@price': plan.price|default('0€'), '@period': plan.period|default('/semana')}) }}"
             data-effect="fade-up"
             data-delay="{{ loop.index0 * 150 }}">
          {% if plan.featured|default(false) %}
            <div class="pb-section__pricing-ribbon" aria-hidden="true">
              {{ jaraba_icon('ui', 'star', { variant: 'filled', size: '14px', color: 'warning' }) }}
            </div>
          {% endif %}
          {% if plan.badge|default('') %}
            <span class="pb-section__pricing-badge">{{ plan.badge|t }}</span>
          {% endif %}
          <h3 class="pb-section__pricing-name">{{ plan.name|default('Plan')|t }}</h3>
          <div class="pb-section__pricing-price">{{ plan.price|default('0€') }}</div>
          <div class="pb-section__pricing-period">{{ plan.period|default('/semana')|t }}</div>
          <ul class="pb-section__pricing-features">
            {% for feature in plan.features|default([]) %}
              <li>
                <span class="pb-section__pricing-check" aria-hidden="true">{{ jaraba_icon('ui', 'check', { size: '16px', color: 'success' }) }}</span>
                {{ feature|t }}
              </li>
            {% endfor %}
          </ul>
          <a href="{{ plan.url|default('#') }}" class="pb-section__cta pb-section__cta--primary">
            {{ plan.cta|default('Elegir plan')|t }}
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
</section>
