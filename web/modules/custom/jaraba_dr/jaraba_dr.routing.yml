# =============================================================================
# DASHBOARD FRONTEND -- Zero region, template page--dr.html.twig
# =============================================================================

jaraba_dr.dashboard:
  path: '/dr'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrDashboardController::dashboard'
    _title: 'Disaster Recovery'
  requirements:
    _permission: 'view dr dashboard'

# =============================================================================
# STATUS PAGE PUBLICA -- Sin autenticacion
# =============================================================================

jaraba_dr.status_page:
  path: '/status'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\StatusPageController::page'
    _title: 'Estado de los servicios'
  requirements:
    _access: 'TRUE'

# =============================================================================
# CONFIGURACION -- Formulario de settings del modulo
# =============================================================================

jaraba_dr.settings:
  path: '/admin/config/jaraba/dr'
  defaults:
    _form: '\Drupal\jaraba_dr\Form\DrSettingsForm'
    _title: 'Configuracion de Disaster Recovery'
  requirements:
    _permission: 'administer dr'

# =============================================================================
# ENTITY ROUTES -- Field UI base routes para configuracion de campos
# =============================================================================

jaraba_dr.dr_test_result.settings:
  path: '/admin/structure/dr-test-results'
  defaults:
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
    _title: 'DR Test Results'
  requirements:
    _permission: 'administer dr'

jaraba_dr.dr_incident.settings:
  path: '/admin/structure/dr-incidents'
  defaults:
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
    _title: 'DR Incidents'
  requirements:
    _permission: 'administer dr'

jaraba_dr.backup_verification.settings:
  path: '/admin/structure/backup-verifications'
  defaults:
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
    _title: 'Backup Verifications'
  requirements:
    _permission: 'administer dr'

# =============================================================================
# API REST ENDPOINTS -- 8 endpoints para integracion externa
# =============================================================================

# GET /api/v1/dr/status -- Estado general publico (sin autenticacion)
jaraba_dr.api.status:
  path: '/api/v1/dr/status'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getStatus'
  methods: [GET]
  requirements:
    _access: 'TRUE'

# GET /api/v1/dr/services -- Estado de servicios monitorizados
jaraba_dr.api.services:
  path: '/api/v1/dr/services'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getServicesStatus'
  methods: [GET]
  requirements:
    _permission: 'access dr api'

# GET /api/v1/dr/incidents -- Listado de incidentes activos
jaraba_dr.api.incidents:
  path: '/api/v1/dr/incidents'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getIncidents'
  methods: [GET]
  requirements:
    _permission: 'access dr api'

# GET /api/v1/dr/incidents/{id} -- Detalle de un incidente
jaraba_dr.api.incident_detail:
  path: '/api/v1/dr/incidents/{id}'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getIncidentDetail'
  methods: [GET]
  requirements:
    _permission: 'access dr api'
    id: '\d+'

# POST /api/v1/dr/backups/verify -- Verificar integridad de backup
jaraba_dr.api.backups_verify:
  path: '/api/v1/dr/backups/verify'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::verifyBackup'
  methods: [POST]
  requirements:
    _permission: 'access dr api'

# GET /api/v1/dr/tests -- Historial de tests DR
jaraba_dr.api.tests:
  path: '/api/v1/dr/tests'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getTestHistory'
  methods: [GET]
  requirements:
    _permission: 'access dr api'

# POST /api/v1/dr/tests/run -- Ejecutar un test DR
jaraba_dr.api.tests_run:
  path: '/api/v1/dr/tests/run'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::runTest'
  methods: [POST]
  requirements:
    _permission: 'execute dr tests'

# GET /api/v1/dr/metrics -- Metricas agregadas de DR
jaraba_dr.api.metrics:
  path: '/api/v1/dr/metrics'
  defaults:
    _controller: '\Drupal\jaraba_dr\Controller\DrApiController::getMetrics'
  methods: [GET]
  requirements:
    _permission: 'access dr api'
