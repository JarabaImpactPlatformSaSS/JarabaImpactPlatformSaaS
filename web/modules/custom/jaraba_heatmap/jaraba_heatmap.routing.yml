# Rutas del módulo Jaraba Heatmap
# Ref: Doc Técnico #180 - Native Heatmaps System

# =============================================================================
# API: Colector de Eventos (POST)
# =============================================================================

jaraba_heatmap.collect:
  path: '/api/heatmap/collect'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapCollectorController::collect'
  methods: [POST]
  requirements:
    _access: 'TRUE'
  options:
    no_cache: TRUE

# =============================================================================
# API: Consulta de Datos (GET)
# =============================================================================

jaraba_heatmap.pages:
  path: '/api/heatmap/pages'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::listPages'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'

jaraba_heatmap.page_clicks:
  path: '/api/heatmap/pages/{path}/clicks'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::getClickData'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'
    path: .+

jaraba_heatmap.page_scroll:
  path: '/api/heatmap/pages/{path}/scroll'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::getScrollData'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'
    path: .+

jaraba_heatmap.page_movement:
  path: '/api/heatmap/pages/{path}/movement'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::getMovementData'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'
    path: .+

jaraba_heatmap.summary:
  path: '/api/heatmap/summary'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::getSummary'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'

# =============================================================================
# Frontend: Dashboard de Heatmap Analytics
# Ref: Spec 20260130a §8, §9
# =============================================================================

jaraba_heatmap.analytics_dashboard:
  path: '/heatmap/analytics'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapDashboardController::dashboard'
    _title_callback: '\Drupal\jaraba_heatmap\Controller\HeatmapDashboardController::getTitle'
  requirements:
    _permission: 'access heatmap data'

# =============================================================================
# Administración: Configuración
# =============================================================================

jaraba_heatmap.settings:
  path: '/admin/config/jaraba/heatmap'
  defaults:
    _form: '\Drupal\jaraba_heatmap\Form\HeatmapSettingsForm'
    _title: 'Configuración de Heatmaps'
  requirements:
    _permission: 'administer heatmap settings'
  options:
    _admin_route: TRUE

# =============================================================================
# API: Screenshots para Overlay de Heatmap
# Ref: Spec 20260130a §6.1, §7.2
# =============================================================================

jaraba_heatmap.screenshot.get:
  path: '/api/heatmap/pages/{page_path}/screenshot'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::getScreenshot'
  methods: [GET]
  requirements:
    _permission: 'access heatmap data'
    page_path: .+

jaraba_heatmap.screenshot.capture:
  path: '/api/heatmap/pages/{page_path}/screenshot'
  defaults:
    _controller: '\Drupal\jaraba_heatmap\Controller\HeatmapApiController::captureScreenshot'
  methods: [POST]
  requirements:
    _permission: 'administer heatmap settings'
    page_path: .+
