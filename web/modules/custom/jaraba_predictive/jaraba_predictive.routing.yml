# -------------------------------------------------------------------
# Estructura: Rutas del modulo jaraba_predictive
# Logica: Dashboard zero-region + API REST envelope + Entity settings
# -------------------------------------------------------------------

# === Dashboard (zero-region pattern) ===
jaraba_predictive.dashboard:
  path: '/predictions'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveDashboardController::dashboard'
    _title: 'Predicciones y Analytics'
  requirements:
    _permission: 'access predictions'

# === API — Churn ===
jaraba_predictive.api.churn.predict:
  path: '/api/v1/predictions/churn/predict'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::predictChurn'
  requirements:
    _permission: 'access predictions api'
  methods: [POST]

jaraba_predictive.api.churn.history:
  path: '/api/v1/predictions/churn/history'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::churnHistory'
  requirements:
    _permission: 'access predictions api'
  methods: [GET]

jaraba_predictive.api.churn.batch:
  path: '/api/v1/predictions/churn/batch'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::churnBatch'
  requirements:
    _permission: 'execute predictions'
  methods: [POST]

# === API — Lead Scoring ===
jaraba_predictive.api.leads.score:
  path: '/api/v1/predictions/leads/score'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::scoreLead'
  requirements:
    _permission: 'access predictions api'
  methods: [POST]

jaraba_predictive.api.leads.batch:
  path: '/api/v1/predictions/leads/batch'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::leadBatch'
  requirements:
    _permission: 'execute predictions'
  methods: [POST]

jaraba_predictive.api.leads.event:
  path: '/api/v1/predictions/leads/{lead_score}/events'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::trackLeadEvent'
  requirements:
    _permission: 'access predictions api'
    lead_score: \d+
  methods: [POST]

# === API — Forecast ===
jaraba_predictive.api.forecast.mrr:
  path: '/api/v1/predictions/forecast/mrr'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::forecastMrr'
  requirements:
    _permission: 'access predictions api'
  methods: [GET]

# === API — Anomalies ===
jaraba_predictive.api.anomalies:
  path: '/api/v1/predictions/anomalies'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::detectAnomalies'
  requirements:
    _permission: 'access predictions api'
  methods: [GET]

# === API — Stats ===
jaraba_predictive.api.stats:
  path: '/api/v1/predictions/stats'
  defaults:
    _controller: '\Drupal\jaraba_predictive\Controller\PredictiveApiController::getStats'
  requirements:
    _permission: 'access predictions api'
  methods: [GET]

# === Entity settings ===
jaraba_predictive.churn_prediction.settings:
  path: '/admin/structure/churn-predictions/settings'
  defaults:
    _form: '\Drupal\jaraba_predictive\Form\PredictiveSettingsForm'
    _title: 'Configuracion de Predicciones de Churn'
  requirements:
    _permission: 'administer predictions'

jaraba_predictive.lead_score.settings:
  path: '/admin/structure/lead-scores/settings'
  defaults:
    _form: '\Drupal\jaraba_predictive\Form\PredictiveSettingsForm'
    _title: 'Configuracion de Lead Scoring'
  requirements:
    _permission: 'administer predictions'

jaraba_predictive.forecast.settings:
  path: '/admin/structure/forecasts/settings'
  defaults:
    _form: '\Drupal\jaraba_predictive\Form\PredictiveSettingsForm'
    _title: 'Configuracion de Forecasting'
  requirements:
    _permission: 'administer predictions'
