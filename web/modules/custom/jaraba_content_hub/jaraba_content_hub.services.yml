services:
  # Logger channel
  logger.channel.jaraba_content_hub:
    parent: logger.channel_base
    arguments: ['jaraba_content_hub']

  # Article Service
  jaraba_content_hub.article_service:
    class: Drupal\jaraba_content_hub\Service\ArticleService
    arguments:
      - '@entity_type.manager'
      - '@current_user'
      - '@logger.channel.jaraba_content_hub'
      - '@database'

  # Category Service
  jaraba_content_hub.category_service:
    class: Drupal\jaraba_content_hub\Service\CategoryService
    arguments:
      - '@entity_type.manager'
      - '@logger.channel.jaraba_content_hub'

  # SEO Service
  jaraba_content_hub.seo_service:
    class: Drupal\jaraba_content_hub\Service\SeoService
    arguments:
      - '@logger.channel.jaraba_content_hub'
      - '@file_url_generator'

  # Content Writer AI Agent — Gen 1, kept for backwards compatibility
  jaraba_content_hub.content_writer_agent:
    class: Drupal\jaraba_content_hub\Agent\ContentWriterAgent
    arguments:
      - '@?ai.provider'
      - '@config.factory'
      - '@logger.channel.jaraba_content_hub'
      - '@?jaraba_ai_agents.tenant_brand_voice'
      - '@?jaraba_ai_agents.observability'
      - '@entity_type.manager'
      - '@current_user'
      - '@?jaraba_billing.tenant_metering'

  # S5-01: Smart Gen 2 Content Writer — model routing, memory, tools
  jaraba_content_hub.smart_content_writer_agent:
    class: Drupal\jaraba_content_hub\Agent\SmartContentWriterAgent
    arguments:
      - '@?ai.provider'
      - '@config.factory'
      - '@logger.channel.jaraba_content_hub'
      - '@?jaraba_ai_agents.tenant_brand_voice'
      - '@?jaraba_ai_agents.observability'
      - '@?jaraba_ai_agents.model_router'
      - '@?ecosistema_jaraba_core.unified_prompt_builder'
      - '@?jaraba_ai_agents.tool_registry'
      - '@?jaraba_ai_agents.provider_fallback'
      - '@?jaraba_ai_agents.context_window_manager'
      - '@?entity_type.manager'
      - '@?current_user'
      - '@?jaraba_billing.tenant_metering'
    calls:
      - [setCostAlertService, ['@?ecosistema_jaraba_core.cost_alert']]

  # Writing Assistant Service
  jaraba_content_hub.writing_assistant:
    class: Drupal\jaraba_content_hub\Service\WritingAssistantService
    arguments:
      - '@jaraba_content_hub.content_writer_agent'
      - '@entity_type.manager'
      - '@logger.channel.jaraba_content_hub'

  # Newsletter Bridge
  jaraba_content_hub.newsletter_bridge:
    class: Drupal\jaraba_content_hub\Service\NewsletterBridgeService
    arguments:
      - '@entity_type.manager'
      - '@logger.channel.jaraba_content_hub'
    tags:
      - { name: jaraba_ai_agents.tool }

  # F.4 Recommendations Services

  # Content Embedding Service
  jaraba_content_hub.content_embedding:
    class: Drupal\jaraba_content_hub\Service\ContentEmbeddingService
    arguments:
      - '@?ai.provider'
      - '@logger.channel.jaraba_content_hub'

  # Qdrant Content Client
  jaraba_content_hub.qdrant_content:
    class: Drupal\jaraba_content_hub\Service\QdrantContentClient
    arguments:
      - '@http_client'
      - '@config.factory'
      - '@logger.factory'

  # Recommendation Service
  jaraba_content_hub.recommendation_service:
    class: Drupal\jaraba_content_hub\Service\RecommendationService
    arguments:
      - '@entity_type.manager'
      - '@jaraba_content_hub.content_embedding'
      - '@jaraba_content_hub.qdrant_content'
      - '@logger.factory'

  # Sentiment Analysis Engine
  jaraba_content_hub.sentiment_engine:
    class: Drupal\jaraba_content_hub\Service\SentimentEngineService
    arguments:
      - '@logger.channel.jaraba_content_hub'

  # ParamConverter: Article Slug to Entity
  jaraba_content_hub.paramconverter.article_slug:
    class: Drupal\jaraba_content_hub\ParamConverter\ContentArticleSlugConverter
    arguments:
      - '@entity_type.manager'
    tags:
      - { name: paramconverter, priority: 10 }

  # Reputation Monitor Service
  jaraba_content_hub.reputation_monitor:
    class: Drupal\jaraba_content_hub\Service\ReputationMonitorService
    arguments:
      - '@?jaraba_pwa.push'
      - '@logger.channel.jaraba_content_hub'

  # RSS Feed Service
  jaraba_content_hub.rss_service:
    class: Drupal\jaraba_content_hub\Service\RssService
    arguments:
      - '@jaraba_content_hub.article_service'
      - '@logger.channel.jaraba_content_hub'
      - '@file_url_generator'
