jaraba_customer_success.settings:
  type: config_object
  label: 'Customer Success settings'
  mapping:
    health_score_weights:
      type: mapping
      label: 'Health Score weights'
      mapping:
        engagement:
          type: integer
          label: 'Engagement weight'
        adoption:
          type: integer
          label: 'Adoption weight'
        satisfaction:
          type: integer
          label: 'Satisfaction weight'
        support:
          type: integer
          label: 'Support weight'
        growth:
          type: integer
          label: 'Growth weight'
    health_score_thresholds:
      type: mapping
      label: 'Health Score thresholds'
      mapping:
        healthy:
          type: integer
          label: 'Healthy threshold'
        neutral:
          type: integer
          label: 'Neutral threshold'
        at_risk:
          type: integer
          label: 'At risk threshold'
    calculation_interval:
      type: integer
      label: 'Calculation interval (hours)'
    cron_batch_size:
      type: integer
      label: 'Cron batch size'
    churn_model_version:
      type: string
      label: 'Churn model version'
    playbook_max_retries:
      type: integer
      label: 'Playbook max retries'
    nps_survey_cooldown:
      type: integer
      label: 'NPS survey cooldown (days)'
    expansion_usage_threshold:
      type: integer
      label: 'Expansion usage threshold (%)'
    alert_channels:
      type: sequence
      label: 'Alert channels'
      sequence:
        type: string
        label: 'Channel'

jaraba_customer_success.retention_profile.*:
  type: config_object
  label: 'Vertical Retention Profile configuration'
  mapping:
    vertical_id:
      type: string
      label: 'Vertical machine name'
    label:
      type: label
      label: 'Vertical display name'
    max_inactivity_days:
      type: integer
      label: 'Maximum inactivity days'
    health_score_weights:
      type: mapping
      label: 'Health score weights'
      mapping:
        engagement:
          type: integer
          label: 'Engagement weight'
        adoption:
          type: integer
          label: 'Adoption weight'
        satisfaction:
          type: integer
          label: 'Satisfaction weight'
        support:
          type: integer
          label: 'Support weight'
        growth:
          type: integer
          label: 'Growth weight'
    seasonality_calendar:
      type: sequence
      label: 'Seasonality calendar'
      sequence:
        type: mapping
        mapping:
          month:
            type: integer
            label: 'Month number'
          risk_level:
            type: string
            label: 'Risk level'
          label:
            type: string
            label: 'Month label'
          adjustment:
            type: float
            label: 'Seasonal adjustment'
    churn_risk_signals:
      type: sequence
      label: 'Churn risk signals'
      sequence:
        type: mapping
        mapping:
          signal_id:
            type: string
            label: 'Signal ID'
          metric:
            type: string
            label: 'Metric name'
          operator:
            type: string
            label: 'Comparison operator'
          threshold:
            type: integer
            label: 'Threshold value'
          lookback_days:
            type: integer
            label: 'Lookback days'
          weight:
            type: float
            label: 'Signal weight'
          description:
            type: string
            label: 'Signal description'
    critical_features:
      type: sequence
      label: 'Critical features'
      sequence:
        type: string
        label: 'Feature name'
    reengagement_triggers:
      type: sequence
      label: 'Re-engagement triggers'
      sequence:
        type: mapping
        mapping:
          trigger:
            type: string
            label: 'Trigger name'
          message_template:
            type: string
            label: 'Message template'
          delay_days:
            type: integer
            label: 'Delay days'
    upsell_signals:
      type: sequence
      label: 'Upsell signals'
      sequence:
        type: mapping
        mapping:
          signal:
            type: string
            label: 'Signal name'
          recommended_plan:
            type: string
            label: 'Recommended plan'
          message:
            type: string
            label: 'Upsell message'
    seasonal_offers:
      type: sequence
      label: 'Seasonal offers'
      sequence:
        type: mapping
        mapping:
          months:
            type: sequence
            label: 'Active months'
            sequence:
              type: integer
              label: 'Month number'
          offer_type:
            type: string
            label: 'Offer type'
          description:
            type: string
            label: 'Offer description'
    expected_usage_pattern:
      type: mapping
      label: 'Expected usage pattern by month'
    playbook_overrides:
      type: mapping
      label: 'Playbook overrides by trigger type'
