{#
/**
 * @file
 * Single connector card for the marketplace grid.
 *
 * Available variables:
 * - connector: Connector data array with keys:
 *   - id: int
 *   - name: string
 *   - description: string
 *   - category: string
 *   - icon: string
 *   - logo_url: string
 *   - provider: string
 *   - version: string
 *   - install_count: int
 *   - rating: float
 */
#}
<article class="connector-tile" data-connector-id="{{ connector.id }}">
  <div class="connector-tile__icon">
    {% if connector.logo_url %}
      <img src="{{ connector.logo_url }}" alt="{{ connector.name }}" class="connector-tile__logo" loading="lazy" />
    {% else %}
      <span class="connector-tile__icon-fallback">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
        </svg>
      </span>
    {% endif %}
  </div>

  <div class="connector-tile__body">
    <h3 class="connector-tile__name">{{ connector.name }}</h3>
    <p class="connector-tile__provider">{{ 'by %provider'|t({'%provider': connector.provider|default('Unknown')}) }}</p>

    <div class="connector-tile__rating" aria-label="{{ 'Rating: %rating out of 5'|t({'%rating': connector.rating|default(0)|number_format(1)}) }}">
      {% set rating = connector.rating|default(0) %}
      {% for i in 1..5 %}
        {% if i <= rating|round(0, 'floor') %}
          <span class="connector-tile__star connector-tile__star--filled">&#9733;</span>
        {% else %}
          <span class="connector-tile__star">&#9734;</span>
        {% endif %}
      {% endfor %}
      <span class="connector-tile__rating-value">{{ rating|number_format(1) }}</span>
    </div>

    <p class="connector-tile__description">
      {{ connector.description|length > 120 ? connector.description|slice(0, 120) ~ '...' : connector.description }}
    </p>
  </div>

  <div class="connector-tile__footer">
    <span class="connector-tile__installs">
      {{ '%count installs'|t({'%count': connector.install_count|default(0)}) }}
    </span>
    <span class="connector-tile__category connector-tile__category--{{ connector.category }}">
      {{ connector.category }}
    </span>
    <button
      class="connector-tile__install-btn"
      data-action="install"
      data-connector-id="{{ connector.id }}"
      type="button"
    >
      {{ 'Install'|t }}
    </button>
  </div>
</article>
