{#
/**
 * @file
 * Template para la landing del diagnostico express de empleabilidad.
 *
 * Wizard de 3 pasos con preguntas interactivas.
 * Acceso publico, zero-region, full-width mobile-first.
 *
 * Variables:
 *   - questions: Array de preguntas con opciones.
 *   - estimated_time: Tiempo estimado del diagnostico.
 */
#}

<div class="ej-diagnostic" data-diagnostic-wizard>
  {# Hero section #}
  <div class="ej-diagnostic__hero">
    <div class="ej-diagnostic__hero-content">
      <span class="ej-diagnostic__badge">{{ 'Diagnostico Express'|t }}</span>
      <h1 class="ej-diagnostic__title">
        {{ 'Descubre tu perfil de empleabilidad en 2 minutos'|t }}
      </h1>
      <p class="ej-diagnostic__subtitle">
        {{ 'Responde 3 preguntas y obtendras tu score, tu perfil y un plan de accion personalizado.'|t }}
      </p>
      <div class="ej-diagnostic__meta">
        {{ jaraba_icon('ui', 'clock', { size: '16px' }) }}
        <span>{{ estimated_time }}</span>
        <span class="ej-diagnostic__separator">|</span>
        {{ jaraba_icon('ui', 'check', { size: '16px' }) }}
        <span>{{ '100% gratuito'|t }}</span>
      </div>
      <button type="button" class="ej-diagnostic__start-btn" data-diagnostic-start>
        {{ 'Empezar diagnostico'|t }}
      </button>
    </div>
  </div>

  {# Progress bar #}
  <div class="ej-diagnostic__progress" data-diagnostic-progress style="display: none;">
    <div class="ej-diagnostic__progress-bar">
      <div class="ej-diagnostic__progress-fill" data-progress-fill style="width: 0%"></div>
    </div>
    <span class="ej-diagnostic__progress-text" data-progress-text>{{ 'Paso 1 de 3'|t }}</span>
  </div>

  {# Wizard steps #}
  <div class="ej-diagnostic__wizard" data-diagnostic-steps style="display: none;">
    {% for question in questions %}
      <div class="ej-diagnostic__step" data-step="{{ loop.index }}" {% if not loop.first %}style="display: none;"{% endif %}>
        <div class="ej-diagnostic__step-header">
          <span class="ej-diagnostic__step-number">{{ loop.index }}/{{ questions|length }}</span>
          <h2 class="ej-diagnostic__step-title">{{ question.title }}</h2>
          <p class="ej-diagnostic__step-description">{{ question.description }}</p>
        </div>

        <div class="ej-diagnostic__options" data-question-id="{{ question.id }}">
          {% for value, label in question.options %}
            <button type="button"
                    class="ej-diagnostic__option"
                    data-question="{{ question.id }}"
                    data-value="{{ value }}">
              <span class="ej-diagnostic__option-value">{{ value }}</span>
              <span class="ej-diagnostic__option-label">{{ label }}</span>
            </button>
          {% endfor %}
        </div>
      </div>
    {% endfor %}

    {# Email capture (opcional) #}
    <div class="ej-diagnostic__step ej-diagnostic__step--email" data-step="email" style="display: none;">
      <div class="ej-diagnostic__step-header">
        <h2 class="ej-diagnostic__step-title">{{ 'Casi listo'|t }}</h2>
        <p class="ej-diagnostic__step-description">
          {{ 'Deja tu email para recibir tu plan de accion personalizado y recursos gratuitos.'|t }}
        </p>
      </div>
      <div class="ej-diagnostic__email-form">
        <input type="email"
               class="ej-diagnostic__email-input"
               data-diagnostic-email
               placeholder="{{ 'tu@email.com'|t }}" />
        <button type="button" class="ej-diagnostic__submit-btn" data-diagnostic-submit>
          {{ 'Ver mis resultados'|t }}
        </button>
        <button type="button" class="ej-diagnostic__skip-btn" data-diagnostic-skip>
          {{ 'Saltar y ver resultados'|t }}
        </button>
      </div>
    </div>
  </div>

  {# Results section (rendered by JS after API response) #}
  <div class="ej-diagnostic__results" data-diagnostic-results style="display: none;">
    {# Score ring SVG #}
    <div class="ej-diagnostic__score-container">
      <svg class="ej-diagnostic__score-ring" viewBox="0 0 120 120">
        <circle class="ej-diagnostic__score-bg" cx="60" cy="60" r="54" fill="none" stroke="var(--ej-border-color, #e5e7eb)" stroke-width="8"/>
        <circle class="ej-diagnostic__score-arc" cx="60" cy="60" r="54" fill="none" stroke="var(--ej-primary, #4F46E5)" stroke-width="8" stroke-linecap="round" stroke-dasharray="339.3" stroke-dashoffset="339.3" data-score-arc transform="rotate(-90, 60, 60)"/>
        <text class="ej-diagnostic__score-value" x="60" y="55" text-anchor="middle" data-score-value>0</text>
        <text class="ej-diagnostic__score-label" x="60" y="75" text-anchor="middle">{{ 'de 10'|t }}</text>
      </svg>
    </div>

    {# Profile result #}
    <div class="ej-diagnostic__profile" data-profile-section>
      <h2 class="ej-diagnostic__profile-title" data-profile-label></h2>
      <p class="ej-diagnostic__profile-description" data-profile-description></p>
    </div>

    {# Dimension scores #}
    <div class="ej-diagnostic__dimensions" data-dimensions-section>
      <h3>{{ 'Detalle por dimension'|t }}</h3>
      <div class="ej-diagnostic__dimension" data-dimension="linkedin">
        <span class="ej-diagnostic__dimension-label">LinkedIn</span>
        <div class="ej-diagnostic__dimension-bar">
          <div class="ej-diagnostic__dimension-fill" data-dimension-fill="linkedin"></div>
        </div>
        <span class="ej-diagnostic__dimension-value" data-dimension-value="linkedin">0</span>
      </div>
      <div class="ej-diagnostic__dimension" data-dimension="cv_ats">
        <span class="ej-diagnostic__dimension-label">CV ATS</span>
        <div class="ej-diagnostic__dimension-bar">
          <div class="ej-diagnostic__dimension-fill" data-dimension-fill="cv_ats"></div>
        </div>
        <span class="ej-diagnostic__dimension-value" data-dimension-value="cv_ats">0</span>
      </div>
      <div class="ej-diagnostic__dimension" data-dimension="estrategia">
        <span class="ej-diagnostic__dimension-label">{{ 'Estrategia'|t }}</span>
        <div class="ej-diagnostic__dimension-bar">
          <div class="ej-diagnostic__dimension-fill" data-dimension-fill="estrategia"></div>
        </div>
        <span class="ej-diagnostic__dimension-value" data-dimension-value="estrategia">0</span>
      </div>
    </div>

    {# Recommendations #}
    <div class="ej-diagnostic__recommendations" data-recommendations-section>
      <h3>{{ 'Tu plan de accion'|t }}</h3>
      <div class="ej-diagnostic__recommendation-list" data-recommendation-list></div>
    </div>

    {# CTAs #}
    <div class="ej-diagnostic__ctas">
      <a href="/user/register" class="ej-diagnostic__cta-primary" data-register-link>
        {{ 'Registrarme y empezar mi transformacion'|t }}
      </a>
      <button type="button" class="ej-diagnostic__cta-secondary" data-diagnostic-restart>
        {{ 'Repetir diagnostico'|t }}
      </button>
    </div>
  </div>

  {# Loading state #}
  <div class="ej-diagnostic__loading" data-diagnostic-loading style="display: none;">
    <div class="ej-diagnostic__spinner"></div>
    <p>{{ 'Analizando tu perfil...'|t }}</p>
  </div>
</div>
