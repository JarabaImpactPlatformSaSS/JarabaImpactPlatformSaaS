# Rutas del módulo jaraba_diagnostic
# Sistema de Diagnóstico Empresarial - Vertical Emprendimiento

# === Admin: Configuración del módulo ===
jaraba_diagnostic.admin:
  path: '/admin/config/emprendimiento/diagnostic'
  defaults:
    _title: 'Configuración de Diagnósticos'
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
  requirements:
    _permission: 'administer business diagnostics'

# === Field UI: Settings route ===
entity.business_diagnostic.settings:
  path: '/admin/structure/business-diagnostic'
  defaults:
    _title: 'Configuración de Diagnóstico Empresarial'
    _form: '\Drupal\jaraba_diagnostic\Form\BusinessDiagnosticSettingsForm'
  requirements:
    _permission: 'administer business diagnostics'

# === CRUD Routes (generated by AdminHtmlRouteProvider) ===
# collection, canonical, add-form, edit-form, delete-form

# === API Routes ===
jaraba_diagnostic.api.list:
  path: '/api/v1/diagnostics'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::list'
    _title: 'List Diagnostics'
  methods: [GET]
  requirements:
    _permission: 'view own business diagnostic'
  options:
    _format: json

jaraba_diagnostic.api.get:
  path: '/api/v1/diagnostics/{uuid}'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::get'
    _title: 'Get Diagnostic'
  methods: [GET]
  requirements:
    _permission: 'view own business diagnostic'
    uuid: '[a-f0-9\-]+'
  options:
    _format: json

jaraba_diagnostic.api.create:
  path: '/api/v1/diagnostics'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::createDiagnostic'
    _title: 'Create Diagnostic'
  methods: [POST]
  requirements:
    _permission: 'create business diagnostic'
  options:
    _format: json

jaraba_diagnostic.api.update:
  path: '/api/v1/diagnostics/{uuid}'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::update'
    _title: 'Update Diagnostic'
  methods: [PATCH]
  requirements:
    _permission: 'edit own business diagnostic'
    uuid: '[a-f0-9\-]+'
  options:
    _format: json

jaraba_diagnostic.api.answers:
  path: '/api/v1/diagnostics/{uuid}/answers'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::submitAnswers'
    _title: 'Submit Answers'
  methods: [POST]
  requirements:
    _permission: 'edit own business diagnostic'
    uuid: '[a-f0-9\-]+'
  options:
    _format: json

jaraba_diagnostic.api.results:
  path: '/api/v1/diagnostics/{uuid}/results'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::getResults'
    _title: 'Get Results'
  methods: [GET]
  requirements:
    _permission: 'view own business diagnostic'
    uuid: '[a-f0-9\-]+'
  options:
    _format: json

jaraba_diagnostic.api.recommendations:
  path: '/api/v1/diagnostics/{uuid}/recommendations'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::getRecommendations'
    _title: 'Get Recommendations'
  methods: [GET]
  requirements:
    _permission: 'view diagnostic recommendations'
    uuid: '[a-f0-9\-]+'
  options:
    _format: json

jaraba_diagnostic.api.report:
  path: '/api/v1/diagnostics/{uuid}/report.pdf'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticApiController::downloadReport'
    _title: 'Download Report'
  methods: [GET]
  requirements:
    _permission: 'export diagnostic report'
    uuid: '[a-f0-9\-]+'

# === Empleabilidad: Diagnostico Express (Spec 20260120b S3) ===

# Landing publica del diagnostico express de empleabilidad
jaraba_diagnostic.employability.landing:
  path: '/empleabilidad/diagnostico'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\EmployabilityDiagnosticController::landing'
    _title: 'Diagnostico de Empleabilidad'
  requirements:
    _access: 'TRUE'
  methods: [GET]

# Procesar respuestas del diagnostico (POST JSON)
jaraba_diagnostic.employability.process:
  path: '/empleabilidad/diagnostico'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\EmployabilityDiagnosticController::processAndShowResults'
    _title: 'Procesar Diagnostico'
  requirements:
    _access: 'TRUE'
  methods: [POST]

# Resultados del diagnostico por UUID
jaraba_diagnostic.employability.results:
  path: '/empleabilidad/diagnostico/{uuid}/resultados'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\EmployabilityDiagnosticController::showResults'
    _title: 'Resultados del Diagnostico'
  requirements:
    _access: 'TRUE'
    uuid: '[a-f0-9\-]+'

# === Frontend: Wizard público (Emprendimiento) ===
jaraba_diagnostic.wizard.start:
  path: '/diagnostic/start'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticWizardController::start'
    _title: 'Diagnóstico Empresarial'
  requirements:
    _permission: 'create business diagnostic'

jaraba_diagnostic.wizard.create:
  path: '/diagnostic/start'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticWizardController::createAndStart'
    _title: 'Crear Diagnóstico'
  methods: [POST]
  requirements:
    _permission: 'create business diagnostic'


jaraba_diagnostic.wizard.step:
  path: '/diagnostic/{uuid}/step/{section}'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticWizardController::step'
    _title: 'Diagnóstico - Paso'
  requirements:
    _permission: 'edit own business diagnostic'
    uuid: '[a-f0-9\-]+'
    section: '[a-z_]+'

jaraba_diagnostic.wizard.results:
  path: '/diagnostic/{uuid}/results'
  defaults:
    _controller: '\Drupal\jaraba_diagnostic\Controller\DiagnosticWizardController::results'
    _title: 'Resultados del Diagnóstico'
  requirements:
    _permission: 'view own business diagnostic'
    uuid: '[a-f0-9\-]+'

entity.diagnostic_answer.collection:
  path: '/admin/content/diagnostic-answers'
  defaults:
    _entity_list: 'diagnostic_answer'
    _title: 'Diagnostic Answers'
  requirements:
    _permission: 'administer site configuration'

entity.diagnostic_recommendation.collection:
  path: '/admin/content/diagnostic-recommendations'
  defaults:
    _entity_list: 'diagnostic_recommendation'
    _title: 'Diagnostic Recommendations'
  requirements:
    _permission: 'administer site configuration'

# === Field UI: Settings routes for entities ===

entity.diagnostic_answer.settings:
  path: '/admin/structure/diagnostic-answer/settings'
  defaults:
    _form: 'Drupal\jaraba_diagnostic\Form\DiagnosticAnswerSettingsForm'
    _title: 'Diagnostic Answer settings'
  requirements:
    _permission: 'administer business diagnostics'

entity.diagnostic_question.settings:
  path: '/admin/structure/diagnostic-question/settings'
  defaults:
    _form: 'Drupal\jaraba_diagnostic\Form\DiagnosticQuestionSettingsForm'
    _title: 'Diagnostic Question settings'
  requirements:
    _permission: 'manage diagnostic sections'

entity.diagnostic_recommendation.settings:
  path: '/admin/structure/diagnostic-recommendation/settings'
  defaults:
    _form: 'Drupal\jaraba_diagnostic\Form\DiagnosticRecommendationSettingsForm'
    _title: 'Diagnostic Recommendation settings'
  requirements:
    _permission: 'administer business diagnostics'

entity.diagnostic_section.settings:
  path: '/admin/structure/diagnostic-section/settings'
  defaults:
    _form: 'Drupal\jaraba_diagnostic\Form\DiagnosticSectionSettingsForm'
    _title: 'Diagnostic Section settings'
  requirements:
    _permission: 'manage diagnostic sections'

entity.employability_diagnostic.settings:
  path: '/admin/structure/employability-diagnostic/settings'
  defaults:
    _form: 'Drupal\jaraba_diagnostic\Form\EmployabilityDiagnosticSettingsForm'
    _title: 'Employability Diagnostic settings'
  requirements:
    _permission: 'administer employability diagnostics'
