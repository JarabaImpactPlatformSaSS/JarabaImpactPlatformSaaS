// _resolution-detail.scss
// Estilos de la pagina de detalle de resolucion legal.
//
// DIRECTRIZ: Consumir tokens via var(--ej-*, #{$legal-*}).
// DIRECTRIZ: Tipografia de lectura con line-height generoso para
// textos juridicos extensos.

@use 'sass:color';
@use 'variables-legal' as legal;

// === Layout de la pagina de detalle ===

.legal-resolution-detail {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;

  // Cabecera con titulo, meta y badges.
  &__header {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 2px solid var(--ej-border-color, #e2e8f0);
  }

  &__title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--ej-text-primary, #{legal.$legal-text});
    line-height: 1.3;
    margin: 0 0 1rem;
  }

  &__meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
    font-size: 0.875rem;
    color: var(--ej-text-secondary, #{legal.$legal-text-light});

    span {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
  }

  // Resumen IA con fondo destacado.
  &__abstract {
    background: var(--ej-bg-surface, #{legal.$legal-surface});
    border-left: 4px solid var(--ej-color-accent, #{legal.$legal-accent});
    border-radius: 0 legal.$legal-radius legal.$legal-radius 0;
    padding: 1.25rem 1.5rem;
    margin-bottom: 1.5rem;

    h2 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--ej-text-secondary, #{legal.$legal-text-light});
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin: 0 0 0.75rem;
    }

    p {
      font-size: 1rem;
      line-height: 1.7;
      color: var(--ej-text-primary, #{legal.$legal-text});
      margin: 0;
    }
  }

  // Ratio decidendi con blockquote.
  &__holdings {
    margin-bottom: 1.5rem;

    h2 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--ej-text-secondary, #{legal.$legal-text-light});
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin: 0 0 0.75rem;
    }

    blockquote {
      margin: 0;
      padding: 1rem 1.25rem;
      border-left: 3px solid var(--ej-color-primary, #{legal.$legal-primary});
      background: color.change(legal.$legal-primary, $alpha: 0.04);
      border-radius: 0 legal.$legal-radius-sm legal.$legal-radius-sm 0;
      font-size: 1rem;
      font-style: italic;
      line-height: 1.7;
      color: var(--ej-text-primary, #{legal.$legal-text});
    }
  }

  // Barra de acciones (insertar cita, favorito).
  &__actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    margin-bottom: 2rem;
    padding: 1rem 0;
    border-top: 1px solid var(--ej-border-color, #e2e8f0);
    border-bottom: 1px solid var(--ej-border-color, #e2e8f0);
  }

  // Texto completo de la resolucion.
  &__full-text {
    margin-bottom: 2rem;

    h2 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--ej-text-secondary, #{legal.$legal-text-light});
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin: 0 0 1rem;
    }
  }

  &__text-body {
    font-family: var(--ej-font-family-serif, Georgia, 'Times New Roman', serif);
    font-size: 0.9375rem;
    line-height: 1.8;
    color: var(--ej-text-primary, #{legal.$legal-text});
    max-height: 600px;
    overflow-y: auto;
    padding: 1.5rem;
    background: #fefefe;
    border: 1px solid var(--ej-border-color, #e2e8f0);
    border-radius: legal.$legal-radius;

    // Scroll suave con indicador sutil.
    &::-webkit-scrollbar {
      width: 6px;
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: color.change(legal.$legal-primary, $alpha: 0.2);
      border-radius: 3px;
    }
  }

  // Seccion de resoluciones similares.
  &__similar {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 2px solid var(--ej-border-color, #e2e8f0);

    h2 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--ej-text-primary, #{legal.$legal-text});
      margin: 0 0 1rem;
    }
  }
}

// === Panel de insercion de cita (slide-panel) ===

.legal-citation-insert {
  padding: 1.5rem;

  &__header {
    margin-bottom: 1.5rem;
  }

  &__title {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0 0 0.5rem;
  }

  &__formats {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
  }

  &__format-btn {
    padding: 0.375rem 0.75rem;
    border: 1px solid var(--ej-border-color, #e2e8f0);
    border-radius: legal.$legal-radius-sm;
    background: #fff;
    font-size: 0.8125rem;
    cursor: pointer;
    transition: all 0.15s ease;

    &--active,
    &:hover {
      background: var(--ej-color-primary, #{legal.$legal-primary});
      color: #fff;
      border-color: var(--ej-color-primary, #{legal.$legal-primary});
    }
  }

  &__preview {
    padding: 1.25rem;
    background: var(--ej-bg-surface, #{legal.$legal-surface});
    border: 1px solid var(--ej-border-color, #e2e8f0);
    border-radius: legal.$legal-radius;
    font-size: 0.9375rem;
    line-height: 1.7;
    margin-bottom: 1rem;
    user-select: all;
    cursor: text;
  }

  &__actions {
    display: flex;
    gap: 0.75rem;
    justify-content: flex-end;
  }
}

// === Mini-grafo de citas (D3.js) ===

.legal-citation-graph {
  margin: 1.5rem 0;
  padding: 1rem;
  background: var(--ej-bg-surface, #{legal.$legal-surface});
  border-radius: legal.$legal-radius;
  border: 1px solid var(--ej-border-color, #e2e8f0);

  &__title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--ej-text-secondary, #{legal.$legal-text-light});
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0 0 0.75rem;
  }

  &__canvas {
    width: 100%;
    min-height: 200px;
    max-height: 400px;

    // Nodos del grafo D3.
    .node {
      cursor: pointer;

      circle {
        fill: var(--ej-color-primary, #{legal.$legal-primary});
        stroke: #fff;
        stroke-width: 2;
      }

      text {
        font-size: 0.6875rem;
        fill: var(--ej-text-primary, #{legal.$legal-text});
      }

      &--current circle {
        fill: var(--ej-color-accent, #{legal.$legal-accent});
        r: 8;
      }

      &--eu circle {
        fill: legal.$legal-eu-blue;
      }
    }

    .link {
      stroke: var(--ej-border-color, #e2e8f0);
      stroke-width: 1.5;

      &--cita {
        stroke: var(--ej-color-primary, #{legal.$legal-primary});
        stroke-dasharray: 4 2;
      }

      &--anula {
        stroke: legal.$legal-danger;
      }

      &--confirma {
        stroke: legal.$legal-success;
      }
    }
  }
}

// === Responsive ===

@media (max-width: 768px) {
  .legal-resolution-detail {
    padding: 1rem 0.75rem;

    &__title {
      font-size: 1.375rem;
    }

    &__meta {
      flex-direction: column;
      gap: 0.5rem;
    }

    &__actions {
      flex-direction: column;
    }

    &__text-body {
      max-height: 400px;
      padding: 1rem;
    }
  }

  .legal-citation-insert__formats {
    flex-wrap: wrap;
  }
}
