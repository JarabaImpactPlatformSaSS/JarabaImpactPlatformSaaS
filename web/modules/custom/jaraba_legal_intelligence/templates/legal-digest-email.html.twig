{#
 * legal-digest-email.html.twig
 * Template de email para el digest semanal personalizado.
 *
 * Se envia via jaraba_email con compilacion MJML.
 * Maximo 10 resoluciones por digest.
 *
 * Variables:
 *   - provider_name: string — Nombre del profesional.
 *   - resolutions: array — Resoluciones relevantes de la semana.
 *   - period_start: string — Fecha inicio del periodo.
 *   - period_end: string — Fecha fin del periodo.
 #}

<div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 600px; margin: 0 auto;">
  <h1 style="color: #1E3A5F; font-size: 24px;">
    {% trans %}Weekly Legal Digest{% endtrans %}
  </h1>

  <p style="color: #6B7280;">
    {{ 'Hello @name, here are the most relevant resolutions from @start to @end.'|t({
      '@name': provider_name,
      '@start': period_start,
      '@end': period_end
    }) }}
  </p>

  {% for resolution in resolutions %}
    <div style="border-left: 3px solid #1E3A5F; padding: 12px 16px; margin-bottom: 16px; background: #F5F3EF;">
      <strong style="color: #1E3A5F;">{{ resolution.external_ref|default('') }}</strong>
      <span style="color: #6B7280;"> — {{ resolution.issuing_body|default('') }}</span>
      <p style="margin: 8px 0 0; color: #1A1A2E;">
        {{ resolution.title|default('')|striptags }}
      </p>
      {% if resolution.abstract_ai is defined and resolution.abstract_ai %}
        <p style="margin: 4px 0 0; color: #6B7280; font-size: 14px;">
          {{ resolution.abstract_ai|striptags|length > 200 ? resolution.abstract_ai|striptags|slice(0, 200) ~ '...' : resolution.abstract_ai|striptags }}
        </p>
      {% endif %}
    </div>
  {% endfor %}

  <p style="color: #6B7280; font-size: 12px; margin-top: 24px;">
    {% trans %}You receive this digest because you have active alert subscriptions. Manage your preferences in the Legal Intelligence Hub.{% endtrans %}
  </p>
</div>
