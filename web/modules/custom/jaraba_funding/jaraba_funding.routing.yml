# ============================================
# CONFIGURACION DE ENTIDADES — Field UI
# ============================================

jaraba_funding.funding_opportunity.settings:
  path: '/admin/structure/funding-opportunities'
  defaults:
    _entity_list: 'funding_opportunity'
    _title: 'Convocatorias de Fondos'
  requirements:
    _permission: 'administer funding'

jaraba_funding.funding_application.settings:
  path: '/admin/structure/funding-applications'
  defaults:
    _entity_list: 'funding_application'
    _title: 'Solicitudes de Fondos'
  requirements:
    _permission: 'administer funding'

jaraba_funding.technical_report.settings:
  path: '/admin/structure/technical-reports'
  defaults:
    _entity_list: 'technical_report'
    _title: 'Memorias Tecnicas'
  requirements:
    _permission: 'administer funding'

# ============================================
# FRONTEND — Dashboard Zero-Region
# ============================================

jaraba_funding.dashboard:
  path: '/funding'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingDashboardController::dashboard'
    _title: 'Fondos y Subvenciones'
  requirements:
    _permission: 'access funding'
  options:
    _admin_route: FALSE

# ============================================
# API REST — Convocatorias
# ============================================

jaraba_funding.api.opportunities.list:
  path: '/api/v1/funding/opportunities'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::listOpportunities'
  requirements:
    _permission: 'access funding api'
  methods: [GET]
  options:
    _auth: ['basic_auth', 'cookie']
    no_cache: TRUE

jaraba_funding.api.opportunities.store:
  path: '/api/v1/funding/opportunities'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::storeOpportunity'
  requirements:
    _permission: 'manage funding opportunities'
  methods: [POST]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.opportunities.show:
  path: '/api/v1/funding/opportunities/{funding_opportunity}'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::showOpportunity'
  requirements:
    _permission: 'access funding api'
    funding_opportunity: '\d+'
  methods: [GET]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.opportunities.update:
  path: '/api/v1/funding/opportunities/{funding_opportunity}'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::updateOpportunity'
  requirements:
    _permission: 'manage funding opportunities'
    funding_opportunity: '\d+'
  methods: [PATCH]
  options:
    _auth: ['basic_auth', 'cookie']

# ============================================
# API REST — Solicitudes
# ============================================

jaraba_funding.api.applications.list:
  path: '/api/v1/funding/applications'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::listApplications'
  requirements:
    _permission: 'access funding api'
  methods: [GET]
  options:
    _auth: ['basic_auth', 'cookie']
    no_cache: TRUE

jaraba_funding.api.applications.store:
  path: '/api/v1/funding/applications'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::storeApplication'
  requirements:
    _permission: 'manage funding applications'
  methods: [POST]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.applications.show:
  path: '/api/v1/funding/applications/{funding_application}'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::showApplication'
  requirements:
    _permission: 'access funding api'
    funding_application: '\d+'
  methods: [GET]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.applications.update:
  path: '/api/v1/funding/applications/{funding_application}'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::updateApplication'
  requirements:
    _permission: 'manage funding applications'
    funding_application: '\d+'
  methods: [PATCH]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.applications.submit:
  path: '/api/v1/funding/applications/{funding_application}/submit'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::submitApplication'
  requirements:
    _permission: 'manage funding applications'
    funding_application: '\d+'
  methods: [POST]
  options:
    _auth: ['basic_auth', 'cookie']

# ============================================
# API REST — Memorias Tecnicas
# ============================================

jaraba_funding.api.reports.generate:
  path: '/api/v1/funding/applications/{funding_application}/report'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::generateReport'
  requirements:
    _permission: 'manage funding applications'
    funding_application: '\d+'
  methods: [POST]
  options:
    _auth: ['basic_auth', 'cookie']

jaraba_funding.api.reports.generate_ai:
  path: '/api/v1/funding/applications/{funding_application}/report/ai'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::generateReportWithAi'
  requirements:
    _permission: 'manage funding applications'
    funding_application: '\d+'
  methods: [POST]
  options:
    _auth: ['basic_auth', 'cookie']

# ============================================
# API REST — Estadisticas
# ============================================

jaraba_funding.api.stats:
  path: '/api/v1/funding/stats'
  defaults:
    _controller: '\Drupal\jaraba_funding\Controller\FundingApiController::stats'
  requirements:
    _permission: 'access funding api'
  methods: [GET]
  options:
    _auth: ['basic_auth', 'cookie']

# ============================================
# ADMIN — Configuracion
# ============================================

jaraba_funding.settings:
  path: '/admin/config/jaraba/funding'
  defaults:
    _form: '\Drupal\jaraba_funding\Form\FundingSettingsForm'
    _title: 'Configuracion de Fondos'
  requirements:
    _permission: 'administer funding'
