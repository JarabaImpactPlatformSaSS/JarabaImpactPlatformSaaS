{#
 # Mi Código de Referido — Página de generación y compartición.
 #
 # VARIABLES:
 #   - code (string|null): código de 8 caracteres
 #   - share_url (string|null): URL completa para compartir
 #   - user_name (string): nombre del usuario
 #}

<div class="ej-referral-code">

  <div class="ej-referral-code__header">
    <a href="/referidos" class="ej-referral-code__back">← {% trans %}Back to My Referrals{% endtrans %}</a>
    <h1 class="ej-referral-code__title">{% trans %}My Referral Code{% endtrans %}</h1>
    <p class="ej-referral-code__subtitle">
      {% trans %}Share this code with your contacts. When they register, both of you will receive a reward.{% endtrans %}
    </p>
  </div>

  {% if code %}
    <div class="ej-referral-code__card">
      <div class="ej-referral-code__display">
        <span class="ej-referral-code__label">{% trans %}Your unique code{% endtrans %}</span>
        <code class="ej-referral-code__value" id="referral-code">{{ code }}</code>
      </div>

      <div class="ej-referral-code__share">
        <span class="ej-referral-code__share-label">{% trans %}Share link{% endtrans %}</span>
        <div class="ej-referral-code__share-input">
          <input type="text" readonly value="{{ share_url }}" id="referral-url" class="ej-referral-code__url-input">
          <button type="button" class="ej-referral-code__copy-btn" data-copy-target="#referral-url">
            {% trans %}Copy{% endtrans %}
          </button>
        </div>
      </div>

      <div class="ej-referral-code__social">
        <span class="ej-referral-code__social-label">{% trans %}Share on{% endtrans %}</span>
        <div class="ej-referral-code__social-buttons">
          <a href="https://wa.me/?text={{ share_url|url_encode }}" target="_blank" rel="noopener" class="ej-referral-code__social-btn ej-referral-code__social-btn--whatsapp">
            WhatsApp
          </a>
          <a href="https://t.me/share/url?url={{ share_url|url_encode }}" target="_blank" rel="noopener" class="ej-referral-code__social-btn ej-referral-code__social-btn--telegram">
            Telegram
          </a>
          <a href="mailto:?subject={{ 'Invitation'|trans|url_encode }}&body={{ share_url|url_encode }}" class="ej-referral-code__social-btn ej-referral-code__social-btn--email">
            Email
          </a>
        </div>
      </div>
    </div>

    <div class="ej-referral-code__instructions">
      <h2>{% trans %}How does it work?{% endtrans %}</h2>
      <ol>
        <li>{% trans %}Share your link or code with your contacts.{% endtrans %}</li>
        <li>{% trans %}When they register using your code, the referral is confirmed.{% endtrans %}</li>
        <li>{% trans %}Both of you will receive the reward configured by the program.{% endtrans %}</li>
      </ol>
    </div>
  {% else %}
    <div class="ej-referral-code__error">
      <p>{% trans %}Could not generate your referral code. Please try again later.{% endtrans %}</p>
    </div>
  {% endif %}

</div>
