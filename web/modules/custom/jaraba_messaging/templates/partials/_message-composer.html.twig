{#
/**
 * @file
 * templates/partials/_message-composer.html.twig
 *
 * Message composer with auto-growing textarea, attachment button, and send
 * button. Handles Enter to send / Shift+Enter for newline via JS.
 *
 * Variables: None (all interaction via JavaScript behaviors).
 */
#}

<div class="message-composer" data-message-composer>

  {# Attachment preview area: shown when files are queued #}
  <div class="message-composer__attachments" data-composer-attachments style="display: none;">
    {# JS inserts attachment previews here #}
  </div>

  {# Edit mode indicator: shown when editing a message #}
  <div class="message-composer__edit-bar" data-composer-edit-bar style="display: none;">
    <span class="message-composer__edit-label">{% trans %}Editing message{% endtrans %}</span>
    <button class="message-composer__edit-cancel"
            type="button"
            data-action="cancel-edit"
            aria-label="{% trans %}Cancel editing{% endtrans %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>

  {# Composer input row #}
  <div class="message-composer__input-row">

    {# Attach file button #}
    <button class="message-composer__attach-btn"
            type="button"
            data-action="attach-file"
            aria-label="{% trans %}Attach a file{% endtrans %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
      </svg>
    </button>

    {# Hidden file input #}
    <input type="file"
           class="message-composer__file-input visually-hidden"
           data-file-input
           multiple
           aria-hidden="true"
           tabindex="-1">

    {# Auto-grow textarea #}
    <div class="message-composer__textarea-wrapper">
      <textarea class="message-composer__textarea"
                data-composer-textarea
                placeholder="{% trans %}Type a message...{% endtrans %}"
                aria-label="{% trans %}Message text{% endtrans %}"
                rows="1"
                maxlength="5000"
                autocomplete="off"></textarea>
      <span class="message-composer__char-count" data-char-count aria-live="polite">
        <span data-char-current>0</span>/<span data-char-max>5000</span>
      </span>
    </div>

    {# Send button #}
    <button class="message-composer__send-btn"
            type="button"
            data-action="send-message"
            disabled
            aria-label="{% trans %}Send message{% endtrans %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"/>
        <polygon points="22 2 15 22 11 13 2 9 22 2"/>
      </svg>
    </button>
  </div>

  {# Keyboard shortcut hint #}
  <div class="message-composer__hint" aria-hidden="true">
    <span>{% trans %}Press Enter to send, Shift+Enter for new line{% endtrans %}</span>
  </div>
</div>
