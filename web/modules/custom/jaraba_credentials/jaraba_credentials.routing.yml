# Rutas del módulo Jaraba Credentials
# CRÍTICO: Content Entities en /admin/content, Settings en /admin/structure

# ============================================
# ISSUER PROFILES
# ============================================

entity.issuer_profile.collection:
  path: '/admin/content/issuer-profiles'
  defaults:
    _entity_list: 'issuer_profile'
    _title: 'Perfiles de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

entity.issuer_profile.canonical:
  path: '/admin/content/issuer-profiles/{issuer_profile}'
  defaults:
    _entity_view: 'issuer_profile'
    _title: 'Ver Perfil de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

entity.issuer_profile.add_form:
  path: '/admin/content/issuer-profiles/add'
  defaults:
    _entity_form: 'issuer_profile.add'
    _title: 'Añadir Perfil de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

entity.issuer_profile.edit_form:
  path: '/admin/content/issuer-profiles/{issuer_profile}/edit'
  defaults:
    _entity_form: 'issuer_profile.edit'
    _title: 'Editar Perfil de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

entity.issuer_profile.delete_form:
  path: '/admin/content/issuer-profiles/{issuer_profile}/delete'
  defaults:
    _entity_form: 'issuer_profile.delete'
    _title: 'Eliminar Perfil de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

entity.issuer_profile.settings:
  path: '/admin/structure/issuer-profile'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\IssuerProfileSettingsForm'
    _title: 'Configuración Perfil de Emisor'
  requirements:
    _permission: 'manage issuer profiles'

# ============================================
# CREDENTIAL TEMPLATES
# ============================================

entity.credential_template.collection:
  path: '/admin/content/credential-templates'
  defaults:
    _entity_list: 'credential_template'
    _title: 'Templates de Credenciales'
  requirements:
    _permission: 'manage credential templates'

entity.credential_template.canonical:
  path: '/admin/content/credential-templates/{credential_template}'
  defaults:
    _entity_view: 'credential_template'
    _title: 'Ver Template'
  requirements:
    _permission: 'manage credential templates'

entity.credential_template.add_form:
  path: '/admin/content/credential-templates/add'
  defaults:
    _entity_form: 'credential_template.add'
    _title: 'Añadir Template de Credencial'
  requirements:
    _permission: 'manage credential templates'

entity.credential_template.edit_form:
  path: '/admin/content/credential-templates/{credential_template}/edit'
  defaults:
    _entity_form: 'credential_template.edit'
    _title: 'Editar Template'
  requirements:
    _permission: 'manage credential templates'

entity.credential_template.delete_form:
  path: '/admin/content/credential-templates/{credential_template}/delete'
  defaults:
    _entity_form: 'credential_template.delete'
    _title: 'Eliminar Template'
  requirements:
    _permission: 'manage credential templates'

entity.credential_template.settings:
  path: '/admin/structure/credential-template'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\CredentialTemplateSettingsForm'
    _title: 'Configuración Template de Credencial'
  requirements:
    _permission: 'manage credential templates'

# ============================================
# ISSUED CREDENTIALS
# ============================================

entity.issued_credential.collection:
  path: '/admin/content/issued-credentials'
  defaults:
    _entity_list: 'issued_credential'
    _title: 'Credenciales Emitidas'
  requirements:
    _permission: 'administer credentials'

entity.issued_credential.canonical:
  path: '/admin/content/issued-credentials/{issued_credential}'
  defaults:
    _entity_view: 'issued_credential'
    _title: 'Ver Credencial'
  requirements:
    _permission: 'administer credentials'

entity.issued_credential.add_form:
  path: '/admin/content/issued-credentials/add'
  defaults:
    _entity_form: 'issued_credential.add'
    _title: 'Emitir Nueva Credencial'
  requirements:
    _permission: 'issue credentials'

entity.issued_credential.edit_form:
  path: '/admin/content/issued-credentials/{issued_credential}/edit'
  defaults:
    _entity_form: 'issued_credential.edit'
    _title: 'Editar Credencial'
  requirements:
    _permission: 'administer credentials'

entity.issued_credential.settings:
  path: '/admin/structure/issued-credential'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\IssuedCredentialSettingsForm'
    _title: 'Configuración Credenciales Emitidas'
  requirements:
    _permission: 'administer credentials'

# ============================================
# VERIFICACIÓN PÚBLICA
# ============================================

jaraba_credentials.verify:
  path: '/verify/{uuid}'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\VerifyController::verify'
    _title: 'Verificar Credencial'
  requirements:
    _access: 'TRUE'
  options:
    no_cache: TRUE

jaraba_credentials.verify_json:
  path: '/verify/{uuid}/json'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\VerifyController::verifyJson'
  requirements:
    _access: 'TRUE'
  options:
    no_cache: TRUE

# ============================================
# FRONTEND: MIS CERTIFICACIONES
# ============================================

jaraba_credentials.my_credentials:
  path: '/my-certifications'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\CredentialsDashboardController::dashboard'
    _title: 'Mis Certificaciones'
  requirements:
    _user_is_logged_in: 'TRUE'

# ============================================
# CONFIGURACIÓN DEL MÓDULO
# ============================================

jaraba_credentials.settings:
  path: '/admin/config/training/credentials'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\CredentialsSettingsForm'
    _title: 'Configuración de Credenciales'
  requirements:
    _permission: 'administer credentials'

# ============================================
# API REST
# ============================================

# ============================================
# REVOCATION ENTRIES
# ============================================

entity.revocation_entry.collection:
  path: '/admin/content/revocation-entries'
  defaults:
    _entity_list: 'revocation_entry'
    _title: 'Entradas de Revocación'
  requirements:
    _permission: 'revoke credentials'

entity.revocation_entry.canonical:
  path: '/admin/content/revocation-entries/{revocation_entry}'
  defaults:
    _entity_view: 'revocation_entry'
    _title: 'Ver Entrada de Revocación'
  requirements:
    _permission: 'revoke credentials'

entity.revocation_entry.add_form:
  path: '/admin/content/revocation-entries/add'
  defaults:
    _entity_form: 'revocation_entry.add'
    _title: 'Añadir Entrada de Revocación'
  requirements:
    _permission: 'revoke credentials'

entity.revocation_entry.edit_form:
  path: '/admin/content/revocation-entries/{revocation_entry}/edit'
  defaults:
    _entity_form: 'revocation_entry.edit'
    _title: 'Editar Entrada de Revocación'
  requirements:
    _permission: 'revoke credentials'

entity.revocation_entry.delete_form:
  path: '/admin/content/revocation-entries/{revocation_entry}/delete'
  defaults:
    _entity_form: 'revocation_entry.delete'
    _title: 'Eliminar Entrada de Revocación'
  requirements:
    _permission: 'administer credentials'

entity.revocation_entry.settings:
  path: '/admin/structure/revocation-entry'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\RevocationEntrySettingsForm'
    _title: 'Configuración Entradas de Revocación'
  requirements:
    _permission: 'administer credentials'

# ============================================
# API: REVOCACIÓN
# ============================================

# ============================================
# CREDENTIAL STACKS
# ============================================

entity.credential_stack.collection:
  path: '/admin/content/credential-stacks'
  defaults:
    _entity_list: 'credential_stack'
    _title: 'Stacks de Credenciales'
  requirements:
    _permission: 'manage credential stacks'

entity.credential_stack.canonical:
  path: '/admin/content/credential-stacks/{credential_stack}'
  defaults:
    _entity_view: 'credential_stack'
    _title: 'Ver Stack'
  requirements:
    _permission: 'manage credential stacks'

entity.credential_stack.add_form:
  path: '/admin/content/credential-stacks/add'
  defaults:
    _entity_form: 'credential_stack.add'
    _title: 'Añadir Stack de Credenciales'
  requirements:
    _permission: 'manage credential stacks'

entity.credential_stack.edit_form:
  path: '/admin/content/credential-stacks/{credential_stack}/edit'
  defaults:
    _entity_form: 'credential_stack.edit'
    _title: 'Editar Stack'
  requirements:
    _permission: 'manage credential stacks'

entity.credential_stack.delete_form:
  path: '/admin/content/credential-stacks/{credential_stack}/delete'
  defaults:
    _entity_form: 'credential_stack.delete'
    _title: 'Eliminar Stack'
  requirements:
    _permission: 'manage credential stacks'

entity.credential_stack.settings:
  path: '/admin/structure/credential-stack'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\CredentialStackSettingsForm'
    _title: 'Configuración Stacks de Credenciales'
  requirements:
    _permission: 'administer credentials'

# ============================================
# USER STACK PROGRESS
# ============================================

entity.user_stack_progress.collection:
  path: '/admin/content/user-stack-progress'
  defaults:
    _entity_list: 'user_stack_progress'
    _title: 'Progreso de Stacks'
  requirements:
    _permission: 'view stack progress'

entity.user_stack_progress.canonical:
  path: '/admin/content/user-stack-progress/{user_stack_progress}'
  defaults:
    _entity_view: 'user_stack_progress'
    _title: 'Ver Progreso'
  requirements:
    _permission: 'view stack progress'

entity.user_stack_progress.add_form:
  path: '/admin/content/user-stack-progress/add'
  defaults:
    _entity_form: 'user_stack_progress.add'
    _title: 'Añadir Progreso de Stack'
  requirements:
    _permission: 'administer credentials'

entity.user_stack_progress.edit_form:
  path: '/admin/content/user-stack-progress/{user_stack_progress}/edit'
  defaults:
    _entity_form: 'user_stack_progress.edit'
    _title: 'Editar Progreso'
  requirements:
    _permission: 'administer credentials'

entity.user_stack_progress.delete_form:
  path: '/admin/content/user-stack-progress/{user_stack_progress}/delete'
  defaults:
    _entity_form: 'user_stack_progress.delete'
    _title: 'Eliminar Progreso'
  requirements:
    _permission: 'administer credentials'

entity.user_stack_progress.settings:
  path: '/admin/structure/user-stack-progress'
  defaults:
    _form: 'Drupal\jaraba_credentials\Form\UserStackProgressSettingsForm'
    _title: 'Configuración Progreso de Stacks'
  requirements:
    _permission: 'administer credentials'

# ============================================
# API: STACKS
# ============================================

jaraba_credentials.api.stacks:
  path: '/api/v1/stacks'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\StacksApiController::listStacks'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'

jaraba_credentials.api.stack:
  path: '/api/v1/stacks/{id}'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\StacksApiController::getStack'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'
    id: \d+

jaraba_credentials.api.stacks.my_progress:
  path: '/api/v1/stacks/my-progress'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\StacksApiController::myProgress'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'

jaraba_credentials.api.stacks.progress:
  path: '/api/v1/stacks/{id}/progress'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\StacksApiController::stackProgress'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'
    id: \d+

jaraba_credentials.api.stacks.recommended:
  path: '/api/v1/stacks/recommended'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\StacksApiController::recommended'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'

# ============================================
# API: REVOCACIÓN
# ============================================

jaraba_credentials.api.revoke:
  path: '/api/v1/credentials/{credential_id}/revoke'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\CredentialsApiController::revoke'
  methods: [POST]
  requirements:
    _permission: 'revoke credentials'
    credential_id: \d+

jaraba_credentials.api.credentials:
  path: '/api/v1/credentials'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\CredentialsApiController::list'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'

jaraba_credentials.api.credential:
  path: '/api/v1/credentials/{uuid}'
  defaults:
    _controller: 'Drupal\jaraba_credentials\Controller\CredentialsApiController::get'
  methods: [GET]
  requirements:
    _permission: 'verify credentials'
