{#
/**
 * @file
 * page--front.html.twig - Homepage profesional sin regiones.
 *
 * NOTA: Este es un PAGE template, NO un HTML template.
 * El wrapper DOCTYPE/html/head/body lo proporciona html.html.twig.
 * Este template solo genera el contenido dentro de body.
 *
 * ARQUITECTURA REFACTORIZADA:
 * - Sin {{ page.* }} = Sin bloques de Drupal
 * - Usa {% include %} de partials reutilizables
 * - i18n con {% trans %}
 * - Variables CSS var(--ej-*)
 *
 * PARTIALS:
 * - _header.html.twig: Header con menú móvil
 * - _hero.html.twig: Hero + intentions grid
 * - _features.html.twig: Propuesta de valor
 * - _stats.html.twig: Social proof
 * - _footer.html.twig: Footer configurable
 *
 * Body classes 'page-front', 'landing-page' deben añadirse en
 * hook_preprocess_html() en ecosistema_jaraba_theme.theme.
 *
 * @see ecosistema_jaraba_theme.theme para preprocess
 */
#}
{% set site_name = site_name|default('Jaraba Impact Platform') %}
{% set site_slogan = site_slogan|default('Impulsando el talento y la innovación') %}

{{ attach_library('ecosistema_jaraba_theme/scroll-animations') }}
{{ attach_library('ecosistema_jaraba_theme/progressive-profiling') }}
{{ attach_library('ecosistema_jaraba_theme/lenis-scroll') }}
{{ attach_library('ecosistema_jaraba_core/visitor-journey') }}

{# SEO Avanzado — Datos Estructurados Schema.org #}
{% include '@ecosistema_jaraba_theme/partials/_seo-schema.html.twig' with {
  site_name: site_name,
  logo: logo
} %}

{# HEADER - Partial reutilizable con menú móvil #}
  {% include '@ecosistema_jaraba_theme/partials/_header.html.twig' with {
    site_name: site_name,
    site_slogan: site_slogan,
    logo: logo,
    logged_in: logged_in,
    theme_settings: theme_settings
  } %}

  {# MAIN CONTENT #}
  <main id="main-content" class="landing-main">
    
    {# HERO - Partial con layout configurable + datos dinámicos #}
    {% include '@ecosistema_jaraba_theme/partials/_hero.html.twig' with {
      theme_settings: theme_settings,
      logged_in: logged_in,
      hero: homepage.hero|default({}),
      intentions: homepage.intentions|default([])
    } %}

    {# VERTICAL SELECTOR - 5 cards interactivas (Doc 178 §4.1) #}
    {% include '@ecosistema_jaraba_theme/partials/_vertical-selector.html.twig' with {
      verticals: verticals|default([]),
      detected_vertical: detected_vertical|default(null)
    } %}

    {# FEATURES - Propuesta de valor con datos dinámicos #}
    {% include '@ecosistema_jaraba_theme/partials/_features.html.twig' with {
      features: homepage.features|default([])
    } %}

    {# STATS - Social proof con datos dinámicos #}
    {% include '@ecosistema_jaraba_theme/partials/_stats.html.twig' with {
      stats: homepage.stats|default([])
    } %}

    {# LEAD MAGNET - Kit de Impulso Digital — BUG-001 Fix #}
    {% include '@ecosistema_jaraba_theme/partials/_lead-magnet.html.twig' with {
      lead_magnet_title: theme_settings.lead_magnet_title|default(null),
      lead_magnet_subtitle: theme_settings.lead_magnet_subtitle|default(null),
      lead_magnet_cta_text: theme_settings.lead_magnet_cta_text|default(null),
      lead_magnet_success_message: theme_settings.lead_magnet_success_message|default(null),
      lead_magnet_tenant_id: theme_settings.lead_magnet_tenant_id|default(5),
    } %}

    {# TESTIMONIOS — Casos de éxito reales (Sprint 2) #}
    {% include '@ecosistema_jaraba_theme/partials/_testimonials.html.twig' %}

  </main>

  {# FOOTER - Partial configurable desde UI #}
  {% include '@ecosistema_jaraba_theme/partials/_footer.html.twig' with {
    site_name: site_name,
    logo: logo,
    footer_copyright: footer_copyright,
    theme_settings: theme_settings
  } %}

  {# FAB COPILOTO - Asesor Comercial Premium (orientado a ventas y demos) #}
  {% include '@ecosistema_jaraba_theme/partials/_copilot-fab.html.twig' with {
    agent_context: 'landing_copilot',
    avatar_type: 'general',
    fab_color: 'var(--ej-color-impulse, #FF8C42)',
    greeting: '¡Hola! Soy tu asesor de Jaraba. Puedo mostrarte demos personalizadas, ayudarte a explorar la plataforma o resolver cualquier duda. ¿Qué te trae por aquí?'|t
  } %}

  {# WHATSAPP FAB — Contacto rápido móvil (Sprint 2) #}
  {% include '@ecosistema_jaraba_theme/partials/_whatsapp-fab.html.twig' with {
    whatsapp_number: theme_settings.whatsapp_number|default('34600000000'),
    whatsapp_message: theme_settings.whatsapp_message|default('Hola, me interesa conocer más sobre la Plataforma de Ecosistemas Digitales.'|t|url_encode)
  } %}

