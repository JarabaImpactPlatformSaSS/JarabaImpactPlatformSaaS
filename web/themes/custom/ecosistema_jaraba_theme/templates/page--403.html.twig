{#
/**
 * @file
 * page--403.html.twig — Pagina 403 Acceso Restringido premium.
 *
 * NOTA: Este es un PAGE template, NO un HTML template.
 * El wrapper DOCTYPE/html/head/body lo proporciona html.html.twig.
 * Este template solo genera el contenido dentro de body.
 *
 * ARQUITECTURA:
 * - Zero Region Policy — sin {{ page.* }}
 * - Usa {% include %} de partials reutilizables
 * - i18n con {% trans %}
 * - SVGs decorativos inline (exencion TPL-ICON-EXE-001)
 * - Contenido condicional segun autenticacion
 *
 * Body classes migradas a preprocess_html:
 * - page--error, page--403
 */
#}
{% set site_name = site_name|default('Jaraba Impact Platform') %}

{{ attach_library('ecosistema_jaraba_theme/global') }}

{# HEADER #}
{% include '@ecosistema_jaraba_theme/partials/_header.html.twig' with {
  site_name: site_name,
  logo: logo|default(''),
  logged_in: logged_in,
  theme_settings: theme_settings|default({})
} %}

{# MAIN CONTENT #}
<main id="main-content" class="error-page error-page--403">

  <section class="error-page__hero" aria-labelledby="error-title">
    {# Ilustracion SVG — Escudo/candado (decorativa, exencion TPL-ICON-EXE-001) #}
    <div class="error-page__illustration" role="img" aria-label="{% trans %}Ilustracion de acceso restringido{% endtrans %}">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" fill="none">
        {# Fondo circular #}
        <circle cx="200" cy="150" r="110" fill="var(--ej-color-corporate, #233D63)" opacity="0.05"/>
        <circle cx="200" cy="150" r="85" fill="var(--ej-color-corporate, #233D63)" opacity="0.04"/>
        {# Escudo #}
        <path d="M200 50 L280 90 L280 170 C280 220 245 255 200 270 C155 255 120 220 120 170 L120 90 Z"
              fill="var(--ej-color-corporate, #233D63)" opacity="0.08"
              stroke="var(--ej-color-corporate, #233D63)" stroke-width="2.5" stroke-opacity="0.2"/>
        <path d="M200 65 L268 100 L268 168 C268 212 238 242 200 255 C162 242 132 212 132 168 L132 100 Z"
              fill="none" stroke="var(--ej-color-secondary, #00A9A5)" stroke-width="1.5" stroke-opacity="0.3" stroke-dasharray="6 4"/>
        {# Candado #}
        <g transform="translate(170, 120)">
          {# Arco del candado #}
          <path d="M14 30 L14 18 C14 8 22 0 30 0 C38 0 46 8 46 18 L46 30"
                fill="none" stroke="var(--ej-color-corporate, #233D63)" stroke-width="4" stroke-linecap="round" opacity="0.7"/>
          {# Cuerpo del candado #}
          <rect x="6" y="28" width="48" height="36" rx="6" fill="var(--ej-color-primary, #FF8C42)" opacity="0.85"/>
          <rect x="6" y="28" width="48" height="36" rx="6" fill="none" stroke="var(--ej-color-corporate, #233D63)" stroke-width="2" opacity="0.3"/>
          {# Ojo de cerradura #}
          <circle cx="30" cy="44" r="5" fill="var(--ej-color-corporate, #233D63)" opacity="0.6"/>
          <rect x="28" y="44" width="4" height="10" rx="2" fill="var(--ej-color-corporate, #233D63)" opacity="0.6"/>
        </g>
        {# Particulas decorativas #}
        <circle cx="80" cy="80" r="3" fill="var(--ej-color-primary, #FF8C42)" opacity="0.3"/>
        <circle cx="320" cy="70" r="2.5" fill="var(--ej-color-secondary, #00A9A5)" opacity="0.3"/>
        <circle cx="100" cy="230" r="2" fill="var(--ej-color-corporate, #233D63)" opacity="0.2"/>
        <circle cx="310" cy="220" r="3" fill="var(--ej-color-primary, #FF8C42)" opacity="0.25"/>
        <circle cx="60" cy="150" r="1.5" fill="var(--ej-color-secondary, #00A9A5)" opacity="0.3"/>
        <circle cx="340" cy="140" r="2" fill="var(--ej-color-corporate, #233D63)" opacity="0.2"/>
        {# Texto 403 grande detras #}
        <text x="200" y="270" text-anchor="middle" font-family="var(--ej-font-headings, 'Outfit', sans-serif)" font-size="72" font-weight="800" fill="var(--ej-color-corporate, #233D63)" opacity="0.06">403</text>
      </svg>
    </div>

    <h1 id="error-title" class="error-page__title">{% trans %}Acceso restringido{% endtrans %}</h1>

    {# Subtitulo condicional segun autenticacion #}
    {% if is_authenticated %}
      <p class="error-page__subtitle">{% trans %}No tienes permisos para acceder a esta seccion. Contacta con el administrador si crees que es un error.{% endtrans %}</p>
    {% else %}
      <p class="error-page__subtitle">{% trans %}Inicia sesion para acceder a este recurso o registrate para crear una cuenta.{% endtrans %}</p>
    {% endif %}

    {# Botones condicionales #}
    <div class="error-page__actions">
      {% if is_authenticated %}
        <a href="{{ home_url|default('/') }}" class="error-page__btn--primary">
          {% trans %}Ir al inicio{% endtrans %}
        </a>
        <a href="{{ support_url|default('/ayuda') }}" class="error-page__btn--secondary">
          {% trans %}Contactar soporte{% endtrans %}
        </a>
      {% else %}
        <a href="{{ login_url|default('/user/login') }}" class="error-page__btn--primary">
          {% trans %}Iniciar sesion{% endtrans %}
        </a>
        <a href="{{ register_url|default('/user/register') }}" class="error-page__btn--secondary">
          {% trans %}Registrarse{% endtrans %}
        </a>
      {% endif %}
    </div>
  </section>

</main>

{# FOOTER #}
{% include '@ecosistema_jaraba_theme/partials/_footer.html.twig' with {
  site_name: site_name,
  logo: logo|default(''),
  theme_settings: theme_settings|default({})
} %}
