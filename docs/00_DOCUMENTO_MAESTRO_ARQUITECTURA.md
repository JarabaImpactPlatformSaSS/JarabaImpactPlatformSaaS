# ğŸ—ï¸ DOCUMENTO MAESTRO DE ARQUITECTURA
## Jaraba Impact Platform SaaS v73.0

**Fecha:** 2026-02-28
**VersiÃ³n:** 92.0.0 (Sistema de Coherencia Juridica LCIS 9 Capas â€” KB normativa + Intent Classifier + Normative Graph + Prompt Rules + Validator + Disclaimer + Multi-Turn)
**Estado:** Meta-Sitios 3 Idiomas (ES+EN+PT-BR) + Secrets Remediation (SECRET-MGMT-001) + Analytics Stack Completo (GTM + A/B + Heatmap + Tracking) + Auditoria IA 30/30 Completada (100/100) + AI Stack Clase Mundial (33 items: 23 FIX + 10 GAP) + Streaming Real + MCP Server + Native Function Calling + Empleabilidad Elevated + Andalucia EI Plan Maestro + Meta-Site Tenant-Aware + Tenant Remediation Complete + CWV Optimized + Produccion
**Nivel de Madurez:** 5.0 / 5.0 (Resiliencia & Cumplimiento Certificado)

---
## ğŸ“‘ Tabla de Contenidos

1. [VisiÃ³n del Proyecto](#1-visiÃ³n-del-proyecto)
2. [Propuesta de Valor](#2-propuesta-de-valor)
3. [Arquitectura de Alto Nivel](#3-arquitectura-de-alto-nivel)
4. [Stack TecnolÃ³gico](#4-stack-tecnolÃ³gico)
5. [Modelo Multi-Tenant](#5-modelo-multi-tenant)
6. [Modelo de Datos](#6-modelo-de-datos)
7. [MÃ³dulos del Sistema](#7-mÃ³dulos-del-sistema)
8. [Inteligencia Artificial](#8-inteligencia-artificial)
9. [Seguridad y Cumplimiento](#9-seguridad-y-cumplimiento)
10. [Infraestructura y DevOps](#10-infraestructura-y-devops)
11. [Roadmap](#11-roadmap)
12. [Estado de AuditorÃ­a (2026-02-13)](#12-estado-de-auditorÃ­a-2026-02-13)

---
13. [Referencias](#-referencias)
14. [Plan Maestro v3.0](#-plan-maestro-v30-auditorÃ­a-2026-01-23)
15. [Registro de Cambios](#15-registro-de-cambios)

---

## 1. VisiÃ³n del Proyecto

### 1.1 Â¿QuÃ© es Jaraba Impact Platform?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚   ğŸŒ± JARABA IMPACT PLATFORM                                             â”‚
â”‚                                                                         â”‚
â”‚   "La primera plataforma de comercio diseÃ±ada para que                  â”‚
â”‚    la Inteligencia Artificial venda tus productos"                      â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚   Productores    â”€â”€â–¶    Plataforma    â”€â”€â–¶    Consumidores       â”‚  â”‚
â”‚   â”‚   Locales              AI-First            Conscientes          â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚   ğŸ§‘â€ğŸŒ¾ ğŸ«’ ğŸ· ğŸ§€        ğŸ¤– ğŸ’» ğŸ“Š           ğŸ‘¥ ğŸ›’ ğŸ’š              â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Problema que Resuelve

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ANTES vs DESPUÃ‰S                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ANTES              â”‚              DESPUÃ‰S                        â”‚
â”‚                            â”‚                                             â”‚
â”‚  âŒ Productores aislados   â”‚  âœ… Ecosistema conectado                    â”‚
â”‚  âŒ Sin presencia digital  â”‚  âœ… Tienda online + IA                      â”‚
â”‚  âŒ Marketing inexistente  â”‚  âœ… Agentes IA de marketing                 â”‚
â”‚  âŒ Sin trazabilidad       â”‚  âœ… Blockchain + certificados               â”‚
â”‚  âŒ Ventas limitadas       â”‚  âœ… GEO: IA vende por ti                    â”‚
â”‚  âŒ GestiÃ³n manual         â”‚  âœ… AutomatizaciÃ³n completa                 â”‚
â”‚                            â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Propuesta de Valor

### 2.1 Para Productores

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BENEFICIOS PARA PRODUCTORES                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ›’ TIENDA ONLINE                                                      â”‚
â”‚   â””â”€â”€ E-commerce completo sin conocimientos tÃ©cnicos                    â”‚
â”‚       â””â”€â”€ Drupal Commerce 3.x con pagos Stripe                          â”‚
â”‚                                                                         â”‚
â”‚   ğŸ¤– AGENTES IA                                                         â”‚
â”‚   â”œâ”€â”€ ğŸ“ Storytelling: Genera biografÃ­as y descripciones                â”‚
â”‚   â”œâ”€â”€ ğŸ“£ Marketing: CampaÃ±as automÃ¡ticas en redes sociales              â”‚
â”‚   â”œâ”€â”€ ğŸ’¬ Customer Experience: Recordatorios y upselling                 â”‚
â”‚   â””â”€â”€ ğŸ“Š Analytics: Insights de negocio                                 â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“œ CERTIFICACIÃ“N                                                      â”‚
â”‚   â”œâ”€â”€ Firma digital con FNMT/AutoFirma                                  â”‚
â”‚   â”œâ”€â”€ Trazabilidad desde origen                                         â”‚
â”‚   â””â”€â”€ Anclaje blockchain (opcional)                                     â”‚
â”‚                                                                         â”‚
â”‚   ğŸ¨ MARCA PROPIA                                                       â”‚
â”‚   â””â”€â”€ PersonalizaciÃ³n visual por productor/cooperativa                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Para Consumidores

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BENEFICIOS PARA CONSUMIDORES                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ” TRANSPARENCIA                                                      â”‚
â”‚   â””â”€â”€ Conoce el origen exacto de cada producto                          â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“± TRAZABILIDAD                                                       â”‚
â”‚   â””â”€â”€ Escanea QR y ve todo el recorrido del producto                    â”‚
â”‚                                                                         â”‚
â”‚   ğŸŒ IMPACTO                                                            â”‚
â”‚   â””â”€â”€ Apoya directamente a productores locales                          â”‚
â”‚                                                                         â”‚
â”‚   ğŸ¤ CONFIANZA                                                          â”‚
â”‚   â””â”€â”€ Certificados digitales verificables                               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Estrategia GEO (Generative Engine Optimization)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              GEO                                         â”‚
â”‚           "OptimizaciÃ³n para Motores Generativos (IA)"                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   SEO Tradicional:                  GEO (Nuevo):                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚   â”‚   Google     â”‚                  â”‚   ChatGPT    â”‚                    â”‚
â”‚   â”‚   Ranking    â”‚                  â”‚   Perplexity â”‚                    â”‚
â”‚   â”‚   Keywords   â”‚                  â”‚   Claude     â”‚                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   Gemini     â”‚                    â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                         â”‚
â”‚   Â¿CÃ³mo funciona GEO?                                                   â”‚
â”‚                                                                         â”‚
â”‚   Usuario: "Â¿DÃ³nde comprar aceite de oliva premium en JaÃ©n?"            â”‚
â”‚                        â”‚                                                â”‚
â”‚                        â–¼                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ ChatGPT lee nuestra web (Answer Capsules + Schema.org)           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                        â”‚                                                â”‚
â”‚                        â–¼                                                â”‚
â”‚   "Te recomiendo la Cooperativa de JaÃ©n en jarabaagroconecta.com,       â”‚
â”‚    tienen aceite virgen extra con certificaciÃ³n de origen..."          â”‚
â”‚                                                                         â”‚
â”‚   ğŸ¯ LA IA VENDE POR NOSOTROS                                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Arquitectura de Alto Nivel

### 3.1 Diagrama de Contexto (C4 Level 1)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DIAGRAMA DE CONTEXTO                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                              USUARIOS                                    â”‚
â”‚                                                                         â”‚
â”‚        ğŸ‘¤              ğŸ‘¤              ğŸ‘¤              ğŸ‘¤               â”‚
â”‚    Administrador   Gestor Tenant   Productor       Cliente              â”‚
â”‚         â”‚               â”‚              â”‚               â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                 â”‚                                       â”‚
â”‚                                 â–¼                                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚                                               â”‚               â”‚
â”‚         â”‚      ğŸ¢ JARABA IMPACT PLATFORM                â”‚               â”‚
â”‚         â”‚         Drupal 11 + Commerce 3.x              â”‚               â”‚
â”‚         â”‚         Single-Instance Multi-Tenant          â”‚               â”‚
â”‚         â”‚                                               â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                 â”‚                                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â–¼           â–¼          â–¼          â–¼           â–¼                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚ ğŸ’³      â”‚ â”‚ ğŸ¤–      â”‚ â”‚ ğŸ“œ      â”‚ â”‚ ğŸ§       â”‚ â”‚ â›“ï¸      â”‚         â”‚
â”‚    â”‚ Stripe  â”‚ â”‚ OpenAI  â”‚ â”‚ FNMT    â”‚ â”‚ Qdrant  â”‚ â”‚ EBSI    â”‚         â”‚
â”‚    â”‚ Connect â”‚ â”‚ Claude  â”‚ â”‚ AutoFirmaâ”‚ â”‚ VectorDBâ”‚ â”‚ Blockchainâ”‚       â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                         â”‚
â”‚                        SISTEMAS EXTERNOS                                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Diagrama de Contenedores (C4 Level 2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DIAGRAMA DE CONTENEDORES                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                         FRONTEND                                    â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚â”‚
â”‚  â”‚  â”‚ ğŸ¨ Twig      â”‚  â”‚ ğŸ›’ Commerce  â”‚  â”‚ ğŸ’¬ Chat IA   â”‚              â”‚â”‚
â”‚  â”‚  â”‚ Templates    â”‚  â”‚ Storefront   â”‚  â”‚ Widget       â”‚              â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                        BACKEND DRUPAL 11                            â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚                    MÃ“DULOS CORE                               â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”‚ecosistema_ â”‚ â”‚ jaraba_    â”‚ â”‚ jaraba_    â”‚ â”‚ jaraba_    â”‚ â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”‚jaraba_core â”‚ â”‚ commerce   â”‚ â”‚ rag        â”‚ â”‚ social     â”‚ â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚                    SERVICIOS                                  â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”‚ Tenant     â”‚ â”‚ Plan       â”‚ â”‚ KB Indexer â”‚ â”‚ Agent      â”‚ â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â”‚ Manager    â”‚ â”‚ Validator  â”‚ â”‚ Service    â”‚ â”‚ Orchestratorâ”‚â”‚  â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                    â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â–¼                          â–¼                          â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ—„ï¸ MariaDB   â”‚          â”‚ ğŸ”´ Redis     â”‚          â”‚ ğŸ§  Qdrant    â”‚  â”‚
â”‚  â”‚ Database     â”‚          â”‚ Cache        â”‚          â”‚ VectorDB     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.6 Stack de Cumplimiento Fiscal N1 â­
IntegraciÃ³n unificada de soberanÃ­a legal y resiliencia tÃ©cnica:
- **SoberanÃ­a de Datos (jaraba_privacy)**: GestiÃ³n automatizada de DPA y ARCO-POL SLA.
- **Transparencia Contractual (jaraba_legal)**: ToS Lifecycle y monitorizaciÃ³n de SLA real.
- **Resiliencia & RecuperaciÃ³n (jaraba_dr)**: VerificaciÃ³n de backups SHA-256 y orquestaciÃ³n de DR Tests.

---

---

## 4. Stack TecnolÃ³gico

### 4.1 TecnologÃ­as Principales

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STACK TECNOLÃ“GICO                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   BACKEND                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Drupal 11.x      â”‚  PHP 8.4+         â”‚  Composer 2.x          â”‚  â”‚
â”‚   â”‚  CMS + Framework  â”‚  Lenguaje         â”‚  Dependencias          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   E-COMMERCE                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Commerce 3.x     â”‚  Stripe Connect   â”‚  Product Bundles       â”‚  â”‚
â”‚   â”‚  Drupal Nativo    â”‚  Split Payments   â”‚  Variaciones           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   BASE DE DATOS                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  MariaDB 10.11    â”‚  Redis 7.x        â”‚  Qdrant 1.16           â”‚  â”‚
â”‚   â”‚  Relacional       â”‚  Cache/Queue      â”‚  Vector DB             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   INTELIGENCIA ARTIFICIAL                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  OpenAI           â”‚  Anthropic        â”‚  Google AI             â”‚  â”‚
â”‚   â”‚  GPT-4 / Embeddingsâ”‚  Claude          â”‚  Gemini                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   INFRAESTRUCTURA                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  IONOS (Prod)     â”‚  Lando (Dev)      â”‚  GitHub Actions        â”‚  â”‚
â”‚   â”‚  Hosting          â”‚  Local Docker     â”‚  CI/CD                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Modelo Multi-Tenant

### 5.1 JerarquÃ­a del Ecosistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MODELO MULTI-TENANT                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                    ğŸ¢ PLATAFORMA JARABA                                  â”‚
â”‚                    (Single-Instance Drupal)                              â”‚
â”‚                              â”‚                                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚          â–¼                  â–¼                  â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ ğŸŒ¾ VERTICAL â”‚    â”‚ ğŸ“š VERTICALâ”‚    â”‚ ğŸ”ï¸ VERTICALâ”‚                   â”‚
â”‚   â”‚ AgroConectaâ”‚    â”‚ FormaTech  â”‚    â”‚ TurismoLocalâ”‚                  â”‚
â”‚   â”‚            â”‚    â”‚            â”‚    â”‚             â”‚                   â”‚
â”‚   â”‚ Productoresâ”‚    â”‚ FormaciÃ³n  â”‚    â”‚ Experienciasâ”‚                  â”‚
â”‚   â”‚ AgrÃ­colas  â”‚    â”‚ Online     â”‚    â”‚ TurÃ­sticas  â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚          â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â–¼                                 â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚ ğŸ›ï¸ TENANT   â”‚            â”‚ ğŸ›ï¸ TENANT   â”‚                              â”‚
â”‚   â”‚ Cooperativaâ”‚            â”‚ D.O.       â”‚                              â”‚
â”‚   â”‚ JaÃ©n       â”‚            â”‚ La Mancha  â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚          â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â–¼                                 â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚ ğŸ§‘â€ğŸŒ¾ PRODUCTORâ”‚            â”‚ ğŸ§‘â€ğŸŒ¾ PRODUCTORâ”‚                              â”‚
â”‚   â”‚ Finca      â”‚            â”‚ Bodega     â”‚                              â”‚
â”‚   â”‚ El Olivo   â”‚            â”‚ La ViÃ±a    â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Aislamiento de Datos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESTRATEGIA DE AISLAMIENTO                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Single-Instance + Group Module (NO multisite)                         â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    BASE DE DATOS ÃšNICA                           â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚
â”‚   â”‚  â”‚ Tenant Aâ”‚  â”‚ Tenant Bâ”‚  â”‚ Tenant Câ”‚  â”‚ Shared  â”‚            â”‚  â”‚
â”‚   â”‚  â”‚ (Group) â”‚  â”‚ (Group) â”‚  â”‚ (Group) â”‚  â”‚ Config  â”‚            â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚
â”‚   â”‚       â†‘            â†‘            â†‘            â†‘                  â”‚  â”‚
â”‚   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚   â”‚                         â”‚                                        â”‚  â”‚
â”‚   â”‚                  Group Content                                   â”‚  â”‚
â”‚   â”‚               (Aislamiento LÃ³gico)                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   VENTAJAS:                                                             â”‚
â”‚   âœ… Efecto red: Queries cruzadas (matching talento â†” empresas)        â”‚
â”‚   âœ… Mantenimiento: 1 actualizaciÃ³n para todos                          â”‚
â”‚   âœ… Escalabilidad: Sin lÃ­mite de tenants                               â”‚
â”‚   âœ… Datos compartidos: TaxonomÃ­as, catÃ¡logos                          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Modelo de Datos

### 6.1 Entidades Principales

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MODELO DE ENTIDADES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        VERTICAL                                  â”‚  â”‚
â”‚   â”‚  id, nombre, slug, descripciÃ³n, tema_base                        â”‚  â”‚
â”‚   â”‚  features[] (referencia a Feature Config Entity)                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚ 1:N                                     â”‚
â”‚                               â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                         TENANT                                   â”‚  â”‚
â”‚   â”‚  id, nombre, dominio, vertical_id (FK)                           â”‚  â”‚
â”‚   â”‚  plan_id (FK â†’ SaasPlan), group_id, domain_id                    â”‚  â”‚
â”‚   â”‚  configuraciÃ³n (logo, colores, credenciales)                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚ 1:N                                     â”‚
â”‚                               â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                       PRODUCTOR                                  â”‚  â”‚
â”‚   â”‚  id, nombre, email, telÃ©fono                                     â”‚  â”‚
â”‚   â”‚  tenant_id (FK), user_id (FK Drupal)                             â”‚  â”‚
â”‚   â”‚  estado (activo|suspendido|pendiente)                            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚ 1:N                                     â”‚
â”‚                               â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     COMMERCE PRODUCT                             â”‚  â”‚
â”‚   â”‚  id, tÃ­tulo, descripciÃ³n, SKU                                    â”‚  â”‚
â”‚   â”‚  precio, stock, imÃ¡genes                                         â”‚  â”‚
â”‚   â”‚  productor_id (FK), categorÃ­as                                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚ 1:N                                     â”‚
â”‚                               â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                          LOTE                                    â”‚  â”‚
â”‚   â”‚  id, cÃ³digo_trazabilidad, producto_id (FK)                       â”‚  â”‚
â”‚   â”‚  fecha_producciÃ³n, origen, hash_blockchain                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚ 1:N                                     â”‚
â”‚                               â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                      CERTIFICADO                                 â”‚  â”‚
â”‚   â”‚  id, tipo, lote_id (FK), fecha_emisiÃ³n                           â”‚  â”‚
â”‚   â”‚  firma_digital, validez, documento_pdf                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Planes SaaS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PLANES SAAS                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚    BÃSICO      â”‚  PROFESIONAL   â”‚   ENTERPRISE   â”‚                 â”‚
â”‚   â”‚    â‚¬49/mes     â”‚    â‚¬149/mes    â”‚    â‚¬499/mes    â”‚                 â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚   â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚   â”‚ 10 productores â”‚ 50 productores â”‚ âˆ productores  â”‚                 â”‚
â”‚   â”‚ 5 GB storage   â”‚ 25 GB storage  â”‚ 100 GB storage â”‚                 â”‚
â”‚   â”‚ 1 dominio      â”‚ 3 dominios     â”‚ âˆ dominios     â”‚                 â”‚
â”‚   â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚   â”‚ âŒ Agentes IA  â”‚ âœ… Agentes IA  â”‚ âœ… Agentes IA  â”‚                 â”‚
â”‚   â”‚ âŒ Firma FNMT  â”‚ âœ… Firma FNMT  â”‚ âœ… Firma FNMT  â”‚                 â”‚
â”‚   â”‚ âŒ Blockchain  â”‚ âŒ Blockchain  â”‚ âœ… Blockchain  â”‚                 â”‚
â”‚   â”‚ âŒ White-label â”‚ âŒ White-label â”‚ âœ… White-label â”‚                 â”‚
â”‚   â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚   â”‚ SLA: 99.5%     â”‚ SLA: 99.9%     â”‚ SLA: 99.95%    â”‚                 â”‚
â”‚   â”‚ Soporte: Email â”‚ Soporte: Chat  â”‚ Soporte: 24/7  â”‚                 â”‚
â”‚   â”‚                â”‚                â”‚                â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. MÃ³dulos del Sistema

### 7.1 MÃ³dulos Core & Inteligencia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MÃ“DULOS DE INTELIGENCIA                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
...
â”‚   ğŸ“¦ jaraba_ai_agents (v2.0) â­                                         â”‚
â”‚   â”œâ”€â”€ BaseAgent: Clase abstracta con DI flexible (Mock-ready)           â”‚
â”‚   â”‚   â””â”€â”€ buildSystemPrompt(): Inyecta regla identidad (parte #0)      â”‚
â”‚   â”œâ”€â”€ AgentOrchestrator: Enrutamiento dinÃ¡mico de intenciones           â”‚
â”‚   â””â”€â”€ JarabaLexCopilot: Asistente jurÃ­dico especializado                â”‚
â”‚                                                                         â”‚
â”‚   ğŸ›¡ï¸ AI IDENTITY ENFORCEMENT (AI-IDENTITY-001 + AI-COMPETITOR-001)     â”‚
â”‚   â”œâ”€â”€ BaseAgent.buildSystemPrompt(): Regla identidad como parte #0     â”‚
â”‚   â”‚   (heredada por 14+ agentes: Emprendimiento, Empleabilidad,        â”‚
â”‚   â”‚   JarabaLex, Legal, Sales, Merchant, Producer, Marketing, etc.)    â”‚
â”‚   â”œâ”€â”€ CopilotOrchestratorService.buildSystemPrompt(): $identityRule    â”‚
â”‚   â”‚   antepuesto a los 8 modos (coachâ†’landing_copilot)                 â”‚
â”‚   â”œâ”€â”€ PublicCopilotController: IDENTIDAD INQUEBRANTABLE en prompt      â”‚
â”‚   â”œâ”€â”€ FaqBotService: Regla en ambos prompts (KB + plataforma)          â”‚
â”‚   â”œâ”€â”€ ServiciosConectaCopilotAgent: Antepuesto a getSystemPromptFor()  â”‚
â”‚   â”œâ”€â”€ CoachIaService: Antepuesto a generateCoachingPrompt()            â”‚
â”‚   â””â”€â”€ AiContentController: Identidad "copywriter de Jaraba"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI REMEDIATION STACK (28 FIXES, 3 PHASES) â­              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ”’ AIIdentityRule (Centralizada, FIX-001)                            â”‚
â”‚   â”œâ”€â”€ ecosistema_jaraba_core/src/AI/AIIdentityRule.php                â”‚
â”‚   â”œâ”€â”€ static apply(string $prompt): string â€” inyecta regla identidad  â”‚
â”‚   â”œâ”€â”€ Consumida por: BaseAgent, SmartBaseAgent, CopilotOrchestrator,  â”‚
â”‚   â”‚   PublicCopilotController, FaqBotService, CoachIaService, etc.    â”‚
â”‚   â””â”€â”€ Reemplaza 14+ copias duplicadas de la regla de identidad        â”‚
â”‚                                                                         â”‚
â”‚   ğŸ›¡ï¸ AIGuardrailsService (Pipeline Completo, FIX-003 + FIX-028)      â”‚
â”‚   â”œâ”€â”€ 4 acciones: ALLOW, MODIFY, BLOCK, FLAG                         â”‚
â”‚   â”œâ”€â”€ checkPII(): DNI, NIE, IBAN ES, NIF/CIF, +34 (FIX-028)        â”‚
â”‚   â”œâ”€â”€ BLOCKED_PATTERNS: IBAN ES pattern anadido                       â”‚
â”‚   â”œâ”€â”€ RAG injection filter (FIX-009): detecta prompt injection        â”‚
â”‚   â””â”€â”€ Integrado en SmartBaseAgent.execute() pipeline                   â”‚
â”‚                                                                         â”‚
â”‚   ğŸ§  SmartBaseAgent (Contrato Restaurado, FIX-004)                    â”‚
â”‚   â”œâ”€â”€ Pipeline: guardrails â†’ model routing â†’ execute â†’ observability  â”‚
â”‚   â”œâ”€â”€ ModelRouterService: 3 tiers (fast/balanced/premium)             â”‚
â”‚   â”‚   â”œâ”€â”€ Regex bilingue EN+ES para assessComplexity() (FIX-019)     â”‚
â”‚   â”‚   â”œâ”€â”€ Pricing en YAML config (FIX-020):                          â”‚
â”‚   â”‚   â”‚   â””â”€â”€ jaraba_ai_agents.model_routing.yml (hot-updatable)     â”‚
â”‚   â”‚   â””â”€â”€ Modelos: Haiku 4.5 / Sonnet 4.6 / Opus 4.6               â”‚
â”‚   â”œâ”€â”€ AIObservabilityService: tracking completo (FIX-021)             â”‚
â”‚   â”‚   â”œâ”€â”€ BrandVoiceTrainerService: log() en indexExample + refine    â”‚
â”‚   â”‚   â””â”€â”€ WorkflowExecutorService: log() en success + failure paths  â”‚
â”‚   â””â”€â”€ @? UnifiedPromptBuilder: DI opcional (FIX-026)                  â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“Š AIOpsService (Metricas Reales, FIX-022)                          â”‚
â”‚   â”œâ”€â”€ getResourceMetrics(): /proc/stat, /proc/meminfo, disk_free     â”‚
â”‚   â”œâ”€â”€ getLatencyTrend(): AVG/P95 desde ai_telemetry table            â”‚
â”‚   â”œâ”€â”€ getErrorTrend(): error rates desde watchdog table               â”‚
â”‚   â””â”€â”€ getCurrentMonthlyCost(): SUM(cost_estimated) desde ai_telemetryâ”‚
â”‚                                                                         â”‚
â”‚   ğŸ”„ Streaming SSE (FIX-006 + FIX-024)                                â”‚
â”‚   â”œâ”€â”€ MIME: text/event-stream (no text/plain)                         â”‚
â”‚   â”œâ”€â”€ Eventos: mode, thinking, chunk, done, error                     â”‚
â”‚   â”œâ”€â”€ Chunking semantico: splitIntoParagraphs() (no 80-char)         â”‚
â”‚   â””â”€â”€ streaming_mode: 'buffered' en done event                        â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“ Canonical Verticals (FIX-027): 10 nombres canonicos             â”‚
â”‚   â”œâ”€â”€ empleabilidad, emprendimiento, comercioconecta, agroconecta    â”‚
â”‚   â”œâ”€â”€ jarabalex, serviciosconecta, andalucia_ei                      â”‚
â”‚   â”œâ”€â”€ jaraba_content_hub, formacion, demo                             â”‚
â”‚   â””â”€â”€ Aliases legacy: comercio_conectaâ†’comercioconecta, etc.         â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“ Agent Generations (FIX-025 â†’ Sprint 5 COMPLETE):                  â”‚
â”‚   â”œâ”€â”€ Gen 0: MarketingAgent (@deprecated â†’ SmartMarketingAgent)      â”‚
â”‚   â”œâ”€â”€ Gen 1: MIGRATED â€” 0 remaining (all promoted to Gen 2)         â”‚
â”‚   â””â”€â”€ Gen 2 (11 agents): SmartMarketing, Storytelling,              â”‚
â”‚       CustomerExperience, Support, ProducerCopilot, Sales,           â”‚
â”‚       MerchantCopilot, SmartEmployabilityCopilot,                    â”‚
â”‚       SmartLegalCopilot, SmartContentWriter                          â”‚
â”‚       + LearningPathAgent (Gen 2 in jaraba_lms)                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AI ELEVATION 10 GAPs â€” STREAMING + MCP + NATIVE TOOLS â­     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ”„ Streaming Real Token-by-Token (GAP-01)                            â”‚
â”‚   â”œâ”€â”€ StreamingOrchestratorService extends CopilotOrchestrator         â”‚
â”‚   â”œâ”€â”€ ChatInput::setStreamedOutput(TRUE) â†’ Provider real streaming     â”‚
â”‚   â”œâ”€â”€ PHP Generator yield: chunk, cached, done, error                  â”‚
â”‚   â”œâ”€â”€ Buffer 80 chars + PII masking incremental (GAP-03/10)           â”‚
â”‚   â””â”€â”€ Fallback automatico a buffered si servicio no disponible         â”‚
â”‚                                                                         â”‚
â”‚   ğŸ”§ Native Function Calling API-Level (GAP-09)                        â”‚
â”‚   â”œâ”€â”€ ToolRegistry::generateNativeToolsInput() â†’ ToolsInput           â”‚
â”‚   â”‚   â””â”€â”€ ToolsFunctionInput > ToolsPropertyInput (Drupal AI module)  â”‚
â”‚   â”œâ”€â”€ SmartBaseAgent::callAiApiWithNativeTools()                       â”‚
â”‚   â”‚   â”œâ”€â”€ ChatInput::setChatTools(ToolsInput) â€” API-level tools       â”‚
â”‚   â”‚   â”œâ”€â”€ ChatMessage::getTools() â†’ ToolsFunctionOutputInterface[]    â”‚
â”‚   â”‚   â””â”€â”€ Fallback a callAiApiWithTools() (text-based) si falla      â”‚
â”‚   â””â”€â”€ Loop iterativo max 5 (identico al text-based)                   â”‚
â”‚                                                                         â”‚
â”‚   ğŸŒ MCP Server JSON-RPC 2.0 (GAP-08)                                  â”‚
â”‚   â”œâ”€â”€ POST /api/v1/mcp â€” McpServerController::handle()                â”‚
â”‚   â”œâ”€â”€ Metodos: initialize, tools/list, tools/call, ping               â”‚
â”‚   â”œâ”€â”€ Protocol version: 2025-11-25                                     â”‚
â”‚   â”œâ”€â”€ PII sanitization en tool output                                  â”‚
â”‚   â””â”€â”€ Permiso: use ai agents + CSRF                                   â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¡ Distributed Tracing (GAP-02)                                       â”‚
â”‚   â”œâ”€â”€ TraceContextService: trace_id (UUID) + span_id por operacion    â”‚
â”‚   â””â”€â”€ Propagado a: observability, cache, guardrails, SSE done event   â”‚
â”‚                                                                         â”‚
â”‚   ğŸ§  Agent Long-Term Memory (GAP-07)                                    â”‚
â”‚   â”œâ”€â”€ AgentLongTermMemoryService: Qdrant + BD                         â”‚
â”‚   â”œâ”€â”€ Types: fact, preference, interaction_summary, correction         â”‚
â”‚   â””â”€â”€ remember() + recall() en buildSystemPrompt()                     â”‚
â”‚                                                                         â”‚
â”‚   ğŸ†• Sprint 5 â€” AI Services Clase Mundial (100/100):                    â”‚
â”‚   â”œâ”€â”€ AgentBenchmarkService: golden datasets + QualityEvaluator       â”‚
â”‚   â”‚   â””â”€â”€ AgentBenchmarkResult entity para tracking historico          â”‚
â”‚   â”œâ”€â”€ PromptVersionService + PromptTemplate ConfigEntity:             â”‚
â”‚   â”‚   â””â”€â”€ Version management, rollback, history per prompt            â”‚
â”‚   â”œâ”€â”€ BrandVoiceProfile ContentEntity: per-tenant brand voice         â”‚
â”‚   â”‚   â””â”€â”€ Extends TenantBrandVoiceService con entity persistence      â”‚
â”‚   â”œâ”€â”€ PersonalizationEngineService: unified recommendation engine     â”‚
â”‚   â”‚   â””â”€â”€ Orchestrates 6 source services                              â”‚
â”‚   â”œâ”€â”€ SemanticCache integration in CopilotOrchestrator:               â”‚
â”‚   â”‚   â””â”€â”€ Cache GET before LLM call, SET after response               â”‚
â”‚   â””â”€â”€ MultiModalBridgeService COMPLETE:                               â”‚
â”‚       â”œâ”€â”€ analyzeImage() (GPT-4o Vision)                              â”‚
â”‚       â”œâ”€â”€ transcribeAudio() (Whisper)                                 â”‚
â”‚       â”œâ”€â”€ synthesizeSpeech() (TTS-1/TTS-1-HD)                        â”‚
â”‚       â””â”€â”€ generateImage() (DALL-E 3)                                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         META-SITES ANALYTICS STACK (4 CAPAS) â­                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“Š Capa 1: Conversion Tracking (metasite-tracking.js)                â”‚
â”‚   â”œâ”€â”€ 6 behaviors: CTA clicks, form submits, scroll depth,           â”‚
â”‚   â”‚   engagement time, section views, cross-pollination               â”‚
â”‚   â””â”€â”€ dataLayer push para cada evento                                â”‚
â”‚                                                                         â”‚
â”‚   ğŸ§ª Capa 2: A/B Testing (metasite-experiments.js)                     â”‚
â”‚   â”œâ”€â”€ Cookie jb_exp_{id} persistente 30 dias, pesos por variante     â”‚
â”‚   â”œâ”€â”€ DOM manipulation: text/html/style/class/attribute/href         â”‚
â”‚   â”œâ”€â”€ Impression tracking: POST /api/experiments/{id}/impression     â”‚
â”‚   â””â”€â”€ dataLayer: experiment_view, experiment_conversion               â”‚
â”‚                                                                         â”‚
â”‚   ğŸ”¥ Capa 3: Heatmap (jaraba_heatmap/tracker)                          â”‚
â”‚   â”œâ”€â”€ heatmap-tracker.js: clicks, scroll, hover                      â”‚
â”‚   â”œâ”€â”€ HeatmapApiController (backend)                                 â”‚
â”‚   â””â”€â”€ Dashboard: /heatmap/analytics                                  â”‚
â”‚                                                                         â”‚
â”‚   ğŸŒ Capa 4: GTM/GA4 (_gtm-analytics.html.twig)                       â”‚
â”‚   â”œâ”€â”€ Google Consent Mode v2 (GDPR/RGPD defaults conservadores)      â”‚
â”‚   â”œâ”€â”€ GTM container ID desde theme_settings (configurable)           â”‚
â”‚   â”œâ”€â”€ GA4 standalone fallback si no hay GTM                          â”‚
â”‚   â””â”€â”€ dataLayer context push: meta_site, tenant_id, user_type        â”‚
â”‚                                                                         â”‚
â”‚   ğŸŒ SEO Internacional (_hreflang-meta.html.twig)                      â”‚
â”‚   â”œâ”€â”€ hreflang tags: es, en, x-default                               â”‚
â”‚   â””â”€â”€ Inyectado en html.html.twig <head>                             â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ Activacion: page--page-builder.html.twig                         â”‚
â”‚   â”œâ”€â”€ Condicionado: {% if meta_site %} (no cargar en dashboard)      â”‚
â”‚   â”œâ”€â”€ attach_library: ecosistema_jaraba_theme/metasite-tracking      â”‚
â”‚   â”œâ”€â”€ attach_library: ecosistema_jaraba_theme/metasite-experiments   â”‚
â”‚   â””â”€â”€ attach_library: jaraba_heatmap/tracker                        â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¡ PWA (preexistente)                                                â”‚
â”‚   â”œâ”€â”€ manifest.json + sw.js ya implementados                        â”‚
â”‚   â””â”€â”€ Sin cambios adicionales necesarios                            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STACK CUMPLIMIENTO FISCAL                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (Compliance)                                â”‚
â”‚   â”œâ”€â”€ ComplianceAggregator: ConsolidaciÃ³n de 9 KPIs crÃ­ticos             â”‚
â”‚   â””â”€â”€ FiscalComplianceService: Score 0-100 unificado                    â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_billing (Delegation)                                        â”‚
â”‚   â””â”€â”€ FiscalInvoiceDelegation: Enrutamiento VeriFactu / Facturae / B2B  â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_verifactu (SIF)                                             â”‚
â”‚   â”œâ”€â”€ HashChainService: Integridad irrefutable SHA-256                  â”‚
â”‚   â””â”€â”€ EventLogService: AuditorÃ­a append-only RD 1007/2023               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CUSTOMER SUCCESS & RETENCIÃ“N                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_customer_success (v2.0) â­                                  â”‚
â”‚   â”œâ”€â”€ Entidades (7): CustomerHealth, ChurnPrediction, CsPlaybook,      â”‚
â”‚   â”‚   PlaybookExecution, ExpansionSignal, VerticalRetentionProfile,     â”‚
â”‚   â”‚   SeasonalChurnPrediction (append-only)                             â”‚
â”‚   â”œâ”€â”€ Servicios (8): HealthScoreCalculator, ChurnPrediction,           â”‚
â”‚   â”‚   PlaybookExecutor, EngagementScoring, NpsSurvey, LifecycleStage,  â”‚
â”‚   â”‚   VerticalRetentionService, SeasonalChurnService                    â”‚
â”‚   â”œâ”€â”€ 5 Perfiles verticales: AgroConecta (cosecha), ComercioConecta    â”‚
â”‚   â”‚   (rebajas), ServiciosConecta (ROI), Empleabilidad (exito),        â”‚
â”‚   â”‚   Emprendimiento (fase)                                             â”‚
â”‚   â”œâ”€â”€ Dashboard FOC: /customer-success/retention (heatmap estacional)  â”‚
â”‚   â”œâ”€â”€ 13 Endpoints API REST (6 genericos + 7 verticalizados)           â”‚
â”‚   â””â”€â”€ QueueWorker: VerticalRetentionCronWorker (cron diario 03:00)     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VERTICAL: SERVICIOSCONECTA                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_servicios_conecta (v2.0 â€” Booking Engine) â­               â”‚
â”‚   â”œâ”€â”€ Entidades (5): ProviderProfile, ServiceOffering, Booking,        â”‚
â”‚   â”‚   AvailabilitySlot, ServicePackage                                  â”‚
â”‚   â”œâ”€â”€ Servicios (4): ProviderService, ServiceOfferingService,          â”‚
â”‚   â”‚   AvailabilityService (isSlotAvailable, hasCollision,              â”‚
â”‚   â”‚   markSlotBooked, releaseSlot), ReviewService                       â”‚
â”‚   â”œâ”€â”€ API REST: ServiceApiController (6 endpoints)                     â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /providers (marketplace listing)                        â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /providers/{id} (detail + offerings)                    â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /offerings (listing)                                    â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /providers/{id}/availability (slots)                    â”‚
â”‚   â”‚   â”œâ”€â”€ POST /bookings (create with validation)                      â”‚
â”‚   â”‚   â””â”€â”€ PATCH /bookings/{id} (state machine transitions)            â”‚
â”‚   â”œâ”€â”€ State Machine: pending_confirmation â†’ confirmed â†’                â”‚
â”‚   â”‚   completed / cancelled_client / cancelled_provider / no_show      â”‚
â”‚   â”œâ”€â”€ Cron: auto-cancel stale, reminders (24h/1h flags),              â”‚
â”‚   â”‚   no-show detection, expired slot cleanup                          â”‚
â”‚   â”œâ”€â”€ Notifications: hook_mail (5 templates), hook_entity_update       â”‚
â”‚   â””â”€â”€ Marketplace: Twig templates, zero-region preprocess              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SOPORTE AL CLIENTE CLASE MUNDIAL                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_support (v1.0 â€” Omnichannel Support) â­                   â”‚
â”‚   â”œâ”€â”€ Entidades (7+2): SupportTicket, TicketMessage, TicketAttachment, â”‚
â”‚   â”‚   TicketWatcher, TicketTag, TicketAiClassification,               â”‚
â”‚   â”‚   TicketAiResolution + SlaPolicy (Config), SupportSettings (Config)â”‚
â”‚   â”œâ”€â”€ Servicios (18): TicketService (state machine), SlaEngineService  â”‚
â”‚   â”‚   (policy resolution + business hours + pause/resume),             â”‚
â”‚   â”‚   BusinessHoursService (timezone + holidays + walking),            â”‚
â”‚   â”‚   TicketRoutingService (multi-factor: skills/vertical/workload),   â”‚
â”‚   â”‚   AttachmentService (upload + MIME/size/double-ext security),      â”‚
â”‚   â”‚   AttachmentScanService (ClamAV + 4-layer heuristic fallback),    â”‚
â”‚   â”‚   AttachmentUrlService (HMAC SHA-256 signed URLs 1h),             â”‚
â”‚   â”‚   TicketNotificationService, TicketMergeService, CsatSurveyServiceâ”‚
â”‚   â”‚   SupportHealthScoreService (5-component 0-100), TicketStreamSvc, â”‚
â”‚   â”‚   SupportCronService, SupportAnalyticsService,                     â”‚
â”‚   â”‚   TicketAiClassificationService, TicketAiResolutionService         â”‚
â”‚   â”œâ”€â”€ AI: SupportAgentSmartAgent (Gen 2, 5 actions:                   â”‚
â”‚   â”‚   classify_ticket, suggest_response, summarize_thread,             â”‚
â”‚   â”‚   detect_sentiment, draft_resolution)                              â”‚
â”‚   â”œâ”€â”€ API REST: SupportApiController (12+ endpoints)                  â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /tickets (listing with filters)                        â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets (create with auto-routing + SLA)              â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /tickets/{id} (detail + viewers)                       â”‚
â”‚   â”‚   â”œâ”€â”€ PATCH /tickets/{id} (status transitions)                    â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/{id}/messages (add message)                   â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/{id}/attachments (upload + scan)              â”‚
â”‚   â”‚   â”œâ”€â”€ GET  /tickets/{id}/attachments (list + signed URLs)         â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/{id}/classify (AI classification)             â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/{id}/suggest (AI resolution)                  â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/search (LIKE query)                           â”‚
â”‚   â”‚   â”œâ”€â”€ POST /tickets/inbound-email (emailâ†’ticket)                  â”‚
â”‚   â”‚   â””â”€â”€ GET  /attachments/download (HMAC signed)                    â”‚
â”‚   â”œâ”€â”€ SSE: SupportStreamController (Server-Sent Events)               â”‚
â”‚   â”‚   â””â”€â”€ GET  /support/stream (real-time ticket updates)             â”‚
â”‚   â”œâ”€â”€ State Machine (10 states): new â†’ ai_handling â†’ open â†’           â”‚
â”‚   â”‚   pending_customer/pending_internal â†’ escalated â†’ resolved â†’      â”‚
â”‚   â”‚   closed + reopened (re-enter open) + merged (lateral)            â”‚
â”‚   â”œâ”€â”€ SLA: {plan_tier}_{priority} policies, business hours,           â”‚
â”‚   â”‚   pause/resume with deadline extension, breach + warning           â”‚
â”‚   â”œâ”€â”€ Cron: SLA processing, attachment scans, auto-close 7d,         â”‚
â”‚   â”‚   CSAT surveys, SSE event purge 24h                               â”‚
â”‚   â”œâ”€â”€ Tables: support_ticket_events (SSE queue),                      â”‚
â”‚   â”‚   support_ticket_viewers (collision detection)                     â”‚
â”‚   â””â”€â”€ Tests: 26 unit tests / 134 assertions (4 files)                â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COMUNICACION: MENSAJERIA SEGURA (IMPLEMENTED)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_messaging (v1.0 â€” Implemented) ğŸ”’                         â”‚
â”‚   â”œâ”€â”€ Entidades (4): SecureConversation (ContentEntity),               â”‚
â”‚   â”‚   ConversationParticipant (ContentEntity),                         â”‚
â”‚   â”‚   + SecureMessage (custom table), MessageAuditLog (custom table)   â”‚
â”‚   â”œâ”€â”€ Modelos (3): SecureMessageDTO (readonly), EncryptedPayload      â”‚
â”‚   â”‚   (Value Object), IntegrityReport (Value Object)                   â”‚
â”‚   â”œâ”€â”€ Servicios (18): MessagingService, ConversationService,           â”‚
â”‚   â”‚   MessageService, MessageEncryptionService, TenantKeyService,      â”‚
â”‚   â”‚   MessageAuditService, NotificationBridgeService,                  â”‚
â”‚   â”‚   AttachmentBridgeService, PresenceService, SearchService,         â”‚
â”‚   â”‚   RetentionService, + 7 Access Checks                             â”‚
â”‚   â”œâ”€â”€ Controladores (7): Conversation, Message, Presence, Search,     â”‚
â”‚   â”‚   Audit, Export (RGPD Art.20), MessagingPage (frontend)            â”‚
â”‚   â”œâ”€â”€ Cifrado: AES-256-GCM + Argon2id KDF + per-tenant keys          â”‚
â”‚   â”œâ”€â”€ Audit: SHA-256 hash chain (append-only, inmutable)              â”‚
â”‚   â”œâ”€â”€ API REST: 20+ endpoints + cursor-based pagination               â”‚
â”‚   â”œâ”€â”€ WebSocket: Ratchet (dev) / Swoole (prod) + Redis pub/sub       â”‚
â”‚   â”œâ”€â”€ ECA Plugins (8): 3 eventos, 3 condiciones, 2 acciones          â”‚
â”‚   â”œâ”€â”€ Frontend: 9 templates Twig (zero-region), 11 SCSS, 4 JS        â”‚
â”‚   â”œâ”€â”€ Permisos (13): 8 roles (cliente â†’ super_admin)                  â”‚
â”‚   â””â”€â”€ Total: 104 archivos, 6 sprints completados                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PRECIOS CONFIGURABLES v2.1 â­                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (Plan Config) â­                           â”‚
â”‚   â”œâ”€â”€ ConfigEntities (2):                                              â”‚
â”‚   â”‚   â”œâ”€â”€ SaasPlanTier: tier_key, aliases, Stripe Price IDs, weight   â”‚
â”‚   â”‚   â””â”€â”€ SaasPlanFeatures: vertical+tier, features[], limits{}       â”‚
â”‚   â”œâ”€â”€ PlanResolverService (broker central):                            â”‚
â”‚   â”‚   â”œâ”€â”€ normalize(): Alias â†’ tier key canonico                      â”‚
â”‚   â”‚   â”œâ”€â”€ getFeatures(): Cascade especifico â†’ default â†’ NULL          â”‚
â”‚   â”‚   â”œâ”€â”€ checkLimit() / hasFeature(): Consultas atomicas             â”‚
â”‚   â”‚   â”œâ”€â”€ resolveFromStripePriceId(): Resolucion inversa Stripe       â”‚
â”‚   â”‚   â””â”€â”€ getPlanCapabilities(): Array plano para QuotaManager        â”‚
â”‚   â”œâ”€â”€ Seed Data: 21 YAMLs (3 tiers + 3 defaults + 15 verticales)    â”‚
â”‚   â”œâ”€â”€ Admin UI: /admin/config/jaraba/plan-tiers + plan-features      â”‚
â”‚   â”œâ”€â”€ Drush: jaraba:validate-plans (completitud de configs)           â”‚
â”‚   â”œâ”€â”€ Update Hook: 9019 (FileStorage + CONFIG-SEED-001)              â”‚
â”‚   â””â”€â”€ SCSS: _plan-admin.scss (body class page-plan-admin)            â”‚
â”‚                                                                         â”‚
â”‚   Integraciones cross-module (inyeccion @? opcional):                  â”‚
â”‚   â”œâ”€â”€ QuotaManagerService (jaraba_page_builder): PlanResolver first   â”‚
â”‚   â”‚   con fallback a array hardcoded para backwards-compat            â”‚
â”‚   â”œâ”€â”€ PlanValidator (jaraba_billing): 3-source cascade                â”‚
â”‚   â”‚   FVL â†’ PlanFeatures â†’ SaasPlan fallback                         â”‚
â”‚   â””â”€â”€ BillingWebhookController: Stripe Price ID â†’ tier resolution    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EMPLEABILIDAD: PERFIL PREMIUM ELEVADO â­         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_candidate (v3.0 â€” Profile Elevation) â­                   â”‚
â”‚   â”œâ”€â”€ CandidateProfileForm (premium sectioned):                        â”‚
â”‚   â”‚   â”œâ”€â”€ 6 secciones: Personal, Profesional, Ubicacion, Preferencias,â”‚
â”‚   â”‚   â”‚   Presencia Online, Privacidad                                 â”‚
â”‚   â”‚   â”œâ”€â”€ HIDDEN_FIELDS: user_id, uid, created, changed, etc.        â”‚
â”‚   â”‚   â”œâ”€â”€ FIELD_LABELS: 30+ campos con labels en espanol              â”‚
â”‚   â”‚   â””â”€â”€ Glass-card UI con navigation pills                          â”‚
â”‚   â”œâ”€â”€ ProfileSectionForm (generico):                                   â”‚
â”‚   â”‚   â””â”€â”€ CRUD slide-panel para education, experience, language       â”‚
â”‚   â”œâ”€â”€ ProfileSectionFormController: add/edit/delete por entity_type   â”‚
â”‚   â”‚   â””â”€â”€ isSlidePanelRequest(): XHR sin _wrapper_format = slide-panelâ”‚
â”‚   â”œâ”€â”€ Campo photo: entity_reference â†’ image (image_image widget)      â”‚
â”‚   â”‚   â””â”€â”€ update_10004: backup refs, uninstall, install, restore      â”‚
â”‚   â”œâ”€â”€ Campos date: timestamp â†’ datetime (education, experience)       â”‚
â”‚   â”‚   â””â”€â”€ update_10005: reinstall entities para cambio de tipo        â”‚
â”‚   â”œâ”€â”€ CvController: slide-panel AJAX + PNG preview fallback           â”‚
â”‚   â”‚   â””â”€â”€ 5 CV preview PNGs (classic, creative, minimal, modern, tech)â”‚
â”‚   â”œâ”€â”€ Seccion idiomas: ruta + languagesSection() + template           â”‚
â”‚   â”œâ”€â”€ ProfileCompletionService: entity queries para secciones         â”‚
â”‚   â”‚   â””â”€â”€ hasRelatedEntities() para experience/education/skills/langs â”‚
â”‚   â””â”€â”€ profile_section_manager.js: delete confirmation + AJAX          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ANDALUCIA EI: PLAN MAESTRO 8 FASES â­            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_andalucia_ei (v2.0 â€” Plan Maestro) â­                    â”‚
â”‚   â”œâ”€â”€ Fase 1: P0/P1 fixes (AiMentorshipTracker, StoExportService,    â”‚
â”‚   â”‚   tenant isolation, DI, SCSS)                                      â”‚
â”‚   â”œâ”€â”€ Fase 2: 11 bloques Page Builder verticales (hero, features,     â”‚
â”‚   â”‚   content, gallery, faq, testimonials, social_proof, stats,        â”‚
â”‚   â”‚   pricing, cta, map) + config YAMLs + templates + update hook     â”‚
â”‚   â”œâ”€â”€ Fase 3: Landing conversion /andalucia-ei/programa               â”‚
â”‚   â”‚   â””â”€â”€ Zero Region + Open Graph + Schema.org JSON-LD               â”‚
â”‚   â”œâ”€â”€ Fase 4: Portal participante /andalucia-ei/mi-participacion      â”‚
â”‚   â”‚   â”œâ”€â”€ Health score gauge, timeline expandida con sub-steps        â”‚
â”‚   â”‚   â”œâ”€â”€ Training progress, quick actions, achievements/badges       â”‚
â”‚   â”‚   â””â”€â”€ PDF progress report generation                               â”‚
â”‚   â”œâ”€â”€ Fase 5: ExpedienteDocumento entity (19 categorias documentales) â”‚
â”‚   â”‚   â”œâ”€â”€ Vault cifrado, revision IA, firmas digitales               â”‚
â”‚   â”‚   â””â”€â”€ STO compliance tracking + CRUD + Field UI                   â”‚
â”‚   â”œâ”€â”€ Fase 6: Mensajeria integration (CONTEXT_ANDALUCIA_EI,          â”‚
â”‚   â”‚   MensajeriaIntegrationService, widget)                            â”‚
â”‚   â”œâ”€â”€ Fase 7: AI automation (CopilotContextProvider,                  â”‚
â”‚   â”‚   AdaptiveDifficultyEngine, 4 nudge rules proactivos)             â”‚
â”‚   â””â”€â”€ Fase 8: SEO/marketing (sitemap, lead magnet guide page)        â”‚
â”‚                                                                         â”‚
â”‚   Nuevas entidades: ExpedienteDocumento (ContentEntity, 19 categorias)â”‚
â”‚   Nuevos servicios (7): ExpedienteService, DocumentoRevisionIaService,â”‚
â”‚   InformeProgresoPdfService, MensajeriaIntegrationService,            â”‚
â”‚   AdaptiveDifficultyEngine, AndaluciaEiCopilotContextProvider,        â”‚
â”‚   AndaluciaEiJourneyProgressionService                                 â”‚
â”‚   71 ficheros, +6644/-531 lineas                                       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      META-SITE: TENANT-AWARE RENDERING â­             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_site_builder (MetaSiteResolverService)                    â”‚
â”‚   â”œâ”€â”€ resolveFromPageContent(): PageContent â†’ meta-site context       â”‚
â”‚   â”œâ”€â”€ resolveFromRequest(): 3-strategy domain â†’ tenant resolution    â”‚
â”‚   â”‚   â”œâ”€â”€ Strategy 1: Domain Access hostname match                   â”‚
â”‚   â”‚   â”œâ”€â”€ Strategy 2: Tenant.domain field match                      â”‚
â”‚   â”‚   â””â”€â”€ Strategy 3: Subdomain prefix â†’ Tenant.domain STARTS_WITH  â”‚
â”‚   â”œâ”€â”€ buildMetaSiteContext(): SiteConfig + SitePageTree â†’ nav/footer  â”‚
â”‚   â”œâ”€â”€ Fix: SitePageTree status filter 'published' â†’ 1 (int)          â”‚
â”‚   â””â”€â”€ Per-request static cache (evita queries repetidas)              â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_geo (Schema.org tenant-aware)                             â”‚
â”‚   â””â”€â”€ Organization schema: name/description/logo from SiteConfig     â”‚
â”‚       cuando la pagina pertenece a un meta-sitio                       â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_theme (overrides tenant-aware)                 â”‚
â”‚   â”œâ”€â”€ preprocess_html: <title> con meta_title_suffix de SiteConfig   â”‚
â”‚   â”‚   + body class meta-site meta-site-tenant-{id}                    â”‚
â”‚   â”œâ”€â”€ preprocess_page: site_name, navigation, header/footer,         â”‚
â”‚   â”‚   logo, CTA, copyright desde SiteConfig + SitePageTree            â”‚
â”‚   â”œâ”€â”€ preprocess_page__user: attach skills_manager + section_manager â”‚
â”‚   â”œâ”€â”€ CWV Optimization (Sprint 5):                                    â”‚
â”‚   â”‚   â”œâ”€â”€ 7 CSS bundles extracted from main.scss (code splitting)    â”‚
â”‚   â”‚   â”œâ”€â”€ cwv-tracking.js: PerformanceObserver (LCP,CLS,INP,FCP,TTFB)â”‚
â”‚   â”‚   â”œâ”€â”€ fetchpriority="high" on 10 hero templates                  â”‚
â”‚   â”‚   â”œâ”€â”€ AVIF + WebP responsive images via _responsive-image.twig   â”‚
â”‚   â”‚   â””â”€â”€ responsive_image() Twig function                           â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_crm (Premium Forms)                                       â”‚
â”‚   â””â”€â”€ 5 forms migrados a PremiumEntityFormBase: Company, Contact,    â”‚
â”‚       Opportunity, Activity, PipelineStage (glass-card UI + pills)    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TENANT BRIDGE: RESOLUCION TENANTâ†”GROUP â­        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (TenantBridge)                             â”‚
â”‚   â”œâ”€â”€ TenantBridgeService (ecosistema_jaraba_core.tenant_bridge):     â”‚
â”‚   â”‚   â”œâ”€â”€ getTenantForGroup(GroupInterface): TenantInterface          â”‚
â”‚   â”‚   â”œâ”€â”€ getGroupForTenant(TenantInterface): GroupInterface          â”‚
â”‚   â”‚   â”œâ”€â”€ getTenantIdForGroup(int $groupId): int                     â”‚
â”‚   â”‚   â””â”€â”€ getGroupIdForTenant(int $tenantId): int                    â”‚
â”‚   â”œâ”€â”€ Dependencias: entity_type.manager                               â”‚
â”‚   â”œâ”€â”€ Error handling: \InvalidArgumentException si entidad no existe  â”‚
â”‚   â”‚                                                                     â”‚
â”‚   Consumidores (inyeccion @ecosistema_jaraba_core.tenant_bridge):     â”‚
â”‚   â”œâ”€â”€ QuotaManagerService: Groupâ†’Tenant para billing quota checks     â”‚
â”‚   â”œâ”€â”€ BillingController: Tenant entity para operaciones de cobro      â”‚
â”‚   â”œâ”€â”€ BillingService: Tenant entity para suscripciones Stripe        â”‚
â”‚   â”œâ”€â”€ StripeWebhookController: Tenant entity para webhook processing â”‚
â”‚   â””â”€â”€ SaasPlan: Tenant entity para plan management                    â”‚
â”‚                                                                         â”‚
â”‚   Regla TENANT-BRIDGE-001: NUNCA cargar getStorage('group') con      â”‚
â”‚   Tenant IDs ni viceversa. Tenant = billing, Group = content isolationâ”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TENANT ISOLATION: ACCESS CONTROL â­               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_page_builder (Access Control)                              â”‚
â”‚   â”œâ”€â”€ PageContentAccessControlHandler (EntityHandlerInterface + DI):  â”‚
â”‚   â”‚   â”œâ”€â”€ createInstance(): Inyecta TenantContextService              â”‚
â”‚   â”‚   â”œâ”€â”€ checkAccess(): view=publicado, update/delete=isSameTenant() â”‚
â”‚   â”‚   â”œâ”€â”€ isSameTenant(): (int) entity.tenant_id === currentTenantId â”‚
â”‚   â”‚   â””â”€â”€ checkCreateAccess(): authenticated + create permission      â”‚
â”‚   â”‚                                                                     â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (Generic Access + Path + Context)         â”‚
â”‚   â”œâ”€â”€ DefaultEntityAccessControlHandler (renombrado desde             â”‚
â”‚   â”‚   DefaultAccessControlHandler): Fallback generico para entidades  â”‚
â”‚   â”‚   sin handler especifico                                           â”‚
â”‚   â”œâ”€â”€ PathProcessorPageContent: Tenant-aware path resolution          â”‚
â”‚   â”‚   â”œâ”€â”€ Inyecta TenantContextService (@? opcional)                  â”‚
â”‚   â”‚   â””â”€â”€ Filtra por tenant_id del contexto actual si disponible     â”‚
â”‚   â”œâ”€â”€ TenantContextService (enhanced):                                â”‚
â”‚   â”‚   â”œâ”€â”€ getCurrentTenantId(): ?int (nullable cuando no hay grupo)  â”‚
â”‚   â”‚   â””â”€â”€ Resiliente a usuarios sin grupo (returns NULL, no throws)  â”‚
â”‚   â”‚                                                                     â”‚
â”‚   Politica de acceso (TENANT-ISOLATION-ACCESS-001):                   â”‚
â”‚   â”œâ”€â”€ view: Paginas publicadas son publicas (status=1)               â”‚
â”‚   â”œâ”€â”€ update: Solo si isSameTenant() + permiso                       â”‚
â”‚   â”œâ”€â”€ delete: Solo si isSameTenant() + permiso                       â”‚
â”‚   â””â”€â”€ create: Solo authenticated + permiso de creacion               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PAGE BUILDER: PATHPROCESSOR + META-SITIO â­       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_page_builder (PathProcessor)                                â”‚
â”‚   â”œâ”€â”€ PathProcessorPageContent: InboundPathProcessorInterface          â”‚
â”‚   â”‚   â”œâ”€â”€ processInbound(): path_alias â†’ /page/{id} resolution        â”‚
â”‚   â”‚   â”œâ”€â”€ resolveHomepage(): Root / â†’ homepage por dominio/tenant     â”‚
â”‚   â”‚   â”‚   (usa MetaSiteResolverService para resolver hostname)        â”‚
â”‚   â”‚   â”œâ”€â”€ Prioridad 250 (superior a PathProcessorFront=200)           â”‚
â”‚   â”‚   â”œâ”€â”€ 4to parametro: @?MetaSiteResolverService (DI opcional)     â”‚
â”‚   â”‚   â”œâ”€â”€ Sin filtro status â†’ AccessControlHandler gestiona acceso    â”‚
â”‚   â”‚   â”œâ”€â”€ Skip list: /api/, /admin/, /user/, /media/, /session/       â”‚
â”‚   â”‚   â””â”€â”€ Static cache por path dentro del request                     â”‚
â”‚   â”‚                                                                     â”‚
â”‚   Meta-Sitio jarabaimpact.com (7 paginas):                              â”‚
â”‚   â”œâ”€â”€ Homepage: /jarabaimpact (Hero + plataforma SaaS)                 â”‚
â”‚   â”œâ”€â”€ Plataforma: /plataforma (Triple Motor Economico)                 â”‚
â”‚   â”œâ”€â”€ Verticales: /verticales (6 verticales SaaS)                      â”‚
â”‚   â”œâ”€â”€ Impacto: /impacto (Estadisticas + beneficiarios)                 â”‚
â”‚   â”œâ”€â”€ Programas: /programas (Programas institucionales)                â”‚
â”‚   â”œâ”€â”€ Recursos: /recursos (Centro de recursos)                         â”‚
â”‚   â””â”€â”€ Contacto: /contacto (Formulario + datos)                         â”‚
â”‚                                                                         â”‚
â”‚   Meta-Sitio pepejaraba.com (9 paginas, Tenant ID=5):                  â”‚
â”‚   â”œâ”€â”€ Inicio: / (Hero + pain points + metodo + ecosistema)            â”‚
â”‚   â”œâ”€â”€ Manifiesto: /manifiesto                                          â”‚
â”‚   â”œâ”€â”€ Metodo Jaraba: /metodo-jaraba                                    â”‚
â”‚   â”œâ”€â”€ Casos de Exito: /casos-de-exito                                  â”‚
â”‚   â”œâ”€â”€ Blog: /blog                                                      â”‚
â”‚   â”œâ”€â”€ Contacto: /contacto-pepe                                         â”‚
â”‚   â”œâ”€â”€ Aviso Legal: /aviso-legal                                        â”‚
â”‚   â”œâ”€â”€ Politica Privacidad: /politica-privacidad                        â”‚
â”‚   â””â”€â”€ Politica Cookies: /politica-cookies                              â”‚
â”‚                                                                         â”‚
â”‚   APIs Usadas:                                                          â”‚
â”‚   â”œâ”€â”€ PATCH /api/v1/pages/{id}/config (tÃ­tulo + path_alias)            â”‚
â”‚   â”œâ”€â”€ POST /api/v1/pages/{id}/publish (publicaciÃ³n)                    â”‚
â”‚   â””â”€â”€ GrapesJS API (contenido visual del canvas)                       â”‚
â”‚                                                                         â”‚
â”‚   ğŸ”’ Concurrent Edit Locking (Sprint 5):                               â”‚
â”‚   â”œâ”€â”€ Optimistic locking: `changed` timestamp + X-Entity-Changed      â”‚
â”‚   â”œâ”€â”€ PageContent fields: edit_lock_uid + edit_lock_expires            â”‚
â”‚   â”œâ”€â”€ 3 API endpoints: acquire/release/status lock                    â”‚
â”‚   â””â”€â”€ JS heartbeat renewal + conflict notifications                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VERTICAL: EMPLEABILIDAD â­                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_candidate (v2.0 â€” Profile Premium) â­                     â”‚
â”‚   â”œâ”€â”€ Entidades (6): CandidateProfile, CandidateSkill,                â”‚
â”‚   â”‚   CandidateExperience, CandidateEducation (NEW),                  â”‚
â”‚   â”‚   CandidateLanguage, CopilotConversation + CopilotMessage         â”‚
â”‚   â”œâ”€â”€ Premium /my-profile: 7 secciones glassmorphism                  â”‚
â”‚   â”‚   â”œâ”€â”€ Hero: Avatar, nombre, headline, ubicacion, badge            â”‚
â”‚   â”‚   â”œâ”€â”€ About: Summary (|safe_html XSS-safe) + nivel educacion     â”‚
â”‚   â”‚   â”œâ”€â”€ Experience: Timeline cronologica descendente                 â”‚
â”‚   â”‚   â”œâ”€â”€ Education: Grid de registros CandidateEducation              â”‚
â”‚   â”‚   â”œâ”€â”€ Skills: Pills con badge de verificacion                     â”‚
â”‚   â”‚   â”œâ”€â”€ Links: LinkedIn, GitHub, Portfolio, Website                  â”‚
â”‚   â”‚   â””â”€â”€ CTA: Completion ring SVG + enlace a edicion                 â”‚
â”‚   â”œâ”€â”€ Empty State: Glassmorphism card + benefit cards + CTA            â”‚
â”‚   â”œâ”€â”€ ProfileController: Carga resiliente (try/catch por entidad)     â”‚
â”‚   â”œâ”€â”€ SCSS: 920 lineas, design tokens --ej-*, BEM cp-*, responsive   â”‚
â”‚   â”œâ”€â”€ Iconos: 15 pares jaraba_icon() duotone verificados              â”‚
â”‚   â””â”€â”€ Admin: /admin/content/candidate-educations con Field UI         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ICON SYSTEM: ZERO CHINCHETAS â­                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (Icon Engine)                              â”‚
â”‚   â”œâ”€â”€ JarabaTwigExtension: jaraba_icon() Twig function                â”‚
â”‚   â”‚   â”œâ”€â”€ Firma: jaraba_icon(category, name, {variant, color, size})  â”‚
â”‚   â”‚   â”œâ”€â”€ Resolucion: {modulePath}/images/icons/{category}/{name}     â”‚
â”‚   â”‚   â”‚   [-variant].svg                                               â”‚
â”‚   â”‚   â”œâ”€â”€ Variantes: outline (default), outline-bold, filled, duotone â”‚
â”‚   â”‚   â”œâ”€â”€ Fallback: emoji via getFallbackEmoji() â†’ ğŸ“Œ (chincheta)    â”‚
â”‚   â”‚   â””â”€â”€ Inline SVG: stroke/fill inherits CSS currentColor           â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ Categorias primarias (6):                                        â”‚
â”‚   â”‚   â”œâ”€â”€ actions/ (download, check, search, sparkles, etc.)          â”‚
â”‚   â”‚   â”œâ”€â”€ fiscal/ (invoice, balance, treasury, etc.)                  â”‚
â”‚   â”‚   â”œâ”€â”€ media/ (play-circle, image, camera)                         â”‚
â”‚   â”‚   â”œâ”€â”€ micro/ (arrow-right, chevron-down, dot â€” 12px)             â”‚
â”‚   â”‚   â”œâ”€â”€ ui/ (settings, globe, lock, file-text, etc.)               â”‚
â”‚   â”‚   â””â”€â”€ users/ (user, group, id-card)                               â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ Bridge categories (7 â€” symlinks a categorias primarias):        â”‚
â”‚   â”‚   â”œâ”€â”€ achievement/ â†’ actions/ (trophy, medal, target, etc.)       â”‚
â”‚   â”‚   â”œâ”€â”€ finance/ â†’ fiscal/ (wallet, credit-card, coins, etc.)      â”‚
â”‚   â”‚   â”œâ”€â”€ general/ â†’ ui/ (settings, info, alert-triangle, etc.)      â”‚
â”‚   â”‚   â”œâ”€â”€ legal/ â†’ ui/ (scale, shield, file-text, etc.)              â”‚
â”‚   â”‚   â”œâ”€â”€ navigation/ â†’ ui/ (home, menu, compass, etc.)              â”‚
â”‚   â”‚   â”œâ”€â”€ status/ â†’ ui/ (check-circle, clock, alert-circle, etc.)    â”‚
â”‚   â”‚   â””â”€â”€ tools/ â†’ ui/ (wrench, code, terminal, etc.)                â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ Categorias verticales (2):                                      â”‚
â”‚   â”‚   â”œâ”€â”€ commerce/ (store, cart, catalog, delivery-truck, etc.)     â”‚
â”‚   â”‚   â””â”€â”€ business/ (rocket, briefcase, empleo, time-pressure,       â”‚
â”‚   â”‚       launch-idea, talent-spotlight, career-connect,              â”‚
â”‚   â”‚       seed-momentum, store-digital + duotone cada)                â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ SVGs: ~352 iconos (outline + duotone por cada)                  â”‚
â”‚   â”‚   â”œâ”€â”€ Outline: stroke-only, stroke-width="2"                      â”‚
â”‚   â”‚   â”œâ”€â”€ Duotone: stroke + fill con opacity="0.2" para capas fondo  â”‚
â”‚   â”‚   â””â”€â”€ Canvas inline: hex explicito (#233D63), NO currentColor    â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ Auditoria Templates: 305 pares unicos verificados, 0 chinchetasâ”‚
â”‚   â”‚   â”œâ”€â”€ 32 llamadas con convencion rota corregidas (4 modulos)      â”‚
â”‚   â”‚   â”œâ”€â”€ ~170 SVGs/symlinks creados para bridge categories           â”‚
â”‚   â”‚   â”œâ”€â”€ 2 symlinks circulares corregidos (ui/save, bookmark)        â”‚
â”‚   â”‚   â””â”€â”€ 1 symlink roto reparado (general/alert-duotone)            â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â””â”€â”€ Auditoria Canvas Data: 11 emojis Unicode eliminados (4 paginas)â”‚
â”‚       â”œâ”€â”€ Page 57: 6 emojis â†’ 6 SVGs inline business/ (duotone)      â”‚
â”‚       â”œâ”€â”€ Pages 60-62: 5 emojis â†’ 5 SVGs inline estandar            â”‚
â”‚       â””â”€â”€ ICON-EMOJI-001 + ICON-CANVAS-INLINE-001 nuevas             â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SEGURIDAD: ACCESS HANDLERS â­                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ACCESS-STRICT-001 (Auditoria Horizontal)                             â”‚
â”‚   â”œâ”€â”€ 52 instancias de == (loose equality) â†’ (int) === (int)          â”‚
â”‚   â”œâ”€â”€ 39 access handlers en 21 modulos                                 â”‚
â”‚   â”œâ”€â”€ Patrones corregidos:                                             â”‚
â”‚   â”‚   â”œâ”€â”€ $entity->getOwnerId() == $account->id()                    â”‚
â”‚   â”‚   â”œâ”€â”€ $entity->get('field')->target_id == $account->id()          â”‚
â”‚   â”‚   â””â”€â”€ $merchant->getOwnerId() == $account->id()                  â”‚
â”‚   â”œâ”€â”€ Fix universal: (int) LHS === (int) $account->id()              â”‚
â”‚   â”œâ”€â”€ Previene type juggling: "0"==false, null==0, ""==0             â”‚
â”‚   â””â”€â”€ Verificacion: grep "== $account->id()" | grep -v "===" â†’ 0    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EMAIL: CAN-SPAM COMPLIANCE â­                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_email (28 plantillas horizontales)                         â”‚
â”‚   â”œâ”€â”€ Grupos: base (1) + auth (5) + billing (7) + marketplace (6)    â”‚
â”‚   â”‚   + fiscal (3) + andalucia_ei (6)                                 â”‚
â”‚   â”œâ”€â”€ CAN-SPAM Compliance:                                             â”‚
â”‚   â”‚   â”œâ”€â”€ <mj-preview>: Preheader unico por plantilla (28/28)        â”‚
â”‚   â”‚   â”œâ”€â”€ Direccion postal: Juncaril, Albolote (28/28)               â”‚
â”‚   â”‚   â””â”€â”€ Opt-out: {{ unsubscribe_url }} (ya existia)                â”‚
â”‚   â”œâ”€â”€ Brand Consistency:                                               â”‚
â”‚   â”‚   â”œâ”€â”€ Font: Outfit, Arial, Helvetica, sans-serif (28/28)         â”‚
â”‚   â”‚   â”œâ”€â”€ Azul primario: #1565C0 (unificado desde 4 variantes)       â”‚
â”‚   â”‚   â”œâ”€â”€ Body text: #333333, Muted: #666666, BG: #f8f9fa            â”‚
â”‚   â”‚   â”œâ”€â”€ Dividers: #E0E0E0, Disclaimer: #999999                     â”‚
â”‚   â”‚   â””â”€â”€ Headings: #1565C0                                           â”‚
â”‚   â””â”€â”€ Colores semanticos preservados:                                  â”‚
â”‚       â”œâ”€â”€ Error: #dc2626 (payment_failed, dunning_notice)             â”‚
â”‚       â”œâ”€â”€ Exito: #16a34a (subscription_created, orders)               â”‚
â”‚       â”œâ”€â”€ Warning: #f59e0b (trial_ending), #D97706 (fiscal)          â”‚
â”‚       â””â”€â”€ Andalucia EI: #FF8C42 (naranja), #00A9A5 (teal)           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            GESTIÃ“N DE SECRETOS: SECRET-MGMT-001 ğŸ”’                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Arquitectura de 3 capas para secretos:                                â”‚
â”‚                                                                         â”‚
â”‚   Capa 1: config/sync/ (Git â€” valores vacÃ­os)                          â”‚
â”‚   â”œâ”€â”€ social_auth_google.settings.yml: client_id='', client_secret='' â”‚
â”‚   â”œâ”€â”€ social_auth_linkedin.settings.yml: client_secret=''             â”‚
â”‚   â”œâ”€â”€ social_auth_microsoft.settings.yml: client_secret=''            â”‚
â”‚   â”œâ”€â”€ symfony_mailer.mailer_transport.smtp_ionos.yml: user/pass/host=''â”‚
â”‚   â””â”€â”€ recaptcha_v3.settings.yml: site_key='', secret_key=''          â”‚
â”‚                                                                         â”‚
â”‚   Capa 2: config/deploy/settings.secrets.php (Runtime overrides)       â”‚
â”‚   â”œâ”€â”€ 14 $config overrides desde getenv()                              â”‚
â”‚   â”œâ”€â”€ OAuth: Google (2), LinkedIn (2), Microsoft (2)                   â”‚
â”‚   â”œâ”€â”€ SMTP IONOS: user, pass, host                                    â”‚
â”‚   â”œâ”€â”€ reCAPTCHA v3: site_key, secret_key                              â”‚
â”‚   â”œâ”€â”€ Stripe: secret_key, webhook_secret, publishable_key             â”‚
â”‚   â””â”€â”€ Incluido en settings.php ANTES de settings.local.php            â”‚
â”‚                                                                         â”‚
â”‚   Capa 3: Variables de entorno                                          â”‚
â”‚   â”œâ”€â”€ Local: .env (gitignored) + Lando env_file injection             â”‚
â”‚   â”œâ”€â”€ ProducciÃ³n: panel hosting (IONOS, etc.)                          â”‚
â”‚   â””â”€â”€ .env.example: 12 variables documentadas                          â”‚
â”‚                                                                         â”‚
â”‚   Flujo config:import / config:export:                                  â”‚
â”‚   â”œâ”€â”€ import: YAML vacÃ­os â†’ BD vacÃ­a â†’ $config override en runtime    â”‚
â”‚   â”œâ”€â”€ export: BD vacÃ­a â†’ YAML vacÃ­os (overrides NO se exportan)       â”‚
â”‚   â””â”€â”€ Resultado: secretos NUNCA tocan git ni la BD                    â”‚
â”‚                                                                         â”‚
â”‚   Limpieza historial git:                                               â”‚
â”‚   â”œâ”€â”€ git-filter-repo --blob-callback (Python, no shell)              â”‚
â”‚   â”œâ”€â”€ 10 secretos eliminados de 459 commits                           â”‚
â”‚   â””â”€â”€ Force push + verificaciÃ³n 0 matches                              â”‚
â”‚                                                                         â”‚
â”‚   Regla: SECRET-MGMT-001 (P0)                                          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AUDITORIA IA CLASE MUNDIAL: 25 GAPS (7+16+2) ğŸ”            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Auditoria vs Salesforce Agentforce, HubSpot Breeze,                  â”‚
â”‚   Shopify Sidekick, Intercom Fin, Notion AI                            â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“Š Nivel actual: Backend 4.8/5, UX 4.2/5, Testing 3.5/5 (100/100) â”‚
â”‚   ğŸ¯ Nivel objetivo: ACHIEVED â€” 30/30 items completados               â”‚
â”‚                                                                         â”‚
â”‚   7 REFINAMIENTO (codigo existente):                                    â”‚
â”‚   â”œâ”€â”€ GAP-AUD-001: Onboarding Wizard + AI recommendations             â”‚
â”‚   â”‚   â””â”€â”€ TenantOnboardingWizardService (409 ln) + SmartBaseAgent     â”‚
â”‚   â”œâ”€â”€ GAP-AUD-002: Pricing AI Metering (token usage per plan)         â”‚
â”‚   â”‚   â””â”€â”€ PricingController (356 ln) + UsageDashboardController       â”‚
â”‚   â”œâ”€â”€ GAP-AUD-003: Demo/Playground publico (copilot embebido)         â”‚
â”‚   â”‚   â””â”€â”€ DemoController (246 ln) + PublicCopilotController (547 ln)  â”‚
â”‚   â”œâ”€â”€ GAP-AUD-004: AI Dashboard GEO (Chart.js visualizacion)          â”‚
â”‚   â”œâ”€â”€ GAP-AUD-005: llms.txt MCP Discovery (7 Gen 2 agents + tools)   â”‚
â”‚   â”‚   â””â”€â”€ LlmsTxtController (255 ln) + ToolRegistry integration      â”‚
â”‚   â”œâ”€â”€ GAP-AUD-006: Schema.org GEO (speakable, HowTo, FAQ)            â”‚
â”‚   â”‚   â””â”€â”€ SchemaGeneratorService (471 ln) + SchemaOrgService (529 ln) â”‚
â”‚   â””â”€â”€ GAP-AUD-007: Dark Mode AI Components (40 CSS variables)         â”‚
â”‚                                                                         â”‚
â”‚   16 TRUE GAPS NUEVOS:                                                  â”‚
â”‚   â”œâ”€â”€ GAP-AUD-008: Command Bar Cmd+K (Spotlight)                      â”‚
â”‚   â”‚   â””â”€â”€ CommandRegistryService + tagged jaraba.command_provider      â”‚
â”‚   â”œâ”€â”€ GAP-AUD-009: Inline AI (sparkle buttons en forms)               â”‚
â”‚   â”‚   â””â”€â”€ InlineAiService + PremiumEntityFormBase.getInlineAiFields() â”‚
â”‚   â”œâ”€â”€ GAP-AUD-010: Proactive Intelligence (entity + cron + bell)      â”‚
â”‚   â”‚   â””â”€â”€ ProactiveInsight ContentEntity + QueueWorker                â”‚
â”‚   â”œâ”€â”€ GAP-AUD-011: Voice AI (Web Speech API client-side)              â”‚
â”‚   â”œâ”€â”€ GAP-AUD-012: A2A Protocol (Agent Card + task lifecycle)         â”‚
â”‚   â”‚   â””â”€â”€ Extiende McpServerController JSON-RPC 2.0                  â”‚
â”‚   â”œâ”€â”€ GAP-AUD-013: Vision/Multimodal (GPT-4o) âœ… COMPLETE            â”‚
â”‚   â”‚   â””â”€â”€ MultiModalBridgeService: image+audio+speech+generation      â”‚
â”‚   â”œâ”€â”€ GAP-AUD-014: AI Test Coverage (40+ unit, 15+ kernel)           â”‚
â”‚   â”œâ”€â”€ GAP-AUD-015: Prompt Regression (golden fixtures)                â”‚
â”‚   â”‚   â””â”€â”€ PromptRegressionTestBase + 7 fixtures                      â”‚
â”‚   â”œâ”€â”€ GAP-AUD-016: Blog Slugs (ParamConverter, presave auto-slug)    â”‚
â”‚   â”œâ”€â”€ GAP-AUD-017: Content Hub tenant_id (TENANT-ISOLATION-ACCESS)   â”‚
â”‚   â”œâ”€â”€ GAP-AUD-018: Skill Inference (SkillInferenceService + LLM)     â”‚
â”‚   â”œâ”€â”€ GAP-AUD-019: Adaptive Learning (activar $aiAgent unused)       â”‚
â”‚   â”œâ”€â”€ GAP-AUD-020: Demand Forecasting (DemandForecastingService)     â”‚
â”‚   â”œâ”€â”€ GAP-AUD-021: AI Writing in GrapesJS (grapesjs-jaraba-ai.js)   â”‚
â”‚   â”œâ”€â”€ GAP-AUD-022: Service Matching (Qdrant real wiring)             â”‚
â”‚   â””â”€â”€ GAP-AUD-023: Design System Docs (ComponentDocController)       â”‚
â”‚                                                                         â”‚
â”‚   2 INFRAESTRUCTURA:                                                    â”‚
â”‚   â”œâ”€â”€ GAP-AUD-024: Cost Attribution (Observability â†’ Metering)        â”‚
â”‚   â””â”€â”€ GAP-AUD-025: Horizontal Scaling (Redis AI worker pool)         â”‚
â”‚                                                                         â”‚
â”‚   Plan: 4 sprints, 320-440h, 55+ tests                                â”‚
â”‚   Doc: Plan_Implementacion_Auditoria_IA_Clase_Mundial_v1.md           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              REVIEWS & COMMENTS CLASE MUNDIAL (10 VERTICALES) â­       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   AUDITORIA: 20 hallazgos (4 seguridad + 5 bugs + 4 arquitectura      â”‚
â”‚              + 3 directrices + 4 brechas clase mundial)                â”‚
â”‚                                                                         â”‚
â”‚   4 ENTIDADES EXISTENTES (heterogeneas):                               â”‚
â”‚   â”œâ”€â”€ comercio_review (ComercioConecta): 14 campos, tenantâ†’taxonomy   â”‚
â”‚   â”œâ”€â”€ review_agro (AgroConecta): 14 campos, tenantâ†’taxonomy, TYPE_*   â”‚
â”‚   â”œâ”€â”€ review_servicios (ServiciosConecta): 12 campos, SIN tenant_id   â”‚
â”‚   â””â”€â”€ session_review (Mentoring): 11 campos, SIN tenant_id            â”‚
â”‚                                                                         â”‚
â”‚   2 ENTIDADES NUEVAS PLANIFICADAS:                                     â”‚
â”‚   â”œâ”€â”€ course_review (LMS/Formacion): rating + completion_pct          â”‚
â”‚   â””â”€â”€ content_comment (Content Hub): threading parent_id + depth 3    â”‚
â”‚                                                                         â”‚
â”‚   TRAIT TRANSVERSAL: ReviewableEntityTrait                              â”‚
â”‚   â”œâ”€â”€ 5 campos compartidos: review_status, helpful_count, photos,     â”‚
â”‚   â”‚   ai_summary, ai_summary_generated_at                             â”‚
â”‚   â”œâ”€â”€ Helpers con fallback: getReviewStatusValue() (status/state),    â”‚
â”‚   â”‚   getAuthorId() (reviewer_uid/uid/mentee_id)                      â”‚
â”‚   â””â”€â”€ Se aplica a las 6 entidades para normalizar acceso              â”‚
â”‚                                                                         â”‚
â”‚   5 SERVICIOS TRANSVERSALES:                                           â”‚
â”‚   â”œâ”€â”€ ReviewModerationService: cola moderacion, auto-approve, bulk    â”‚
â”‚   â”œâ”€â”€ ReviewAggregationService: AggregateRating + cache + invalidate  â”‚
â”‚   â”œâ”€â”€ ReviewSchemaOrgService: JSON-LD AggregateRating + Review        â”‚
â”‚   â”œâ”€â”€ ReviewInvitationService: email post-transaccion, rate limit     â”‚
â”‚   â””â”€â”€ ReviewAiSummaryService: resumen IA por batch cron               â”‚
â”‚                                                                         â”‚
â”‚   FRONTEND:                                                             â”‚
â”‚   â”œâ”€â”€ _star-rating.html.twig: SVG stars con half-fill, WCAG aria     â”‚
â”‚   â”œâ”€â”€ _review-card.html.twig: card reutilizable con helpful/report   â”‚
â”‚   â”œâ”€â”€ _review-form.html.twig: slide-panel star widget interactivo    â”‚
â”‚   â”œâ”€â”€ _review-summary.html.twig: AggregateRating + distribution bar  â”‚
â”‚   â”œâ”€â”€ star-rating.js: 0.5 step, keyboard nav, CSRF submit            â”‚
â”‚   â”œâ”€â”€ SCSS: 350+ lineas BEM, dark mode, reduced-motion               â”‚
â”‚   â””â”€â”€ GrapesJS: review-block plugin (summary + form embed)           â”‚
â”‚                                                                         â”‚
â”‚   REMEDIACION SEGURIDAD:                                               â”‚
â”‚   â”œâ”€â”€ REV-S1/S2: tenant_id taxonomyâ†’group (entity_reference)         â”‚
â”‚   â”œâ”€â”€ REV-S3/S4: +tenant_id en ReviewServicios y SessionReview       â”‚
â”‚   â”œâ”€â”€ Access handlers: EntityHandlerInterface DI + isSameTenant()    â”‚
â”‚   â””â”€â”€ CSRF + API-WHITELIST-001 en todos los endpoints                â”‚
â”‚                                                                         â”‚
â”‚   SCHEMA.ORG: AggregateRating + Review JSON-LD (Rich Snippets)       â”‚
â”‚                                                                         â”‚
â”‚   Reglas: REVIEW-TRAIT-001, REVIEW-MODERATION-001,                    â”‚
â”‚           SCHEMA-AGGREGATE-001 (P0/P1)                                â”‚
â”‚   Docs:                                                                â”‚
â”‚   â”œâ”€â”€ Auditoria: Auditoria_Sistemas_Calificaciones_Comentarios_v1.md â”‚
â”‚   â””â”€â”€ Plan: Plan_Implementacion_Reviews_Comentarios_v1.md            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PREMIUM ENTITY FORMS: 237 FORMULARIOS â­          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (PremiumEntityFormBase)                    â”‚
â”‚   â”œâ”€â”€ Clase abstracta: PremiumEntityFormBase                           â”‚
â”‚   â”‚   â”œâ”€â”€ Extiende ContentEntityForm con glass-card UI               â”‚
â”‚   â”‚   â”œâ”€â”€ getSectionDefinitions(): Secciones con label, icon, fields â”‚
â”‚   â”‚   â”œâ”€â”€ getFormIcon(): Icono principal del formulario               â”‚
â”‚   â”‚   â”œâ”€â”€ Navigation pills + sticky action bar                       â”‚
â”‚   â”‚   â”œâ”€â”€ SCSS: _premium-forms.scss (glassmorphism, responsive)      â”‚
â”‚   â”‚   â””â”€â”€ JS: premium-form-navigation.js (scroll sync, pills)       â”‚
â”‚   â”‚                                                                     â”‚
â”‚   Migracion completa: 237 formularios en 50 modulos, 8 fases          â”‚
â”‚   â”œâ”€â”€ Patron A (Simple): Formularios sin DI ni campos computados     â”‚
â”‚   â”‚   â””â”€â”€ Solo requiere getSectionDefinitions() + getFormIcon()      â”‚
â”‚   â”œâ”€â”€ Patron B (Computed Fields): Campos auto-calculados              â”‚
â”‚   â”‚   â””â”€â”€ Usar #disabled = TRUE para campos no editables             â”‚
â”‚   â”œâ”€â”€ Patron C (DI): Formularios con inyeccion de dependencias       â”‚
â”‚   â”‚   â””â”€â”€ Patron parent::create() para preservar DI de la base      â”‚
â”‚   â”œâ”€â”€ Patron D (Custom Logic): Formularios con logica especial       â”‚
â”‚   â”‚   â””â”€â”€ Override de buildForm()/save() manteniendo secciones       â”‚
â”‚   â”‚                                                                     â”‚
â”‚   Distribucion por vertical:                                            â”‚
â”‚   â”œâ”€â”€ ecosistema_jaraba_core: ~30 forms (entidades base)             â”‚
â”‚   â”œâ”€â”€ jaraba_billing: ~15 forms (facturacion, suscripciones)         â”‚
â”‚   â”œâ”€â”€ jaraba_candidate: ~10 forms (perfil, educacion, experiencia)   â”‚
â”‚   â”œâ”€â”€ jaraba_crm: 5 forms (Company, Contact, Opportunity, etc.)     â”‚
â”‚   â”œâ”€â”€ jaraba_andalucia_ei: ~12 forms (expedientes, solicitudes)      â”‚
â”‚   â”œâ”€â”€ jaraba_page_builder: ~8 forms (paginas, templates)             â”‚
â”‚   â”œâ”€â”€ jaraba_customer_success: ~10 forms (health, churn, playbooks) â”‚
â”‚   â””â”€â”€ +43 modulos restantes con 1-8 forms cada uno                   â”‚
â”‚                                                                         â”‚
â”‚   Regla: PREMIUM-FORMS-PATTERN-001 (P1)                               â”‚
â”‚   â”œâ”€â”€ Extiende PremiumEntityFormBase (NUNCA ContentEntityForm)        â”‚
â”‚   â”œâ”€â”€ Fieldsets/details groups PROHIBIDOS (usar secciones)            â”‚
â”‚   â”œâ”€â”€ Iconos por categoria (ui, actions, fiscal, users, etc.)        â”‚
â”‚   â””â”€â”€ 0 ContentEntityForm restantes en modulos custom                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      WORKFLOW AUTOMATION ENGINE â­                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ jaraba_workflows (v1.0 â€” S4-04)                                   â”‚
â”‚   â”œâ”€â”€ Entidad: WorkflowRule (ContentEntity, trigger-based actions)     â”‚
â”‚   â”œâ”€â”€ Servicio: WorkflowExecutionService                               â”‚
â”‚   â”‚   â”œâ”€â”€ event_dispatcher para trigger events                        â”‚
â”‚   â”‚   â””â”€â”€ @?jaraba_ai_agents.observability (AI logging opcional)      â”‚
â”‚   â”œâ”€â”€ Form: WorkflowRuleForm                                          â”‚
â”‚   â”œâ”€â”€ Access: WorkflowRuleAccessControlHandler                        â”‚
â”‚   â”œâ”€â”€ ListBuilder: WorkflowRuleListBuilder                            â”‚
â”‚   â”œâ”€â”€ Config Schema: jaraba_workflows.schema.yml                      â”‚
â”‚   â””â”€â”€ Test: WorkflowExecutionServiceTest (Unit)                       â”‚
â”‚                                                                         â”‚
â”‚   Dependencias: ecosistema_jaraba_core                                 â”‚
â”‚   15 ficheros total                                                    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DEMO VERTICAL PLG (Product-Led Growth) â­                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“¦ ecosistema_jaraba_core (Demo subsystem, ~4,000 LOC)               â”‚
â”‚                                                                         â”‚
â”‚   User Journey:                                                         â”‚
â”‚   /demo â†’ /demo/start/{profileId} â†’ /demo/dashboard/{sessionId}       â”‚
â”‚     â”œâ”€â”€ Guided Tour (4 pasos, auto-start)                              â”‚
â”‚     â”œâ”€â”€ Magic Actions â†’ /demo/ai/storytelling/{sessionId}              â”‚
â”‚     â”œâ”€â”€ AI Playground â†’ /demo/ai-playground                            â”‚
â”‚     â””â”€â”€ Progressive Disclosure â†’ /demo/dashboard/{sessionId}           â”‚
â”‚         â””â”€â”€ Conversion Modal â†’ /registro/{vertical}                    â”‚
â”‚                                                                         â”‚
â”‚   Controller: DemoController (~765 LOC)                                 â”‚
â”‚   â”œâ”€â”€ demoLanding() â€” 10 perfiles demo con social proof               â”‚
â”‚   â”œâ”€â”€ startDemo() â€” sesion DB + guided tour + dashboard inicial       â”‚
â”‚   â”œâ”€â”€ demoDashboard() â€” progressive disclosure + nudges               â”‚
â”‚   â”œâ”€â”€ demoAiStorytelling() â€” AI storytelling con StorytellingAgent    â”‚
â”‚   â”œâ”€â”€ aiPlayground() â€” copilot publico embebido                       â”‚
â”‚   â”œâ”€â”€ regenerateStory() â€” POST API regeneracion con feature gate      â”‚
â”‚   â”œâ”€â”€ trackAction() â€” POST API tracking + TTFV                        â”‚
â”‚   â””â”€â”€ convertToReal() â€” POST API conversion flow                     â”‚
â”‚                                                                         â”‚
â”‚   Services:                                                             â”‚
â”‚   â”œâ”€â”€ DemoInteractiveService (1,523 LOC)                               â”‚
â”‚   â”‚   â”œâ”€â”€ 10 perfiles demo (producer, winery, cheese, buyer...)       â”‚
â”‚   â”‚   â”œâ”€â”€ Metricas sinteticas por vertical                            â”‚
â”‚   â”‚   â”œâ”€â”€ Session management (demo_sessions table, SHA-256 IP)        â”‚
â”‚   â”‚   â”œâ”€â”€ Analytics aggregation (demo_analytics table, cron)          â”‚
â”‚   â”‚   â””â”€â”€ getDemoStory() â€” 11 historias hardcoded por perfil          â”‚
â”‚   â”œâ”€â”€ DemoFeatureGateService (149 LOC)                                 â”‚
â”‚   â”‚   â”œâ”€â”€ Features: page_builder_templates, story_generations         â”‚
â”‚   â”‚   â””â”€â”€ Usage tracking por session                                  â”‚
â”‚   â”œâ”€â”€ DemoJourneyProgressionService (319 LOC)                          â”‚
â”‚   â”‚   â”œâ”€â”€ Disclosure levels: basic â†’ intermediate â†’ advanced          â”‚
â”‚   â”‚   â””â”€â”€ Nudge system (action-based progression)                     â”‚
â”‚   â””â”€â”€ GuidedTourService (user_completed_tours table)                   â”‚
â”‚       â”œâ”€â”€ Tour definitions (demo_welcome: 4 steps)                    â”‚
â”‚       â””â”€â”€ getTourDriverJS() â†’ JSON config para JS driver              â”‚
â”‚                                                                         â”‚
â”‚   JS Libraries (self-contained, zero external deps):                    â”‚
â”‚   â”œâ”€â”€ demo-dashboard.js â€” chart, tracking, conversion, countdown      â”‚
â”‚   â”œâ”€â”€ demo-guided-tour.js â€” overlay, spotlight, popovers, keyboard   â”‚
â”‚   â”œâ”€â”€ demo-storytelling.js â€” regenerate fetch, copy, feedback         â”‚
â”‚   â””â”€â”€ demo-ai-playground.js â€” copilot chat, scenarios, typing        â”‚
â”‚                                                                         â”‚
â”‚   Templates (5 themes + 3 partials):                                    â”‚
â”‚   â”œâ”€â”€ demo-landing.html.twig (profile cards)                          â”‚
â”‚   â”œâ”€â”€ demo-dashboard.html.twig (initial, with tour steps)             â”‚
â”‚   â”œâ”€â”€ demo-dashboard-view.html.twig (progressive disclosure)          â”‚
â”‚   â”œâ”€â”€ demo-ai-storytelling.html.twig (story + regenerate)             â”‚
â”‚   â”œâ”€â”€ demo-ai-playground.html.twig (chat + scenarios)                 â”‚
â”‚   â””â”€â”€ partials: _demo-chart, _demo-cta, _demo-convert-modal          â”‚
â”‚                                                                         â”‚
â”‚   DB Tables: demo_sessions, demo_analytics, user_completed_tours       â”‚
â”‚   Tests: 24 unit tests, 84 assertions                                  â”‚
â”‚   SCSS: _demo.scss (1,180 LOC) in ecosistema_jaraba_core              â”‚
â”‚                                                                         â”‚
â”‚   drupalSettings injection chain:                                       â”‚
â”‚   â”œâ”€â”€ demo.sessionId, demo.salesHistory (dashboard)                   â”‚
â”‚   â”œâ”€â”€ demoTour (from GuidedTourService::getTourDriverJS)              â”‚
â”‚   â”œâ”€â”€ demoStorytelling.regenerateUrl (Url::fromRoute)                 â”‚
â”‚   â””â”€â”€ demoPlayground.copilotEndpoint (Url::fromRoute)                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### 7.2 Interactive Content AI-Powered (jaraba_interactive)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INTERACTIVE CONTENT SYSTEM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Plugin Architecture (@InteractiveType)                                â”‚
â”‚   â”œâ”€â”€ InteractiveTypeManager (discovery + sorting)                     â”‚
â”‚   â”œâ”€â”€ InteractiveTypeBase (abstract: calculatePercentage, validate)    â”‚
â”‚   â””â”€â”€ InteractiveTypeInterface (contract: 8 methods)                   â”‚
â”‚       â”œâ”€â”€ QuestionSet (assessment, weight:0)                           â”‚
â”‚       â”œâ”€â”€ InteractiveVideo (media, weight:10)                          â”‚
â”‚       â”œâ”€â”€ CoursePresentation (interactive, weight:20)                  â”‚
â”‚       â”œâ”€â”€ BranchingScenario (interactive, weight:30)                   â”‚
â”‚       â”œâ”€â”€ DragAndDrop (assessment, weight:40)                          â”‚
â”‚       â””â”€â”€ Essay (assessment, weight:50)                                â”‚
â”‚                                                                         â”‚
â”‚   Services                                                              â”‚
â”‚   â”œâ”€â”€ Scorer (delegates to plugin calculateScore)                      â”‚
â”‚   â”œâ”€â”€ XApiEmitter (xAPI statements per type)                           â”‚
â”‚   â””â”€â”€ ContentGenerator (AI-powered content creation)                   â”‚
â”‚                                                                         â”‚
â”‚   EventSubscribers                                                      â”‚
â”‚   â”œâ”€â”€ CompletionSubscriber (XP + certifications, priority:100)         â”‚
â”‚   â””â”€â”€ XapiSubscriber (xAPI emission per type)                          â”‚
â”‚                                                                         â”‚
â”‚   Editor System                                                         â”‚
â”‚   â”œâ”€â”€ EditorController (zero-region frontend)                          â”‚
â”‚   â”œâ”€â”€ content-editor.js (orchestrator)                                 â”‚
â”‚   â”œâ”€â”€ preview-engine.js (iframe preview)                               â”‚
â”‚   â””â”€â”€ 6 type-specific editors (JS)                                     â”‚
â”‚                                                                         â”‚
â”‚   CRUD API (/api/v1/interactive/content)                               â”‚
â”‚   â”œâ”€â”€ POST / (create)                                                  â”‚
â”‚   â”œâ”€â”€ GET / (list + filter)                                            â”‚
â”‚   â”œâ”€â”€ PUT /{id} (update)                                               â”‚
â”‚   â”œâ”€â”€ PATCH /{id}/status (publish/archive)                             â”‚
â”‚   â”œâ”€â”€ DELETE /{id} (soft delete)                                       â”‚
â”‚   â””â”€â”€ POST /{id}/duplicate (clone)                                     â”‚
â”‚                                                                         â”‚
â”‚   Tests: 9 PHPUnit files, 100+ test methods                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 Tenant Marca Personal (pepejaraba.com)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PEPEJARABA.COM TENANT                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Seed Script: scripts/seed_pepejaraba.php (766 LOC)                   â”‚
â”‚   â”œâ”€â”€ Vertical: Marca Personal                                         â”‚
â”‚   â”œâ”€â”€ SaasPlan: Personal Brand Premium                                 â”‚
â”‚   â”œâ”€â”€ Tenant: Pepe Jaraba - Marca Personal                            â”‚
â”‚   â”œâ”€â”€ Domain: pepejaraba.com                                           â”‚
â”‚   â””â”€â”€ Theme: #FF8C42 (orange) + #00A9A5 (teal)                       â”‚
â”‚                                                                         â”‚
â”‚   7 PageContent Pages (multiblock mode)                                â”‚
â”‚   â”œâ”€â”€ Homepage (/) â€” 7 sections                                        â”‚
â”‚   â”œâ”€â”€ Sobre MÃ­ (/sobre) â€” 3 sections                                  â”‚
â”‚   â”œâ”€â”€ Servicios (/servicios) â€” 2 sections (pricing table)             â”‚
â”‚   â”œâ”€â”€ Ecosistema (/ecosistema) â€” 2 sections (bento grid)              â”‚
â”‚   â”œâ”€â”€ Blog (/blog) â€” 2 sections                                       â”‚
â”‚   â”œâ”€â”€ Recursos (/recursos) â€” 2 sections                               â”‚
â”‚   â””â”€â”€ Contacto (/contacto) â€” 3 sections                               â”‚
â”‚                                                                         â”‚
â”‚   Navigation: SiteMenu (main) + 6 SiteMenuItems                       â”‚
â”‚   Config: domain.record + design_token_config YAMLs                    â”‚
â”‚   Infra: Nginx vhost + SSL Let's Encrypt + trusted_host_patterns      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 Arquitectura de Theming (Federated Design Tokens)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THEMING ARCHITECTURE                                  â”‚
â”‚                 Federated Design Tokens v2.1                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   SINGLE SOURCE OF TRUTH (SSOT)                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  ğŸ“¦ ecosistema_jaraba_core                                       â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ scss/_variables.scss    â†’ $ej-* (compile-time tokens)      â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ scss/_injectable.scss   â†’ var(--ej-*) (runtime tokens)     â”‚  â”‚
â”‚   â”‚  â””â”€â”€ 33 parciales SCSS       â†’ 7 dashboards, componentes        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    MÃ“DULOS SATÃ‰LITE                              â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚   â”‚  â”‚ page_builder â”‚ â”‚ interactive  â”‚ â”‚ credentials  â”‚             â”‚  â”‚
â”‚   â”‚  â”‚ 7 SCSS       â”‚ â”‚ 2 SCSS       â”‚ â”‚ 4 SCSS       â”‚             â”‚  â”‚
â”‚   â”‚  â”‚ package.json â”‚ â”‚ package.json â”‚ â”‚ package.json â”‚             â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚   â”‚  Solo consumen: var(--ej-*, $fallback)                          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    TEMA DRUPAL                                   â”‚  â”‚
â”‚   â”‚  ğŸ“¦ ecosistema_jaraba_theme                                      â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ 45 archivos SCSS      â†’ components, features               â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ SDC Components (2)    â†’ Card, Hero                         â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ Zero-Region Templates â†’ page--empleabilidad, --emprendimientoâ”‚ â”‚
â”‚   â”‚  â”œâ”€â”€ Preprocess hooks      â†’ empleabilidad + emprendimiento      â”‚  â”‚
â”‚   â”‚  â””â”€â”€ InyecciÃ³n runtime     â†’ hook_page_attachments              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   MÃ‰TRICAS CONSOLIDACIÃ“N (Feb 2026):                                    â”‚
â”‚   âœ… 102 archivos SCSS documentados                                     â”‚
â”‚   âœ… 14 mÃ³dulos con package.json estandarizado                          â”‚
â”‚   âœ… 0 funciones darken()/lighten() deprecadas                          â”‚
â”‚   âœ… 100% mÃ³dulos satÃ©lite usando var(--ej-*)                           â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“š DOCUMENTO DETALLADO:                                               â”‚
â”‚   docs/arquitectura/2026-02-05_arquitectura_theming_saas_master.md      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Inteligencia Artificial

### 8.1 Sistema de Agentes IA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AGENTES DE IA                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚   AGENT ORCHESTRATOR    â”‚                          â”‚
â”‚                    â”‚   (Coordinador Central) â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                â”‚                                        â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚        â–¼                       â–¼                       â–¼                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ ğŸ“          â”‚       â”‚ ğŸ“£          â”‚       â”‚ ğŸ’¬          â”‚          â”‚
â”‚   â”‚ Storytellingâ”‚       â”‚ Marketing   â”‚       â”‚ Customer    â”‚          â”‚
â”‚   â”‚ Agent       â”‚       â”‚ Agent       â”‚       â”‚ Experience  â”‚          â”‚
â”‚   â”‚             â”‚       â”‚             â”‚       â”‚ Agent       â”‚          â”‚
â”‚   â”‚ â€¢ BiografÃ­asâ”‚       â”‚ â€¢ CampaÃ±as  â”‚       â”‚ â€¢ Upselling â”‚          â”‚
â”‚   â”‚ â€¢ Historias â”‚       â”‚ â€¢ Posts     â”‚       â”‚ â€¢ Reminder  â”‚          â”‚
â”‚   â”‚ â€¢ Descrip.  â”‚       â”‚ â€¢ Email     â”‚       â”‚ â€¢ Support   â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â”‚   AI SKILLS VERTICALES (30 predefinidas):                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  empleabilidad (7): cv_optimization, interview_preparation...  â”‚  â”‚
â”‚   â”‚  emprendimiento (7): canvas_coaching, pitch_deck_review...     â”‚  â”‚
â”‚   â”‚  agroconecta (6): product_listing_agro, seasonal_marketing...  â”‚  â”‚
â”‚   â”‚  comercioconecta (5): flash_offer_design, local_seo_content... â”‚  â”‚
â”‚   â”‚  serviciosconecta (5): case_summarization, client_comms...     â”‚  â”‚
â”‚   â”‚  Seed: scripts/seed_vertical_skills.php (1,647 LOC)           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   COPILOT EMPLEABILIDAD (6 modos):                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  EmployabilityCopilotAgent (extiende BaseAgent)                 â”‚  â”‚
â”‚   â”‚  profile_coach: OptimizaciÃ³n LinkedIn + personal branding       â”‚  â”‚
â”‚   â”‚  job_advisor: Estrategia bÃºsqueda + matching personalizado      â”‚  â”‚
â”‚   â”‚  interview_prep: SimulaciÃ³n entrevistas + feedback              â”‚  â”‚
â”‚   â”‚  learning_guide: Ruta formativa + skills gap analysis           â”‚  â”‚
â”‚   â”‚  application_helper: Cover letter + follow-up templates         â”‚  â”‚
â”‚   â”‚  faq: Preguntas frecuentes empleo EspaÃ±a                        â”‚  â”‚
â”‚   â”‚  DI: @ai.provider + @tenant_brand_voice + @observability        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   COPILOT JARABALEX (6 modos):                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  LegalCopilotAgent (extiende BaseAgent)                         â”‚  â”‚
â”‚   â”‚  legal_search: BÃºsqueda guiada jurisprudencia + normativa       â”‚  â”‚
â”‚   â”‚  legal_analysis: AnÃ¡lisis resoluciones + lÃ­neas jurisprudencialesâ”‚  â”‚
â”‚   â”‚  legal_alerts: ConfiguraciÃ³n alertas inteligentes               â”‚  â”‚
â”‚   â”‚  legal_citations: InserciÃ³n citas en expedientes (4 formatos)   â”‚  â”‚
â”‚   â”‚  legal_eu: Derecho europeo EUR-Lex/CURIA/HUDOC/EDPB            â”‚  â”‚
â”‚   â”‚  faq: Preguntas frecuentes JarabaLex                            â”‚  â”‚
â”‚   â”‚  DI: @ai.provider + @tenant_brand_voice + @observability        â”‚  â”‚
â”‚   â”‚  Regla: LEGAL-RAG-001 (disclaimer + citas verificables)         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   PROVEEDORES IA SOPORTADOS:                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚   â”‚   OpenAI    â”‚  â”‚  Anthropic  â”‚  â”‚  Google AI  â”‚                    â”‚
â”‚   â”‚   GPT-4     â”‚  â”‚   Claude    â”‚  â”‚   Gemini    â”‚                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Knowledge Base RAG

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KNOWLEDGE BASE RAG                                    â”‚
â”‚           (Retrieval-Augmented Generation)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    FLUJO DE INDEXACIÃ“N                           â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚   Producto     â”€â”€â–¶   Chunking    â”€â”€â–¶   Embeddings   â”€â”€â–¶  Qdrant â”‚  â”‚
â”‚   â”‚   Guardado          (500 tokens)      (OpenAI 1536D)     Vector â”‚  â”‚
â”‚   â”‚                                                             DB   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    FLUJO DE BÃšSQUEDA                             â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚   "Â¿QuÃ© aceite     â”€â”€â–¶   Embedding   â”€â”€â–¶   Qdrant    â”€â”€â–¶  Top 5 â”‚  â”‚
â”‚   â”‚    recomendÃ¡is?"         Query           Search         Results â”‚  â”‚
â”‚   â”‚                                              â”‚                   â”‚  â”‚
â”‚   â”‚                                              â–¼                   â”‚  â”‚
â”‚   â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚   â”‚                                      â”‚  LLM + RAG  â”‚             â”‚  â”‚
â”‚   â”‚                                      â”‚  Respuesta  â”‚             â”‚  â”‚
â”‚   â”‚                                      â”‚  Contextual â”‚             â”‚  â”‚
â”‚   â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   ARQUITECTURA DUAL:                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚ ğŸ³ Lando (Desarrollo)  â”‚    â”‚ â˜ï¸ IONOS (ProducciÃ³n)   â”‚             â”‚
â”‚   â”‚ http://qdrant:6333     â”‚    â”‚ https://qdrant.cloud    â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                         â”‚
â”‚   FAQ BOT CONTEXTUAL (G114-4):                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   Cliente      â”€â”€â–¶   Embedding   â”€â”€â–¶   Qdrant    â”€â”€â–¶  Scoring  â”‚  â”‚
â”‚   â”‚   /ayuda chat        Query           Search         3-tier     â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚   â‰¥0.75 â”€â”€â–¶ LLM Grounded (Haiku, max_tokens=512, temp=0.3)     â”‚  â”‚
â”‚   â”‚   0.55-0.75 â”€â”€â–¶ Baja confianza + sugerir contacto              â”‚  â”‚
â”‚   â”‚   <0.55 â”€â”€â–¶ EscalaciÃ³n con datos de contacto del negocio       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 Centro de Ayuda Clase Mundial (/ayuda)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CENTRO DE AYUDA CLASE MUNDIAL                        â”‚
â”‚                        /ayuda â€” PÃºblico                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   MÃ“DULO: jaraba_tenant_knowledge                                       â”‚
â”‚   CONTROLLER: HelpCenterController (index, viewArticle, searchApi)      â”‚
â”‚   TEMPLATE: help-center.html.twig + help-article.html.twig             â”‚
â”‚                                                                         â”‚
â”‚   8 CATEGORÃAS SaaS:                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚ getting_     â”‚ account        â”‚ features     â”‚ billing      â”‚       â”‚
â”‚   â”‚ started      â”‚ (user)         â”‚ (zap)        â”‚ (credit-card)â”‚       â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚   â”‚ ai_copilot   â”‚ integrations   â”‚ security     â”‚ trouble-     â”‚       â”‚
â”‚   â”‚ (cpu)        â”‚ (link)         â”‚ (shield)     â”‚ shooting     â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€(tool)â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                         â”‚
â”‚   ARQUITECTURA:                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Hero (search + trust signals + article count)                   â”‚   â”‚
â”‚   â”‚  Quick Links â†’ /soporte/crear, /contacto, /ayuda/kb, /blog      â”‚   â”‚
â”‚   â”‚  CategorÃ­as Grid (8 cards, ordered by getCategoryMeta())         â”‚   â”‚
â”‚   â”‚  ArtÃ­culos Populares (top 6 FAQs)                                â”‚   â”‚
â”‚   â”‚  KB Cross-link (si kb_articles_count > 0)                        â”‚   â”‚
â”‚   â”‚  FAQs por CategorÃ­a (expandible, link a artÃ­culo individual)     â”‚   â”‚
â”‚   â”‚  CTA Contacto (botones /contacto + /soporte)                     â”‚   â”‚
â”‚   â”‚  FAQ Bot Widget (G114-4, faq-bot-widget.html.twig)               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚   BÃšSQUEDA UNIFICADA:                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  searchApi() â†’ TenantFaq LIKE + KbArticle LIKE (hasDefinition)  â”‚   â”‚
â”‚   â”‚  JS: drupalSettings.helpCenter.searchApiUrl (LANGPREFIX-001)    â”‚   â”‚
â”‚   â”‚  Autocomplete: FAQ items + KB items (type badge)                 â”‚   â”‚
â”‚   â”‚  URLs: Url::fromRoute() â€” never hardcoded                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚   SEO:                                                                  â”‚
â”‚   - FAQPage JSON-LD (todas las FAQs visibles)                          â”‚
â”‚   - BreadcrumbList JSON-LD (Home > Centro de Ayuda)                    â”‚
â”‚   - QAPage JSON-LD (artÃ­culo individual)                               â”‚
â”‚   - OG + Twitter meta tags                                              â”‚
â”‚   - Canonical URL                                                       â”‚
â”‚                                                                         â”‚
â”‚   SEED DATA:                                                            â”‚
â”‚   - update_10003: 25 FAQs plataforma (tenant_id = NULL)                â”‚
â”‚   - MigraciÃ³n categorÃ­as e-commerce â†’ SaaS                             â”‚
â”‚   - Idempotente: notExists('tenant_id') + condition('question')         â”‚
â”‚                                                                         â”‚
â”‚   INTEGRACIÃ“N:                                                          â”‚
â”‚   - jaraba_support: Quick Links â†’ /soporte/crear                       â”‚
â”‚   - Knowledge Base: Cross-link + bÃºsqueda unificada                    â”‚
â”‚   - FAQ Bot: Widget incluido via Twig include                          â”‚
â”‚   - Footer: "Centro de Ayuda|/ayuda" en col2_links                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Seguridad y Cumplimiento

### 9.1 Capas de Seguridad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SEGURIDAD MULTINIVEL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   CAPA 1: INFRAESTRUCTURA                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ HTTPS obligatorio (Let's Encrypt)                             â”‚  â”‚
â”‚   â”‚  â€¢ Firewall + Rate Limiting                                      â”‚  â”‚
â”‚   â”‚  â€¢ Backups automÃ¡ticos cada 4h                                   â”‚  â”‚
â”‚   â”‚  â€¢ Cifrado at-rest y in-transit                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   CAPA 2: APLICACIÃ“N                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Drupal Security Updates automÃ¡ticos                           â”‚  â”‚
â”‚   â”‚  â€¢ CSRF Protection                                               â”‚  â”‚
â”‚   â”‚  â€¢ XSS Prevention (Twig autoescape)                              â”‚  â”‚
â”‚   â”‚  â€¢ SQL Injection Prevention (DB API)                             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   CAPA 3: DATOS                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Aislamiento por Group Module                                  â”‚  â”‚
â”‚   â”‚  â€¢ API Keys en Key Module (config sync git-tracked)               â”‚  â”‚
â”‚   â”‚  â€¢ Config Sync: config/sync/ (589 YML, git-tracked)              â”‚  â”‚
â”‚   â”‚  â€¢ Logs sanitizados (sin datos sensibles)                        â”‚  â”‚
â”‚   â”‚  â€¢ AuditLog inmutable (eventos seguridad con IP, actor, tenant)  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   CAPA 4: COMPLIANCE (G115-1)                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Dashboard /admin/seguridad (25+ controles)                    â”‚  â”‚
â”‚   â”‚  â€¢ SOC 2 Type II + ISO 27001:2022 + ENS RD 311/2022 + GDPR      â”‚  â”‚
â”‚   â”‚  â€¢ VerificaciÃ³n security headers en tiempo real                  â”‚  â”‚
â”‚   â”‚  â€¢ Auto-refresh cada 30 segundos                                 â”‚  â”‚
â”‚   â”‚  â€¢ GDPR Drush: gdpr:export (Art.15), gdpr:anonymize (Art.17)    â”‚  â”‚
â”‚   â”‚  â€¢ Security CI: Daily Trivy + ZAP + SARIF (GitHub Security)      â”‚  â”‚
â”‚   â”‚  â€¢ Incident Response Playbook: SEV1-4, AEPD 72h                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Hallazgos de AuditorÃ­a de Seguridad (2026-02-06)

> **Referencia:** [AuditorÃ­a Profunda SaaS Multidimensional v1](./tecnicos/auditorias/20260206-Auditoria_Profunda_SaaS_Multidimensional_v1_Claude.md)

La auditorÃ­a profunda multidimensional del 2026-02-06 identificÃ³ **9 hallazgos de seguridad** (5 crÃ­ticos + 4 altos):

| ID | Severidad | Hallazgo | Estado |
|----|-----------|----------|--------|
| SEC-01 | CRITICA | InyecciÃ³n de prompts vÃ­a configuraciÃ³n de tenant | Pendiente |
| SEC-02 | CRITICA | Webhook pÃºblico sin verificaciÃ³n de firma HMAC | Pendiente |
| SEC-03 | CRITICA | Claves Stripe en config DB en vez de env vars | Pendiente |
| SEC-04 | CRITICA | Qdrant sin autenticaciÃ³n por API key | Pendiente |
| SEC-05 | CRITICA | APIs pÃºblicas `/api/v1/*` sin autenticaciÃ³n | Pendiente |
| SEC-06 | ALTA | Rutas demo sin restricciÃ³n de tipo en parÃ¡metros | Pendiente |
| SEC-07 | ALTA | Mensajes de error internos expuestos al usuario | Pendiente |
| SEC-08 | ALTA | Sin configuraciÃ³n CORS ni CSP headers | Pendiente |
| SEC-09 | ALTA | Re-index sin verificaciÃ³n de tenant ownership | Pendiente |

**Nuevas directrices derivadas:**
- Toda clave API debe almacenarse en variables de entorno, nunca en configuraciÃ³n de Drupal
- Todo endpoint que invoque LLM/embedding debe tener rate limiting por tenant y usuario
- Toda interpolaciÃ³n en prompts del sistema debe sanitizarse contra whitelist
- Filtros Qdrant para tenant deben usar `must` (AND), nunca `should` (OR)

### 9.3 Cumplimiento GDPR

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CUMPLIMIENTO GDPR                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   DERECHOS ARCO-POL IMPLEMENTADOS:                                      â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Derecho      â”‚ ImplementaciÃ³n                                   â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ Acceso       â”‚ ExportaciÃ³n de datos en JSON/CSV                 â”‚  â”‚
â”‚   â”‚ RectificaciÃ³nâ”‚ EdiciÃ³n de perfil por usuario                    â”‚  â”‚
â”‚   â”‚ CancelaciÃ³n  â”‚ AnonimizaciÃ³n automÃ¡tica                         â”‚  â”‚
â”‚   â”‚ OposiciÃ³n    â”‚ Opt-out de comunicaciones                        â”‚  â”‚
â”‚   â”‚ Portabilidad â”‚ Descarga de datos en formato estÃ¡ndar            â”‚  â”‚
â”‚   â”‚ Olvido       â”‚ EliminaciÃ³n completa tras 30 dÃ­as                â”‚  â”‚
â”‚   â”‚ LimitaciÃ³n   â”‚ SuspensiÃ³n de procesamiento                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   RETENCIÃ“N DE DATOS:                                                   â”‚
â”‚   â€¢ Datos de usuario: Hasta baja + 30 dÃ­as                              â”‚
â”‚   â€¢ Logs de acceso: 90 dÃ­as                                             â”‚
â”‚   â€¢ Backups: 30 dÃ­as                                                    â”‚
â”‚   â€¢ Datos fiscales: 7 aÃ±os (requisito legal)                            â”‚
â”‚                                                                         â”‚
â”‚   HERRAMIENTAS GDPR AUTOMATIZADAS:                                     â”‚
â”‚   â€¢ drush gdpr:export {uid}     â†’ Art. 15 Acceso (JSON)                â”‚
â”‚   â€¢ drush gdpr:anonymize {uid}  â†’ Art. 17 Olvido (hash replacement)    â”‚
â”‚   â€¢ drush gdpr:report           â†’ Informe compliance general           â”‚
â”‚   â€¢ /tenant/export (self-service) â†’ Art. 20 Portabilidad (ZIP)         â”‚
â”‚   â”‚   jaraba_tenant_export: 6 secciones datos, async Queue API,        â”‚
â”‚   â”‚   descarga ZIP con manifest JSON + CSV + archivos originales       â”‚
â”‚   â€¢ Playbook: SECURITY_INCIDENT_RESPONSE_PLAYBOOK.md                   â”‚
â”‚   â€¢ AEPD notificaciÃ³n: 72h (GDPR Art. 33)                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 Cumplimiento Fiscal â€” Stack VeriFactu + Facturae + E-Factura

> **Estado:** FASES 0-11 COMPLETADAS. 3 modulos implementados + integration layer.
> **Prioridad:** P0 CRITICO â€” Deadline legal 1 enero 2027 (sociedades) / 1 julio 2027 (autonomos).
> **Sancion:** Hasta 50.000 EUR/ejercicio por software no conforme (RD 1007/2023).

**Impacto dual:** Jaraba Impact S.L. como emisor de facturas SaaS a tenants + tenants como emisores a sus clientes finales.

| Modulo | Normativa | Estado | Entidades | Servicios | API Endpoints | Tests |
|--------|-----------|--------|-----------|-----------|---------------|-------|
| **`jaraba_verifactu`** | RD 1007/2023, Orden HAC/1177/2024 | IMPLEMENTADO (F0-F5) | 4 | 7 | 21 | 23 |
| **`jaraba_facturae`** | Ley 25/2013, Facturae 3.2.2 | IMPLEMENTADO (F6-F7) | 3 | 6 | 21 | 26 |
| **`jaraba_einvoice_b2b`** | Ley 18/2022 (Crea y Crece) | IMPLEMENTADO (F8-F9) | 4 | 6 | 24 | 23 |
| **Integration Layer** | Transversal (F10-F11) | IMPLEMENTADO | â€” | 3 | â€” | 38 |
| **TOTAL** | | **12 FASES** | **11** | **22** | **66** | **110** |

**FASE 11 â€” Integration Layer (completada 2026-02-16):**
- `FiscalComplianceService`: Score 0-100 por tenant, 5 factores x 20 pts (VeriFactu chain, AEAT remision, certificados, FACe rechazos, B2B morosidad)
- `FiscalDashboardController`: Ruta `/admin/jaraba/fiscal`, dashboard unificado
- `FiscalInvoiceDelegationService`: Deteccion automatica B2G/B2B/nacional por NIF prefix (Q/S/P = B2G)
- KPI card en Admin Center + slide-panel trigger
- 3 MJML email alerts (certificate_expiring, verifactu_chain_break, face_invoice_rejected)
- 9 features en FeatureAccessService FEATURE_ADDON_MAP
- Design token config YAML (17 color tokens fiscales)
- 38 tests (unit + kernel + functional)

**Arquitectura integrada:** Un invoice puede tener simultaneamente un VeriFactu record (obligatorio para todos) + un Facturae document (B2G) + un E-Invoice document (B2B). Los tres modulos comparten CertificateManagerService (PKCS#12) y se integran con `jaraba_billing` (BillingInvoice como fuente).

### 9.5 Stack Compliance Legal N1 â€” Privacidad, Legal, DR

> **Estado:** IMPLEMENTADO (3 modulos, 198 archivos, +13,281 LOC).
> **Nivel N1 Foundation:** GDPR DPA + Legal Terms SaaS + Disaster Recovery.
> **Auditoria N1:** 12.5% (pre) â†’ 95%+ (post-implementacion).

| Modulo | Alcance | Entidades | Servicios | Templates | Tests |
|--------|---------|-----------|-----------|-----------|-------|
| **`jaraba_privacy`** | GDPR DPA + LOPD-GDD, consentimiento cookies, DSAR, breaches | 5 (DpaAgreement, PrivacyPolicy, CookieConsent, ProcessingActivity, DataRightsRequest) | 5 (DpaManager, CookieConsentManager, DataRightsHandler, BreachNotification, PrivacyPolicyGenerator) | privacy-dashboard + 5 partials + cookie-banner | 4 unit |
| **`jaraba_legal`** | ToS/SLA/AUP versioning, offboarding, whistleblower | 6 (ServiceAgreement, SlaRecord, UsageLimitRecord, AupViolation, OffboardingRequest, WhistleblowerReport) | 5 (TosManager, SlaCalculator, AupEnforcer, OffboardingManager, WhistleblowerChannel) + LegalApiController (12 endpoints) | legal-dashboard + 5 partials + whistleblower-form | 4 unit |
| **`jaraba_dr`** | Backup verification, failover testing, incident management | 3 (BackupVerification, DrIncident, DrTestResult) | 5 (BackupVerifier, DrTestRunner, FailoverOrchestrator, IncidentCommunicator, StatusPageManager) | dr-dashboard + dr-status-page + 4 partials | 4 unit |

**Gap-filling completado (commit e16d3e28):** Servicios con logica de produccion completa (+16,035 LOC):
- `jaraba_dr`: 5 servicios con logica real (verificacion backups, ejecucion DR tests, failover orquestacion, comunicacion incidentes, gestion status page)
- `jaraba_legal`: 5 servicios con logica real + LegalApiController (12 REST endpoints: ToS 3, SLA 2, AUP 2, Offboarding 3, Whistleblower 2 publicos)
- `jaraba_privacy`: JS behaviors (cookie-banner, dpa-signature, privacy-dashboard) + 8 SCSS partials + 4 unit tests

**ComplianceAggregatorService** (ecosistema_jaraba_core):
- Servicio transversal que agrega KPIs de los 3 modulos compliance en un dashboard unificado
- 9 KPIs (3 por modulo): dpa_coverage, arco_pol_sla, cookie_consent_rate, tos_acceptance_rate, sla_compliance, aup_violations, backup_health, dr_test_coverage, status_page_uptime
- Score global 0-100 ponderado con grade A-F
- Alertas automaticas: critico <50%, warning <80%
- Inyeccion condicional: modulos no instalados reportan 'not_available' (NULL guard pattern)
- **CompliancePanelController**: Ruta `/admin/jaraba/compliance`, auto-refresh AJAX 60s, API endpoint `/api/v1/compliance/overview`

**Infraestructura theme:**
- 3 zero-region page templates (page--privacy, page--legal-compliance, page--dr-status)
- 3 compliance partials (metric-card, status-badge, timeline)
- 36 SVG compliance icons (duotone + solid)
- 24 SCSS partials (8 por modulo: variables, main, dashboard, responsive + 4 componentes)
- Body classes + template suggestions en ecosistema_jaraba_theme.theme

---

## 10. Infraestructura y DevOps

### 10.1 Entornos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ENTORNOS                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    DESARROLLO (Lando)                            â”‚  â”‚
â”‚   â”‚  â€¢ jaraba-saas.lndo.site                                         â”‚  â”‚
â”‚   â”‚  â€¢ qdrant.jaraba-saas.lndo.site                                  â”‚  â”‚
â”‚   â”‚  â€¢ Docker containers locales                                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                             â”‚
â”‚                           â–¼ git push                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    CI/CD (GitHub Actions)                        â”‚  â”‚
â”‚   â”‚  â€¢ Tests automÃ¡ticos                                             â”‚  â”‚
â”‚   â”‚  â€¢ Linting (PHPStan, ESLint)                                     â”‚  â”‚
â”‚   â”‚  â€¢ Build + Deploy                                                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                             â”‚
â”‚                           â–¼ deploy                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    PRODUCCIÃ“N (IONOS)                            â”‚  â”‚
â”‚   â”‚  â€¢ jarabaimpact.com                                              â”‚  â”‚
â”‚   â”‚  â€¢ PHP 8.4 + MariaDB                                             â”‚  â”‚
â”‚   â”‚  â€¢ Qdrant Cloud                                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Pipeline CI/CD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PIPELINE CI/CD                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   git push main                                                         â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚  Lint   â”‚â”€â”€â”€â–¶â”‚  Test   â”‚â”€â”€â”€â–¶â”‚Security â”‚â”€â”€â”€â–¶â”‚  Build  â”‚â”€â”€â”€â–¶â”‚Deployâ”‚  â”‚
â”‚   â”‚         â”‚    â”‚         â”‚    â”‚         â”‚    â”‚         â”‚    â”‚      â”‚  â”‚
â”‚   â”‚ PHPStan â”‚    â”‚ PHPUnit â”‚    â”‚Composer â”‚    â”‚Composer â”‚    â”‚ Git  â”‚  â”‚
â”‚   â”‚ ESLint  â”‚    â”‚ 80% cov â”‚    â”‚ Trivy   â”‚    â”‚  SCSS   â”‚    â”‚Drush â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   + SECURITY SCAN (daily cron):                                        â”‚
â”‚   Trivy + OWASP ZAP + npm/composer audit â†’ SARIF â†’ GitHub Security     â”‚
â”‚                                                      â”‚                 â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                        â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     DEPLOY STEPS                                 â”‚  â”‚
â”‚   â”‚  1. git reset --hard origin/main                                 â”‚  â”‚
â”‚   â”‚  2. composer install --no-dev                                    â”‚  â”‚
â”‚   â”‚  3. drush updatedb -y                                            â”‚  â”‚
â”‚   â”‚  4. UUID sync (config vs site)                                   â”‚  â”‚
â”‚   â”‚  5. drush config:import -y  â† lee config/sync/ (git-tracked)    â”‚  â”‚
â”‚   â”‚  6. drush cache:rebuild                                          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                        â”‚                               â”‚
â”‚                                        â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     SLACK NOTIFICATIONS                          â”‚  â”‚
â”‚   â”‚  âœ… Deploy exitoso a producciÃ³n                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 Monitoring Stack (Production Gaps v8.0.0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MONITORING STACK                                    â”‚
â”‚                 Docker Compose Standalone                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                    METRICS (Prometheus :9090)                       â”‚â”‚
â”‚   â”‚  Scrape targets: drupal, mysql, qdrant, node, loki                 â”‚â”‚
â”‚   â”‚  14 alert rules: ServiceDown, HighErrorRate, SlowResponseTime,     â”‚â”‚
â”‚   â”‚  DatabaseConnectionPoolExhausted, QdrantDiskFull,                  â”‚â”‚
â”‚   â”‚  StripeWebhookFailures, SSLCertificateExpiring...                  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                    VISUALIZATION (Grafana :3001)                    â”‚â”‚
â”‚   â”‚  Dashboards: Platform Overview, API Performance, Business KPIs     â”‚â”‚
â”‚   â”‚  Data sources: Prometheus + Loki                                   â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ LOGS                      â”‚  â”‚ ALERTING                  â”‚           â”‚
â”‚   â”‚ Loki :3100 + Promtail    â”‚  â”‚ AlertManager :9093         â”‚           â”‚
â”‚   â”‚ drupal, php-fpm, nginx   â”‚  â”‚ criticalâ†’Slack+email       â”‚           â”‚
â”‚   â”‚ 720h retention, TSDB     â”‚  â”‚ warningâ†’Slack #alerts      â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                         â”‚
â”‚   FICHEROS:                                                            â”‚
â”‚   monitoring/docker-compose.monitoring.yml                              â”‚
â”‚   monitoring/prometheus/prometheus.yml + rules/jaraba_alerts.yml        â”‚
â”‚   monitoring/prometheus/rules/scaling_alerts.yml (F10)                  â”‚
â”‚     â””â”€â”€ 10 alert rules + 5 recording rules (3 fases escalado)          â”‚
â”‚   monitoring/loki/loki-config.yml                                      â”‚
â”‚   monitoring/promtail/promtail-config.yml                              â”‚
â”‚   monitoring/alertmanager/alertmanager.yml                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.4 Security CI Automatizado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY SCAN PIPELINE                                â”‚
â”‚                 .github/workflows/security-scan.yml                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Cron: daily 02:00 UTC                                                 â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚Composer â”‚â”€â”€â”€â–¶â”‚  npm    â”‚â”€â”€â”€â–¶â”‚  Trivy  â”‚â”€â”€â”€â–¶â”‚ OWASP   â”‚             â”‚
â”‚   â”‚ audit   â”‚    â”‚  audit  â”‚    â”‚  FS     â”‚    â”‚  ZAP    â”‚             â”‚
â”‚   â”‚         â”‚    â”‚         â”‚    â”‚  scan   â”‚    â”‚ baselineâ”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                      â”‚                 â”‚
â”‚                                               SARIF Upload             â”‚
â”‚                                               GitHub Security          â”‚
â”‚                                                                         â”‚
â”‚   GDPR DRUSH COMMANDS:                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  drush gdpr:export {uid}     â†’ Art. 15 (Acceso) â€” JSON export  â”‚  â”‚
â”‚   â”‚  drush gdpr:anonymize {uid}  â†’ Art. 17 (Olvido) â€” Hash replace â”‚  â”‚
â”‚   â”‚  drush gdpr:report           â†’ Informe compliance general      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   INCIDENT RESPONSE:                                                   â”‚
â”‚   docs/tecnicos/SECURITY_INCIDENT_RESPONSE_PLAYBOOK.md                 â”‚
â”‚   SEV1-SEV4 matrix, AEPD 72h (GDPR Art. 33), templates comunicaciÃ³n   â”‚
â”‚                                                                         â”‚
â”‚   DEPENDABOT REMEDIATION (2026-02-14):                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  42 alertas â†’ 0 abiertas (2 critical + 14 high + 15 med + 11 low)â”‚
â”‚   â”‚  ValidaciÃ³n STAGING_URL pre-ZAP scan (AUDIT-SEC-N17)           â”‚  â”‚
â”‚   â”‚  npm overrides para deps transitivas bloqueadas por upstream   â”‚  â”‚
â”‚   â”‚  web/core/yarn.lock â†’ dismiss documentado (Drupal upstream)    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.5 Go-Live Procedures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GO-LIVE RUNBOOK                                       â”‚
â”‚                 scripts/golive/ + docs/tecnicos/                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   SCRIPTS EJECUTABLES:                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  01_preflight_checks.sh  â”‚ 24 validaciones pre-lanzamiento     â”‚  â”‚
â”‚   â”‚  (PHP, MariaDB, Redis, Qdrant, Stripe, SSL, DNS, mÃ³dulos)      â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚  02_validation_suite.sh  â”‚ Smoke tests por vertical, API,      â”‚  â”‚
â”‚   â”‚  CSRF checks, endpoint health                                   â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚  03_rollback.sh          â”‚ Rollback automatizado 7 pasos       â”‚  â”‚
â”‚   â”‚  con notificaciones Slack                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   FASES RUNBOOK:                                                       â”‚
â”‚   1. Pre-Go-Live (24h antes)  â†’ preflight_checks.sh                   â”‚
â”‚   2. Deploy                    â†’ git pull, composer, drush              â”‚
â”‚   3. ValidaciÃ³n                â†’ validation_suite.sh                   â”‚
â”‚   4. Go/No-Go                  â†’ Criterios cuantitativos               â”‚
â”‚   5. Soft Launch               â†’ 10% trÃ¡fico, monitoring               â”‚
â”‚   6. Public Launch             â†’ 100% trÃ¡fico                          â”‚
â”‚                                                                         â”‚
â”‚   DOCUMENTO: docs/tecnicos/GO_LIVE_RUNBOOK.md (708 LOC, RACI)         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.6 Per-Tenant Backup/Restore (F10 Scaling Infrastructure)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PER-TENANT BACKUP/RESTORE                             â”‚
â”‚                 scripts/restore_tenant.sh                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   COMANDOS:                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  ./restore_tenant.sh backup <tenant_id>   â†’ Backup completo    â”‚  â”‚
â”‚   â”‚  ./restore_tenant.sh restore <tenant_id> <file>  â†’ Restore     â”‚  â”‚
â”‚   â”‚  ./restore_tenant.sh list <tenant_id>     â†’ Lista backups      â”‚  â”‚
â”‚   â”‚  ./restore_tenant.sh tables               â†’ Lista tablas       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   AUTO-DISCOVERY: INFORMATION_SCHEMA query para encontrar 159+         â”‚
â”‚   tablas con columna tenant_id. Zero hardcoding.                       â”‚
â”‚                                                                         â”‚
â”‚   ENTORNOS: ENVIRONMENT=lando (default) | ENVIRONMENT=ionos (prod)    â”‚
â”‚                                                                         â”‚
â”‚   ESCALADO HORIZONTAL (3 Fases):                                       â”‚
â”‚   docs/arquitectura/scaling-horizontal-guide.md                        â”‚
â”‚   Fase 1: Single Server IONOS L-16 (â‰¤50 tenants)                      â”‚
â”‚   Fase 2: Separated DB (â‰¤200 tenants)                                  â”‚
â”‚   Fase 3: Load Balanced HAProxy + Redis Cluster (1000+ tenants)        â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.7 Backup Automatizado Diario (Daily Backup)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DAILY BACKUP SYSTEM                                   â”‚
â”‚              .github/workflows/daily-backup.yml                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   TRIGGER: Cron diario 03:00 UTC (05:00 CET) + workflow_dispatch       â”‚
â”‚                                                                         â”‚
â”‚   PROCESO:                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  1. SSH â†’ IONOS via webfactory/ssh-agent@v0.9.0                 â”‚  â”‚
â”‚   â”‚  2. drush sql-dump --gzip (fallback: mysqldump)                 â”‚  â”‚
â”‚   â”‚  3. VerificaciÃ³n integridad: gzip -t                            â”‚  â”‚
â”‚   â”‚  4. Naming: db_daily_{YYYYMMDD_HHMMSS}.sql.gz                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   DIRECTORIOS (separados para GoodSync):                              â”‚
â”‚   â€¢ ~/backups/daily/       â†’ Backups automÃ¡ticos diarios               â”‚
â”‚   â€¢ ~/backups/pre_deploy/  â†’ Backups pre-deploy (deploy.yml)           â”‚
â”‚                                                                         â”‚
â”‚   ROTACIÃ“N INTELIGENTE:                                                â”‚
â”‚   â€¢ Diarios < 30 dÃ­as: se mantienen todos                              â”‚
â”‚   â€¢ 30-84 dÃ­as: solo lunes (semanal)                                   â”‚
â”‚   â€¢ > 84 dÃ­as: se eliminan                                             â”‚
â”‚   â€¢ Pre-deploy > 30 dÃ­as: se eliminan                                  â”‚
â”‚                                                                         â”‚
â”‚   ALERTAS: Slack via SLACK_WEBHOOK si falla                            â”‚
â”‚   VERIFICACIÃ“N: verify-backups.yml busca en ambos subdirectorios       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.8 Testing Infrastructure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TESTING INFRASTRUCTURE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   UNIT TESTS (PHPUnit 11):                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  789+ tests (730 pass, Unit + Kernel + Functional)              â”‚  â”‚
â”‚   â”‚  Coverage threshold: 80% (enforced in CI)                       â”‚  â”‚
â”‚   â”‚  Codecov upload + GitHub annotations                            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   PERFORMANCE (k6):                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  tests/performance/load_test.js                                 â”‚  â”‚
â”‚   â”‚  Scenarios: smoke (1 VU) â†’ load (50 VUs) â†’ stress (200 VUs)    â”‚  â”‚
â”‚   â”‚  Endpoints: homepage, login, API skills, checkout               â”‚  â”‚
â”‚   â”‚  Thresholds: p95 < 500ms, error rate < 1%                      â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚  tests/performance/multi_tenant_load_test.js (F10)              â”‚  â”‚
â”‚   â”‚  4 Scenarios: multi_tenant_api, crm_pipeline, tenant_isolation, â”‚  â”‚
â”‚   â”‚  scaling_breakpoint (ramp to 100 VUs)                           â”‚  â”‚
â”‚   â”‚  7 Custom metrics: per-API category + tenant isolation failures â”‚  â”‚
â”‚   â”‚  Thresholds: crm p95<500ms, isolation failures=0                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   VISUAL REGRESSION (BackstopJS):                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  tests/visual/backstop.json                                     â”‚  â”‚
â”‚   â”‚  10 pÃ¡ginas Ã— 3 viewports (375px, 768px, 1440px)               â”‚  â”‚
â”‚   â”‚  Puppeteer engine, misMatchThreshold 0.1-0.5                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   E2E (Cypress):                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  12 suites, ~670 lÃ­neas                                         â”‚  â”‚
â”‚   â”‚  Canvas editor, dashboard, AI panel, multi-tenant, a11y         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.9 Email System (MJML Templates)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMAIL TEMPLATE SYSTEM                                 â”‚
â”‚                 jaraba_email module                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   TEMPLATES MJML (35 transaccionales + 1 base):                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  auth/       (5) verify, welcome, password_reset/changed, login â”‚  â”‚
â”‚   â”‚  billing/    (7) invoice, payment_failed, subscription,         â”‚  â”‚
â”‚   â”‚                   upgrade, trial, cancel, dunning               â”‚  â”‚
â”‚   â”‚  marketplace/(6) order_confirmed, new_order_seller, shipped,    â”‚  â”‚
â”‚   â”‚                   delivered, payout, review                     â”‚  â”‚
â”‚   â”‚  empleabilidad/(10) job_match, application, new_application,    â”‚  â”‚
â”‚   â”‚                      shortlisted, expired + seq_onboarding,     â”‚  â”‚
â”‚   â”‚                      seq_reactivation, seq_upsell,              â”‚  â”‚
â”‚   â”‚                      seq_interview_prep, seq_post_hire           â”‚  â”‚
â”‚   â”‚  emprendimiento/(6) welcome_entrepreneur, diagnostic_completed, â”‚  â”‚
â”‚   â”‚                      canvas_milestone, experiment_result,       â”‚  â”‚
â”‚   â”‚                      mentor_matched, weekly_progress            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   FLUJO:                                                               â”‚
â”‚   template_id â”€â”€â–¶ TemplateLoaderService â”€â”€â–¶ {{ variables }}            â”‚
â”‚                         â”‚                       â”‚                      â”‚
â”‚                         â–¼                       â–¼                      â”‚
â”‚                   MJML file              MjmlCompilerService           â”‚
â”‚                                               â”‚                        â”‚
â”‚                                               â–¼                        â”‚
â”‚                                         HTML responsive                â”‚
â”‚                                                                         â”‚
â”‚   SERVICIO: jaraba_email.template_loader                               â”‚
â”‚   COMPILER: jaraba_email.mjml_compiler                                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. Roadmap

### 11.1 Estado Actual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      NIVEL DE MADUREZ                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Nivel 1: Inicial              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  â”‚
â”‚   Nivel 2: Documentada          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  â”‚
â”‚   Nivel 3: Gestionada           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  â”‚
â”‚   Nivel 4: Optimizada           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  â”‚
â”‚   Nivel 5: Adaptativa           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  â”‚
â”‚                                                                         â”‚
â”‚                         NIVEL ACTUAL: 5.0 / 5.0                         â”‚
â”‚                                                                         â”‚
â”‚   Plan Cierre Gaps Clase Mundial: 12/12 Fases Completadas              â”‚
â”‚   F1-F8: ECA, Freemium, Visitor, Landing, Onboarding, Admin, Elena,   â”‚
â”‚          Merchant Copilot                                               â”‚
â”‚   F9: B2B Sales Flow (BANT + SalesPlaybook)                            â”‚
â”‚   F10: Scaling Infra (restore_tenant + k6 + Prometheus)                â”‚
â”‚   F11: IA Clase Mundial (Brand Voice + Prompt A/B + MultiModal)        â”‚
â”‚   F12: Lenis Integration Premium (smooth scroll)                       â”‚
â”‚                                                                         â”‚
â”‚   Sprint Diferido Backlog: 22/22 TODOs resueltos (5 fases)             â”‚
â”‚   FASE 1: Quick Wins (pricing, ratings, canvas, player review)         â”‚
â”‚   FASE 2: UX Sprint 5 (header SaaS, i18n, dynamic fields, a11y)       â”‚
â”‚   FASE 3: Knowledge Base CRUD (FAQs, policies, documents)              â”‚
â”‚   FASE 4: Infraestructura (agent re-exec, tests, webhooks, entities)   â”‚
â”‚   FASE 5: Integraciones (tokens V2.1, batch dispatch, stock, GEO)      â”‚
â”‚                                                                         â”‚
â”‚   Admin Center Premium (Spec f104): 7/7 FASEs completadas              â”‚
â”‚   FASE 1: Shell Layout (sidebar + topbar + aggregator)                 â”‚
â”‚   FASE 2: DataTable reusable + Tenants page                           â”‚
â”‚   FASE 3: Users page + Avatar Detection                               â”‚
â”‚   FASE 4: Finance Centro (MRR, ARPU, Churn, LTV)                      â”‚
â”‚   FASE 5: Alerts & Playbooks (FocAlert + CsPlaybook)                  â”‚
â”‚   FASE 6: Analytics + Logs (Chart.js, AI Telemetry)                    â”‚
â”‚   FASE 7: Settings + Dark Mode + A11y WCAG 2.1 AA                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 Hitos 2026

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HITOS 2026                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ENE â”€â”€â—â”€â”€ KB RAG Qdrant operativo âœ…                                  â”‚
â”‚         â”‚                                                               â”‚
â”‚   ENE â”€â”€â—â”€â”€ FOC v2 DiseÃ±o + DocumentaciÃ³n ğŸ”„                             â”‚
â”‚         â”‚                                                               â”‚
â”‚   FEB â”€â”€â—â”€â”€ FOC Fase 1: Entidades Financieras                           â”‚
â”‚         â”‚                                                               â”‚
â”‚   FEB â”€â”€â—â”€â”€ FOC Fase 2: Stripe Connect Destination Charges              â”‚
â”‚         â”‚                                                               â”‚
â”‚   MAR â”€â”€â—â”€â”€ Game Day #1 Chaos Engineering                               â”‚
â”‚         â”‚                                                               â”‚
â”‚   ABR â”€â”€â—â”€â”€ FOC Fase 3: Motor Proyecciones PHP-ML                       â”‚
â”‚         â”‚                                                               â”‚
â”‚   MAY â”€â”€â—â”€â”€ FOC Fase 4: Alertas ECA + Playbooks                         â”‚
â”‚         â”‚                                                               â”‚
â”‚   JUN â”€â”€â—â”€â”€ Predictive Capacity Planning                                â”‚
â”‚         â”‚                                                               â”‚
â”‚   SEP â”€â”€â—â”€â”€ Game Day #2                                                 â”‚
â”‚         â”‚                                                               â”‚
â”‚   DIC â”€â”€â—â”€â”€ NIVEL 5.0 CERTIFICADO â­                                    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

## 12. Estado de AuditorÃ­a (2026-02-15)

### 12.1 MÃ©tricas de la AuditorÃ­a Integral

<!-- AUDIT-SPEC-N03: Content Entities actualizado de 268 a 375 (verificado via @ContentEntityType grep 2026-02-18) -->
La auditorÃ­a integral del 2026-02-13 analizÃ³ la plataforma desde 15 disciplinas simultÃ¡neas, cubriendo 69 mÃ³dulos custom (actualizado 2026-02-16), 375+ Content Entities y ~769 rutas API.

| DimensiÃ³n | Hallazgos | CrÃ­ticos | Altos | Medios | Bajos |
|-----------|-----------|----------|-------|--------|-------|
| **Seguridad** | 19 | 3 | 6 | 7 | 3 |
| **Rendimiento** | 17 | 3 | 5 | 6 | 3 |
| **Consistencia** | 20 | 1 | 7 | 8 | 4 |
| **Specs vs ImplementaciÃ³n** | 9 | 0 | 2 | 5 | 2 |
| **TOTAL** | **65** | **7** | **20** | **26** | **12** |

### 12.2 EvaluaciÃ³n de Madurez Post-RemediaciÃ³n

La madurez se eleva de 4.5/5.0 a **4.9/5.0** tras completar FASE 1 (7 CrÃ­ticos) y FASE 2 (8 Altos) de la remediaciÃ³n:

| Ãrea | Pre-RemediaciÃ³n | Post-RemediaciÃ³n | Cambios Realizados |
|------|-----------------|------------------|-------------------|
| Multi-Tenancy | 4.5 | **5.0** | AccessControlHandler en 34 entidades, tenant_id migrado a entity_reference en 6 entidades, TenantContextService deduplicado |
| Seguridad | 4.0 | **4.8** | HMAC en webhooks (Stripe + WhatsApp), `_permission` en 100+ rutas, `\|raw` sanitizado server-side. Pendiente: PKCE, rate limiting, SAST |
| Rendimiento | 4.0 | **4.8** | Ãndices DB en entidades de alto volumen, LockBackendInterface financiero, social publish async, caching en 6 servicios, 4 cronâ†’QueueWorker. Pendiente: CDN, lazy-load images |
| Consistencia | 4.5 | **4.8** | Servicios duplicados eliminados, PUTâ†’PATCH estandarizado, config schemas, @importâ†’@use, core_version unificado. Pendiente: 303 CSS --ej-*, 76 rutas sin /api/v1/, 28 formatos JSON |
| CÃ³digo | 5.0 | **5.0** | EstÃ¡ndares PHP 8.4 / Drupal 11 correctos |
| Frontend | 4.5 | **4.8** | @importâ†’@use completado, Drupal.behaviors parcial. Pendiente: 303 CSS custom properties |
| IA/ML | 5.0 | **5.0** | Agentes, RAG, guardrails implementados |
| **Promedio** | **4.5** | **4.9** | **23/65 hallazgos resueltos (7 CrÃ­ticos + 8 Altos + 8 Medios)** |

### 12.3 ElevaciÃ³n Verticales a Clase Mundial (2026-02-17)

| Vertical | Fases | Estado | Servicios Nuevos | Archivos |
|----------|-------|--------|-----------------|----------|
| **Empleabilidad** | 10/10 | âœ… Clase Mundial | EmployabilityFeatureGateService, EmployabilityEmailSequenceService, EmployabilityCrossVerticalBridgeService, EmployabilityJourneyProgressionService, EmployabilityHealthScoreService, EmployabilityCopilotAgent, CopilotApiController, TemplateLoaderService | 34+ archivos |
| **Emprendimiento** | 6/6 + v2 (7 gaps) | âœ… Clase Mundial (Paridad) | EmprendimientoFeatureGateService, EmprendimientoExperimentService, EmprendimientoHealthScoreService, EmprendimientoJourneyProgressionService, EmprendimientoEmailSequenceService, EmprendimientoCopilotAgent, EmprendimientoCrossVerticalBridgeService | 25+ archivos |
| **AndalucÃ­a +ei** | 12/12 | âœ… Clase Mundial | AndaluciaEiFeatureGateService, AndaluciaEiEmailSequenceService, AndaluciaEiCrossVerticalBridgeService, AndaluciaEiJourneyProgressionService, AndaluciaEiHealthScoreService, AndaluciaEiExperimentService | 43 archivos |
| **JarabaLex** | 14/14 | âœ… Clase Mundial | JarabaLexFeatureGateService, JarabaLexEmailSequenceService, JarabaLexCrossVerticalBridgeService, JarabaLexJourneyProgressionService, JarabaLexHealthScoreService, LegalCopilotAgent, JarabaLexJourneyDefinition, LegalCopilotBridgeService | 50 archivos |
| **AgroConecta** | 14/14 | âœ… Clase Mundial | AgroConectaFeatureGateService, AgroConectaEmailSequenceService, AgroConectaCrossVerticalBridgeService, AgroConectaJourneyProgressionService, AgroConectaHealthScoreService, AgroConectaExperimentService, AgroConectaCopilotBridgeService | 60+ archivos |
| **ComercioConecta** | 18/18 (3 sprints) | âœ… Clase Mundial | ComercioConectaFeatureGateService, ComercioConectaEmailSequenceService, ComercioConectaCrossVerticalBridgeService, ComercioConectaJourneyProgressionService, ComercioConectaHealthScoreService, ComercioConectaExperimentService, ComercioConectaCopilotBridgeService + 18 services locales (OrderRetail, Cart, Checkout, StripePayment, CartRecovery, CustomerProfile, Wishlist, MerchantPayout, ComercioSearch, LocalSeo, FlashOffer, QrRetail, ReviewRetail, Notification, ShippingRetail, ClickCollect, PosIntegration, ComercioAdmin, Moderation, ComercioAnalytics, MerchantAnalytics) | 178 archivos |
| **ServiciosConecta** | 14/14 | âœ… Clase Mundial | ServiciosConectaFeatureGateService, ServiciosConectaEmailSequenceService, ServiciosConectaCrossVerticalBridgeService, ServiciosConectaJourneyProgressionService, ServiciosConectaHealthScoreService, ServiciosConectaExperimentService, ServiciosConectaCopilotAgent, ServiciosConectaCopilotBridgeService | 50+ archivos |

**Empleabilidad (10 Fases):**
1. Clean Page Templates (Zero Region + FAB)
2. Sistema Modal CRUD (data-dialog-type)
3. SCSS Compliance (45+ rgbaâ†’color-mix)
4. Feature Gating (3 features Ã— 3 planes)
5. Upgrade Triggers (4 trigger types)
6. Email Sequences (5 secuencias MJML)
7. CRM Integration (7 estados pipeline)
8. Cross-Vertical Bridges (4 bridges)
9. AI Journey Progression Proactiva (7 reglas)
10. Health Scores + KPIs (5 dimensiones + 8 KPIs)

**Emprendimiento v2 â€” Paridad con Empleabilidad (7 Gaps):**
1. Health Score (5 dimensiones: canvas_completeness 25%, hypothesis_validation 30%, experiment_velocity 15%, copilot_engagement 15%, funding_readiness 15% + 8 KPIs)
2. Journey Progression Proactiva (7 reglas: inactivity_discovery, canvas_incomplete, hypothesis_stalled, all_killed_no_pivot, mvp_validated_no_mentor, funding_eligible, post_scaling_expansion)
3. Email Sequences (5 secuencias MJML: SEQ_ENT_001-005 onboarding, canvas abandonment, upsell starter, MVP celebration, post-funding)
4. Copilot Agent (6 modos: business_strategist, financial_advisor, customer_discovery_coach, pitch_trainer, ecosystem_connector, faq)
5. Cross-Vertical Bridges (3 salientes: formacion, servicios, comercio)
6. CRM Sync Pipeline (7 estados: idea_registeredâ†’lead, diagnosticâ†’mql, bmcâ†’sql, mvpâ†’demo, fundingâ†’proposal, scalingâ†’closed_won, abandonedâ†’closed_lost)
7. Upgrade Triggers (5 nuevos: canvas_completed 0.38, first_hypothesis_validated 0.42, mentor_matched 0.35, experiment_success 0.40, funding_eligible 0.45)

**AndalucÃ­a +ei (12 Fases):**
1. Clean Page Templates (Zero Region + FAB + preprocess hooks)
2. SCSS Compliance (zero rgba, color-mix, var(--ej-*), package.json)
3. Design Token Config Vertical (paleta #FF8C42/#00A9A5/#233D63)
4. Feature Gating (6 features Ã— 3 planes = 18 FreemiumVerticalLimit)
5. Email Lifecycle (6 secuencias SEQ_AEI_001-006 + 6 MJML templates)
6. Cross-Vertical Bridges (4 bridges salientes: emprendimiento, empleabilidad, servicios, formaciÃ³n)
7. Proactive AI Journey Progression (8 reglas: inactividad, milestones, inserciÃ³n, re-engagement)
8. Health Scores + KPIs (5 dimensiones + 8 KPIs verticales)
9. i18n Compliance (JourneyDefinition constâ†’static methods + TranslatableMarkup)
10. Upgrade Triggers + CRM (milestones 25h/50h/75h/100h, pipeline atencionâ†’insercionâ†’baja)
11. A/B Testing Framework (8 eventos conversiÃ³n, 4 scopes)
12. Embudo PÃºblico â†’ Registro â†’ Ventas (insert hook, conversion tracking, dashboard enriquecido)

**JarabaLex (14 Fases):**
1. Landing Page (SCSS modifier + GrapesJS thumbnail)
2. Zero-Region Consolidation (body classes via hook_preprocess_html)
3. Modal CRUD (citation modal, alert confirm, dialog.ajax)
4. SCSS Compliance + Design Tokens (vertical_jarabalex navy/gold)
5. Feature Gating (JarabaLexFeatureGateService + 36 FreemiumVerticalLimit: 18 legal research + 18 despacho management)
6. Upgrade Triggers (11 legal trigger types: 5 research + 6 despacho + fire() + copilot upsell)
7. Email Sequences (5 MJML templates SEQ_LEX_001-005)
8. CRM Integration (ensure_crm_contact + sync_crm_event pipeline)
9. Cross-Vertical Bridges (4: emprendimiento, empleabilidad, fiscal, formacion)
10. Journey Definition (3 avatars: profesional_juridico, gestor_fiscal, investigador_legal)
11. AI Journey Progression Proactiva (7 reglas: inactividad, bookmarks, alertas, citas, upgrade, fiscal, UE)
12. Health Scores + KPIs (5 dimensiones + 8 KPIs verticales)
13. LegalCopilotAgent (6 modos, AgentInterface completo, LEGAL-RAG-001)
14. Avatar Navigation (legal_professional) + 3 Funnel Definitions

**AgroConecta (14 Fases + Page Builder Premium):**
1. FeatureGateService (CUMULATIVE/MONTHLY/BINARY) + 12 FreemiumVerticalLimit configs (4 features x 3 planes)
2. UpgradeTrigger types (8 nuevos: agro_products, orders, copilot, photos, traceability, partner_hub, analytics, demand_forecaster)
3. AgroConectaCopilotBridgeService (context productor + soft suggestions + market insights)
4. Body classes consolidation (hook_preprocess_html + page--clean-layout)
5. Zero-region page--agroconecta.html.twig + Copilot FAB + hook_preprocess_page clean_content
6. SCSS compliance (95 rgbaâ†’color-mix en 16 ficheros) + design token vertical nature_green
7. Email sequences MJML (6 templates SEQ_AGRO_001-006: onboarding, activacion, re-engagement, upsell starter, upsell pro, retention)
8. CrossVerticalBridgeService (4 bridges: emprendimiento, fiscal, formacion, empleabilidad)
9. JourneyProgressionService (10 reglas proactivas: 8 productor + 2 consumidor)
10. HealthScoreService (5 dimensiones: catalog 25%, sales 30%, engagement 20%, copilot 10%, presence 15% + 8 KPIs)
11. ExperimentService (4 A/B tests: checkout_cta_color, product_card_layout, pricing_page_variant, landing_hero_copy)
12. Avatar navigation (buyer + producer deep links) + 4 Funnel Definitions (acquisition, activation, monetization, consumer_purchase)
13. QA integral (52 ficheros, 0 errores, 18 agentes paralelos)
14. Page Builder Premium: 11 templates (jaraba_icon, data-effect fade-up, staggered delays, FAQ JSON-LD, LocalBusiness microdata, AggregateRating, lightbox, countdown timer, pricing toggle, star ratings) + 11 YML configs (is_premium:true, animation:fade-up, plans_required, fields_schema)

**ComercioConecta (18 Fases en 3 Sprints):**
Sprint 1 â€” Infraestructura de Elevacion (14 fases patron reutilizable):
1. FeatureGateService (CUMULATIVE/MONTHLY/BINARY) + 9 FreemiumVerticalLimit (products, orders, copilot x 3 planes)
2. UpgradeTrigger types (7 nuevos: comercio_products, orders, copilot, flash_offers, qr_codes, reviews, shipping)
3. ComercioConectaCopilotBridgeService (context comerciante + merchant insights)
4. Body classes (hook_preprocess_html + page--comercio route mapping)
5. Zero-region page--comercio-marketplace.html.twig + Copilot FAB + hook_preprocess_page
6. SCSS compliance (color-mix, var(--ej-*)) + design token vertical comercio_conecta
7. Email sequences MJML (6 templates SEQ_COM_001-006: onboarding, activation, first-sale, upsell, retention, cart-abandoned)
8. CrossVerticalBridgeService (4 bridges: agroconecta, servicios, emprendimiento, empleabilidad)
9. JourneyProgressionService (8 reglas proactivas: 6 comerciante + 2 consumidor)
10. HealthScoreService (5 dim: catalog 25%, sales 30%, engagement 20%, copilot 10%, presence 15% + 8 KPIs)
11. ExperimentService (4 A/B tests)
12. Avatar navigation (merchant + consumer) + 4 Funnel Definitions
13. Page Builder Premium: 11 templates (jaraba_icon, schema.org, FAQ JSON-LD, LocalBusiness)
14. QA integral

Sprint 2 â€” Comercio Core Completo:
15. F6 Orders+Checkout+Payments: 9 entidades (OrderRetail, OrderItemRetail, SuborderRetail, Cart, CartItem, ReturnRequest, CouponRetail, CouponRedemption, AbandonedCart) + 5 services + Stripe Connect split + IVA 21% + checkout.js/scss
16. F7 Portales: 3 entidades (CustomerProfile, Wishlist, WishlistItem) + 3 services + customer-portal.js + merchant-portal.js
17. F8 Search+SEO: 5 entidades (SearchIndex, SearchSynonym, SearchLog, LocalBusinessProfile, NapEntry) + 2 services (Haversine, Schema.org) + search.js/scss
18. F9 Engagement: 11 entidades (FlashOffer, FlashOfferClaim, QrCodeRetail, QrScanEvent, QrLeadCapture, ReviewRetail, QuestionAnswer, NotificationTemplate/Log/Preference, PushSubscription) + 4 services

Sprint 3 â€” Funcionalidades Avanzadas:
19. F10 Shipping+POS+Admin+Analytics: 10 entidades (ShipmentRetail, ShippingMethodRetail, ShippingZone, CarrierConfig, PosConnection, PosSync, PosConflict, ModerationQueue, IncidentTicket, PayoutRecord) + 7 services

**ServiciosConecta (14 Fases):**
1. Bug fix releaseSlot() + ProviderService refactor N+1
2. ServiciosConectaSettingsForm config
3. FeatureGateService (CUMULATIVE/MONTHLY/BINARY) + 4 FreemiumVerticalLimit
4. 8 UpgradeTrigger types + CopilotBridgeService
5. Body classes + zero-region page templates (marketplace + dashboard)
6. SCSS compliance (5 Tailwindâ†’var(--ej-*), rgbaâ†’color-mix, design token)
7. ReviewService + ReviewServicios entity
8. EmailSequenceService (6 MJML SEQ_SVC_001-006)
9. CrossVerticalBridgeService (4 bridges)
10. JourneyProgressionService (10 reglas: 8 profesional + 2 cliente)
11. HealthScoreService (5 dim + 8 KPIs) + CopilotAgent (6 modos)
12. ExperimentService (3 A/B) + Avatar nav (profesional + cliente_servicios)
13. 2 FunnelDefinitions + 15 PB templates (11 fix + 4 premium)
14. QA integral

### 12.4 Dependabot Security Posture (2026-02-14)

| MÃ©trica | Antes | DespuÃ©s |
|---------|-------|---------|
| **Critical** | 2 | **0** |
| **High** | 14 | **0** |
| **Medium** | 15 | **0** |
| **Low** | 11 | **0** (1 dismissed â€” Drupal upstream) |
| **Total abiertas** | 42 | **0** |

**TÃ©cnicas aplicadas:**
- `npm audit fix` para dependencias directas en lockfiles contrib
- `npm audit fix --force` para major bumps en devDependencies (ckeditor5-dev-utils 30â†’49)
- `overrides` en package.json para transitivas bloqueadas por upstream (mochaâ†’diff ^7â†’^8.0.3)
- Dismiss documentado para `web/core/yarn.lock` (webpack â€” mantenido por Drupal upstream)

### 12.5 EspecificaciÃ³n Stack Cumplimiento Fiscal (2026-02-15)

5 documentos tÃ©cnicos especificando el stack completo de cumplimiento fiscal para el ecosistema:

| Doc | CÃ³digo | MÃ³dulo | Contenido |
|-----|--------|--------|-----------|
| **178** | AuditorÃ­a VeriFactu & World-Class Gap Analysis | â€” | AnÃ¡lisis estratÃ©gico: VeriFactu NO implementado, score 20.75/100, roadmap 3 fases (1,056-1,427h), componentes reutilizables |
| **179** | Platform VeriFactu Implementation | `jaraba_verifactu` | 4 entidades, 7 servicios, 21 endpoints, 5 ECA flows, 23 tests, 7 permisos RBAC, 4 sprints (230-316h) |
| **180** | Platform Facturae 3.2.2 + FACe B2G | `jaraba_facturae` | 3 entidades, 6 servicios, 21 endpoints, 5 ECA flows, 26 tests, firma XAdES-EPES (230-304h) |
| **181** | Platform E-Factura B2B (Crea y Crece) | `jaraba_einvoice_b2b` | 4 entidades, 6 servicios, 24 endpoints, 5 ECA flows, 23 tests, UBL 2.1 + Facturae dual (260-336h) |
| **182** | Gap Analysis Madurez Documental | â€” | 4 niveles (N0 100%, N1 97%, N2 85%, N3 0%), 18 docs pendientes, 1,040-1,335h gap total |

**InversiÃ³n total stack fiscal:** 720-956h / 32,400-43,020 EUR (implementaciÃ³n 3 mÃ³dulos).

### 12.6 Vertical JarabaLex â€” Legal Intelligence Hub (2026-02-15, actualizado 2026-02-28)

3 documentos tÃ©cnicos + 1 plan de implementaciÃ³n especificando el Legal Intelligence Hub, elevado a vertical independiente JarabaLex (antes sub-feature ServiciosConecta):

| Doc | CÃ³digo | Contenido |
|-----|--------|-----------|
| **178** | ServiciosConecta Legal Intelligence Hub | EspecificaciÃ³n base: 5 Content Entities, 7 Services, 8 Spiders (4 nacionales + 4 UE), Pipeline NLP 9 etapas, Qdrant dual collection, merge & rank con EU primacy |
| **178A** | Legal Intelligence Hub EU Sources | Fuentes europeas: EUR-Lex (CELLAR SPARQL), CURIA/TJUE, HUDOC/TEDH, EDPB, embeddings multilingÃ¼es 1024D, cross-lingual search |
| **178B** | Legal Intelligence Hub Implementation | GuÃ­a implementaciÃ³n: arquitectura mÃ³dulo, compilaciÃ³n SCSS, Docker NLP (spaCy + FastAPI), 12 iconos SVG duotone, paleta legal 10 tokens |
| **Plan** | Plan ImplementaciÃ³n Legal Intelligence Hub v1 | 10 fases (0-9), 530-685h, 23,850-30,825 EUR, 14 directrices con ejemplos cÃ³digo, estrategia convivencia jaraba_legal_knowledge |

**Unificacion Landing JarabaLex + Despachos (2026-02-28):** La landing `/despachos` (features de practica legal) se unifico en `/jarabalex` via 301 redirect. 5 modulos legales habilitados (calendar, vault, billing, lexnet, templates). 18 FreemiumVerticalLimit configs creados (36 total). LexNET como killer differentiator. Auditoria: `docs/analisis/2026-02-28_Auditoria_Landing_JarabaLex_Despachos_Clase_Mundial_v1.md`. Plan: `docs/implementacion/2026-02-28_Plan_Unificacion_Landing_JarabaLex_Despachos_Clase_Mundial_v1.md`.

**RelaciÃ³n con jaraba_legal_knowledge:** El nuevo mÃ³dulo `jaraba_legal_intelligence` extiende las capacidades de `jaraba_legal_knowledge` (4 entidades, 10 servicios, colecciÃ³n Qdrant `jaraba_knowledge`). Estrategia de convivencia: jaraba_legal_knowledge se mantiene como mÃ³dulo ligero para RAG normativo bÃ¡sico (BOE, fiscal); jaraba_legal_intelligence aÃ±ade resoluciones judiciales, fuentes europeas, NLP avanzado y dashboard profesional.

> **SISTEMA DE COHERENCIA JURIDICA (LCIS) â€” 9 CAPAS** (2026-02-28)
> Legal Coherence Intelligence System implementado en `jaraba_legal_intelligence/src/LegalCoherence/`. 9 servicios PHP puros (sin dependencias Drupal en capas 1-4), patron fail-open en todas las capas. 149 unit tests, 277 assertions.
>
> | Capa | Servicio | LOC | Funcion |
> |------|----------|-----|---------|
> | **L1** Knowledge Base | `LegalCoherenceKnowledgeBase` | 445 | 9 niveles jerarquicos, 6 regimenes forales, 30+ regex, competencias Art.149.1 |
> | **L2** Intent Classifier | `LegalIntentClassifierService` | 345 | Gate 5 intents (DIRECT/IMPLICIT/REFERENCE/COMPLIANCE/NON_LEGAL), shortcircuits |
> | **L3** Normative Graph | `NormativeGraphEnricher` | 329 | Authority-Aware RAG: 0.55 semantic + 0.30 authority + 0.15 recency, derogation filter |
> | **L4** Prompt Rules | `LegalCoherencePromptRule` | 176 | 8+1 reglas inyectadas (R1-R8 + R9 territorial), version short, foral auto-detection |
> | **L5** Constitutional | `LegalConstitutionalGuardrailService` | â€” | Guardrails constitucionales pre-LLM |
> | **L6** Validator | `LegalCoherenceValidatorService` | 684 | 7 checks post-LLM, scoring PENALTIES, regenerate/block/warn, anti-sycophancy V8 |
> | **L7** Verifier | `LegalCoherenceVerifierService` | â€” | Verificacion final coherencia |
> | **L8** Disclaimer | `LegalDisclaimerEnforcementService` | 166 | Disclaimer no-eliminable, fallback, score threshold 70% |
> | **MT** Multi-Turn | `LegalConversationContext` | 256 | Cross-turn assertions, contradiction detection, MAX_TURNS=20, MAX_ASSERTIONS=50 |
>
> Reglas: LEGAL-COHERENCE-KB-001, LEGAL-COHERENCE-INTENT-001, LEGAL-COHERENCE-PROMPT-001, LEGAL-COHERENCE-FAILOPEN-001, LEGAL-COHERENCE-REGEN-001, LEGAL-COHERENCE-MULTITURN-001 en Directrices v103.0.0. EU AI Act: HIGH RISK (Annex III, 8 â€” Administration of Justice). Aprendizaje #153.

### 12.7 EspecificaciÃ³n Niveles de Madurez N1/N2/N3 (2026-02-16)

21 documentos tÃ©cnicos especificando capacidades organizados por nivel de madurez plataforma, mÃ¡s 3 auditorÃ­as de readiness y 1 plan de implementaciÃ³n fiscal:

**Nivel 1 â€” Foundation/Compliance (docs 183-185):**

| Doc | TÃ­tulo | Ãrea |
|-----|--------|------|
| **183** | GDPR DPA Templates â€” Plantillas legales multi-tenant RGPD/LOPD-GDD | Legal/Compliance |
| **184** | Legal Terms SaaS â€” TdS, SLA, AUP, Licencia de Datos, Offboarding | Legal |
| **185** | Disaster Recovery Plan â€” Continuidad de Negocio y RecuperaciÃ³n ante Desastres | DR/BCP |
| **201** | AuditorÃ­a N1 Claude Code Readiness | **NOT READY â€” 12 gaps crÃ­ticos** |

**Nivel 2 â€” Growth Ready (docs 186-193):**

| Doc | TÃ­tulo | Ãrea |
|-----|--------|------|
| **186** | AI Autonomous Agents â€” EjecuciÃ³n autÃ³noma con guardrails de seguridad | AI |
| **187** | Native Mobile App â€” iOS/Android con Capacitor | Mobile |
| **188** | Multi-Agent Orchestration â€” Agentes especializados con memoria compartida | AI |
| **189** | Predictive Analytics â€” Churn, Lead Scoring, Forecasting, Anomaly Detection | Analytics |
| **190** | Multi-Region Operations â€” Fiscalidad multi-paÃ­s, multi-currency, data residency | Infrastructure |
| **191** | STO/PIIL Integration â€” Servicio TelemÃ¡tico de OrientaciÃ³n + Programas PIIL | Integrations |
| **192** | European Funding Module â€” Fondos europeos, subvenciones, convocatorias | Funding |
| **193** | Connector SDK â€” SDK para conectores, certificaciÃ³n y marketplace | Platform |
| **202** | AuditorÃ­a N2 Claude Code Readiness | **Score Global: 15.6%** |

**Nivel 3 â€” Enterprise Class (docs 194-200):**

| Doc | TÃ­tulo | Ãrea |
|-----|--------|------|
| **194** | SOC 2 Type II Readiness â€” PreparaciÃ³n con evidencia automatizada | Security |
| **195** | ISO 27001 SGSI â€” Sistema de GestiÃ³n de Seguridad de la InformaciÃ³n | Security |
| **196** | ENS Compliance â€” Esquema Nacional de Seguridad (RD 311/2022) | Security |
| **197** | High Availability Multi-Region â€” 99.99% Galera Cluster + zero-downtime | Infrastructure |
| **198** | SLA Management â€” GestiÃ³n formal SLAs, status page y postmortems | Operations |
| **199** | SSO SAML/SCIM â€” Single Sign-On enterprise SAML 2.0, SCIM 2.0, MFA | Security/Identity |
| **200** | Data Governance â€” ClasificaciÃ³n, retenciÃ³n, lineage y KMS | Data |
| **203** | AuditorÃ­a N3 Claude Code Readiness | **Score Global: 10.4%** |

**Plan de implementaciÃ³n fiscal:**

| Doc | TÃ­tulo |
|-----|--------|
| **Plan** | Plan ImplementaciÃ³n Stack Cumplimiento Fiscal v1 â€” `jaraba_verifactu` + `jaraba_facturae` + `jaraba_einvoice_b2b` (107KB, 720-956h) |

**SeparaciÃ³n directorios backup:** `~/backups/daily/` (automÃ¡ticos diarios) y `~/backups/pre_deploy/` (pre-deploy) separados para configuraciÃ³n GoodSync. Paso de migraciÃ³n one-time aÃ±adido a `daily-backup.yml`.

### 12.8 CI Testing Infrastructure (2026-02-16)

**Estado:** 2,039 tests pasando (1,895 Unit + 144 Kernel), 0 errores, 0 fallos.

**Workflow:** "Jaraba SaaS - Deploy to IONOS" ejecuta PHPUnit Unit y Kernel tests en cada push a main. SQLite para Kernel tests (phpunit.xml).

**Patrones Kernel Test establecidos (7 commits, 61â†’0 errores):**

| Patron | Regla | Descripcion |
|--------|-------|-------------|
| **Module dependencies** | KERNEL-DEP-001 | KernelTestBase `$modules` DEBE incluir todos los modulos que proveen field types: `options` (list_string), `datetime` (datetime), `flexible_permissions` + `group` (entity_referenceâ†’group), `file` (entity_referenceâ†’file) |
| **Synthetic services** | KERNEL-SYNTH-001 | Dependencias de modulos no cargados â†’ `register(ContainerBuilder)` con `setSynthetic(TRUE)` + `setUp()` con `createMock()`. Usado para: `ecosistema_jaraba_core.certificate_manager`, `jaraba_foc.stripe_connect` |
| **Entity reference targets** | KERNEL-EREF-001 | Entity references a entidades inexistentes se descartan silenciosamente en save(). Tests DEBEN crear entity target primero |
| **Timestamp tolerance** | KERNEL-TIME-001 | `time() - 1` / `time() + 1` para evitar flaky tests por race conditions en CI |
| **SQLite decimals** | KERNEL-DECIMAL-001 | SQLite retorna `'1210'` no `'1210.00'`. Usar `assertEqualsWithDelta($expected, (float)$value, 0.001)` |
| **UID 1 super admin** | KERNEL-UID1-001 | Drupal uid=1 bypasses ALL access checks. Tests de permisos DEBEN crear uid=1 placeholder en setUp() |

**Bug de produccion descubierto y corregido:** `jaraba_verifactu.module` referenciaba campo `modo_verifactu` (no existe) en vez de `is_active` en funciones helper de tenant. Detectado por Kernel tests que instalaban el entity schema real.

**Distribucion test files:** 233 Unit + 38 Kernel + 28 Functional = 299 archivos test en 69 modulos custom.

### 12.9 Referencias

| Documento | UbicaciÃ³n |
|-----------|-----------|
| AuditorÃ­a Integral Estado SaaS v1 | `docs/tecnicos/auditorias/20260213-Auditoria_Integral_Estado_SaaS_v1_Claude.md` |
| Plan de RemediaciÃ³n v1 | `docs/implementacion/20260213-Plan_Remediacion_Auditoria_Integral_v1.md` |
| Aprendizajes AuditorÃ­a Integral | `docs/tecnicos/aprendizajes/2026-02-13_auditoria_integral_estado_saas.md` |
| Aprendizajes Security CI + Dependabot | `docs/tecnicos/aprendizajes/2026-02-14_security_ci_dependabot_remediation.md` |
| Directrices v21.0.0 (11 reglas AUDIT-*) | `docs/00_DIRECTRICES_PROYECTO.md` |

---

## ğŸ“ Referencias

| Documento | UbicaciÃ³n |
|-----------|-----------|
| Directrices del Proyecto | `docs/00_DIRECTRICES_PROYECTO.md` |
| Ãndice General | `docs/00_INDICE_GENERAL.md` |
| Arquitectura Alto Nivel | `docs/arquitectura/2026-01-09_1902_arquitectura-alto-nivel.md` |
| Planes SaaS | `docs/logica/2026-01-09_1908_definicion-planes-saas.md` |
| Roadmap Nivel 5 | `docs/planificacion/2026-01-11_1503_roadmap-nivel5-arquitectura.md` |
| GuÃ­a KB RAG | `docs/tecnicos/20260111-Guia_Tecnica_KB_RAG_Qdrant.md` |
| Documento FOC v2 | `docs/tecnicos/20260113d-FOC_Documento_Tecnico_Definitivo_v2_Claude.md` |
| README FOC (API) | `web/modules/custom/jaraba_foc/README.md` |
| **Plan EstratÃ©gico v4.0** | `docs/planificacion/20260114-Plan_Estrategico_SaaS_Q1Q4_2026.md` |
| **AuditorÃ­a Profunda SaaS v1** | `docs/tecnicos/auditorias/20260206-Auditoria_Profunda_SaaS_Multidimensional_v1_Claude.md` |
| **Plan ElevaciÃ³n Page Builder v1.2** â­ | `docs/arquitectura/2026-02-08_plan_elevacion_page_builder_clase_mundial.md` |
| **Aprendizajes ElevaciÃ³n Page Builder** | `docs/tecnicos/aprendizajes/2026-02-08_elevacion_page_builder_clase_mundial.md` |
| **Aprendizajes AuditorÃ­a v2.1** â­ | `docs/tecnicos/aprendizajes/2026-02-09_auditoria_v2_falsos_positivos_page_builder.md` |
| **Plan v2.1 Falsos Positivos** â­ | `docs/planificacion/20260209-Plan_Elevacion_Page_Site_Builder_v2.md` |
| **Aprendizajes AuditorÃ­a** | `docs/tecnicos/aprendizajes/2026-02-06_auditoria_profunda_saas_multidimensional.md` |
| **Aprendizajes PHPUnit 11** â­ | `docs/tecnicos/aprendizajes/2026-02-11_phpunit11_kernel_test_remediation.md` |
| **Aprendizajes Sprint C4 IA Page Builder** â­ | `docs/tecnicos/aprendizajes/2026-02-11_sprint_c4_ia_asistente_page_builder.md` |
| **Plan ServiciosConecta Fase 1** â­ | `docs/implementacion/20260209-Plan_Implementacion_ServiciosConecta_v1.md` |
| **Aprendizajes ServiciosConecta** | `docs/tecnicos/aprendizajes/2026-02-09_servicios_conecta_fase1_implementation.md` |
| **Plan Maestro Unificado v3.0** â­ | `docs/planificacion/20260123-Plan_Maestro_Unificado_SaaS_v3_Claude.md` |
| **Bloque G: AI Skills System** â­ | `docs/implementacion/20260123g-Bloque_G_AI_Skills_Implementacion_Claude.md` |
| **AuditorÃ­a Gap Q1 2027** | `docs/tecnicos/20260115g-Auditoria_Gap_Arquitectura_v1_Claude.md` |
| **Mapeo ArquitectÃ³nico Integral** | `docs/arquitectura/2026-01-19_1858_mapeo-arquitectonico-integral-saas.md` |
| **Vertical Emprendimiento Gap Analysis** | `docs/tecnicos/20260115h-Gap_Analysis_Documentacion_Tecnica_Emprendimiento_v1_Claude.md` |
| **Copiloto v2 Especificaciones** | `docs/tecnicos/20260121a-Especificaciones_Tecnicas_Copiloto_v2_Claude.md` |
| **Programa AndalucÃ­a +ei** | `docs/tecnicos/20260115c-Programa%20Maestro%20Andaluc%C3%ADa%20+ei%20V2.0_Gemini.md` |
| **Aprendizajes Avatar + Empleabilidad** â­ | `docs/tecnicos/aprendizajes/2026-02-12_avatar_empleabilidad_activation.md` |
| **Aprendizajes Self-Discovery Entities + Services** â­ | `docs/tecnicos/aprendizajes/2026-02-12_self_discovery_content_entities_services.md` |
| **Plan Cierre Gaps Specs 20260122-25** â­ | `docs/implementacion/2026-02-12_Plan_Cierre_Gaps_Specs_20260122_20260125.md` |
| **Aprendizajes Heatmaps + Tracking Fases 1-5** â­ | `docs/tecnicos/aprendizajes/2026-02-12_heatmaps_tracking_phases_1_5.md` |
| **AuditorÃ­a Integral Estado SaaS v1** â­ | `docs/tecnicos/auditorias/20260213-Auditoria_Integral_Estado_SaaS_v1_Claude.md` |
| **Plan RemediaciÃ³n AuditorÃ­a Integral v1** â­ | `docs/implementacion/20260213-Plan_Remediacion_Auditoria_Integral_v1.md` |
| **Aprendizajes AuditorÃ­a Integral** â­ | `docs/tecnicos/aprendizajes/2026-02-13_auditoria_integral_estado_saas.md` |
| **Plan Sprint Diferido (22 TODOs, 5 fases)** â­ | `docs/implementacion/20260213-Plan_Implementacion_Sprint_Diferido_v1.md` |
| **Aprendizajes Sprint Diferido** â­ | `docs/tecnicos/aprendizajes/2026-02-13_sprint_diferido_22_todos_5_fases.md` |
| **Plan ElevaciÃ³n Empleabilidad v1** â­ | `docs/implementacion/2026-02-15_Plan_Elevacion_Clase_Mundial_Vertical_Empleabilidad_v1.md` |
| **Aprendizajes ElevaciÃ³n Empleabilidad 10 Fases** â­ | `docs/tecnicos/aprendizajes/2026-02-15_empleabilidad_elevacion_10_fases.md` |
| **Aprendizajes ElevaciÃ³n Emprendimiento 6 Fases** â­ | `docs/tecnicos/aprendizajes/2026-02-15_emprendimiento_elevacion_6_fases.md` |
| **Plan Emprendimiento v2 Paridad 7 Gaps** â­ | `docs/implementacion/20260215-Plan_Elevacion_Emprendimiento_v2_Paridad_Empleabilidad_7_Gaps.md` |
| **Aprendizajes Emprendimiento Paridad 7 Gaps** â­ | `docs/tecnicos/aprendizajes/2026-02-15_emprendimiento_paridad_empleabilidad_7_gaps.md` |
| **Plan ElevaciÃ³n AndalucÃ­a +ei 12 Fases** â­ | `docs/implementacion/20260215c-Plan_Elevacion_Andalucia_EI_Clase_Mundial_v1_Claude.md` |
| **Aprendizajes AndalucÃ­a +ei ElevaciÃ³n 12 Fases** â­ | `docs/tecnicos/aprendizajes/2026-02-15_andalucia_ei_elevacion_12_fases.md` |
| **AuditorÃ­a VeriFactu & World-Class Gap Analysis** â­ | `docs/tecnicos/20260215b-178_Auditoria_VeriFactu_WorldClass_v1_Claude.md` |
| **EspecificaciÃ³n VeriFactu Implementation** â­ | `docs/tecnicos/20260215b-179_Platform_VeriFactu_Implementation_v1_Claude.md` |
| **EspecificaciÃ³n Facturae 3.2.2 + FACe B2G** â­ | `docs/tecnicos/20260215c-180_Platform_Facturae_FACe_B2G_v1_Claude.md` |
| **EspecificaciÃ³n E-Factura B2B (Crea y Crece)** â­ | `docs/tecnicos/20260215d-181_Platform_EFactura_B2B_v1_Claude.md` |
| **Gap Analysis Madurez Documental Niveles 0-3** â­ | `docs/tecnicos/20260215e-182_Gap_Analysis_Madurez_Documental_v1_Claude.md` |
| **Aprendizajes Stack Fiscal VeriFactu** â­ | `docs/tecnicos/aprendizajes/2026-02-15_verifactu_stack_fiscal_compliance.md` |
| **EspecificaciÃ³n Legal Intelligence Hub** â­ | `docs/tecnicos/20260215a-178_ServiciosConecta_Legal_Intelligence_Hub_v1_Claude.md` |
| **EspecificaciÃ³n Legal Intelligence Hub EU Sources** â­ | `docs/tecnicos/20260215a-178A_Legal_Intelligence_Hub_EU_Sources_v1_Claude.md` |
| **EspecificaciÃ³n Legal Intelligence Hub Implementation** â­ | `docs/tecnicos/20260215a-178B_Legal_Intelligence_Hub_Implementation_v1_Claude.md` |
| **Plan ImplementaciÃ³n Legal Intelligence Hub v1** â­ | `docs/implementacion/20260215-Plan_Implementacion_Legal_Intelligence_Hub_v1.md` |
| **Plan ImplementaciÃ³n Stack Fiscal v1** â­ | `docs/implementacion/20260216-Plan_Implementacion_Stack_Cumplimiento_Fiscal_v1.md` |
| **GDPR DPA Templates (Doc 183)** â­ | `docs/tecnicos/20260216a-183_Platform_GDPR_DPA_Templates_v1_Claude.md` |
| **Legal Terms SaaS (Doc 184)** â­ | `docs/tecnicos/20260216a-184_Platform_Legal_Terms_v1_Claude.md` |
| **Disaster Recovery Plan (Doc 185)** â­ | `docs/tecnicos/20260216a-185_Platform_Disaster_Recovery_v1_Claude.md` |
| **AI Autonomous Agents (Doc 186)** â­ | `docs/tecnicos/20260216b-186_Platform_AI_Autonomous_Agents_v1_Claude.md` |
| **Native Mobile App (Doc 187)** â­ | `docs/tecnicos/20260216b-187_Platform_Native_Mobile_v1_Claude.md` |
| **Multi-Agent Orchestration (Doc 188)** â­ | `docs/tecnicos/20260216b-188_Platform_Multi_Agent_Orchestration_v1_Claude.md` |
| **Predictive Analytics (Doc 189)** â­ | `docs/tecnicos/20260216b-189_Platform_Predictive_Analytics_v1_Claude.md` |
| **Multi-Region Operations (Doc 190)** â­ | `docs/tecnicos/20260216b-190_Platform_Multi_Region_v1_Claude.md` |
| **STO/PIIL Integration (Doc 191)** â­ | `docs/tecnicos/20260216b-191_Platform_STO_PIIL_Integration_v1_Claude.md` |
| **European Funding Module (Doc 192)** â­ | `docs/tecnicos/20260216b-192_Platform_European_Funding_v1_Claude.md` |
| **Connector SDK (Doc 193)** â­ | `docs/tecnicos/20260216b-193_Platform_Connector_SDK_v1_Claude.md` |
| **SOC 2 Type II Readiness (Doc 194)** â­ | `docs/tecnicos/20260216c-194_Platform_SOC2_Type_II_Readiness_v1_Claude.md` |
| **ISO 27001 SGSI (Doc 195)** â­ | `docs/tecnicos/20260216c-195_Platform_ISO_27001_SGSI_v1_Claude.md` |
| **ENS Compliance (Doc 196)** â­ | `docs/tecnicos/20260216c-196_Platform_ENS_Compliance_v1_Claude.md` |
| **HA Multi-Region (Doc 197)** â­ | `docs/tecnicos/20260216c-197_Platform_HA_Multi_Region_v1_Claude.md` |
| **SLA Management (Doc 198)** â­ | `docs/tecnicos/20260216c-198_Platform_SLA_Management_v1_Claude.md` |
| **SSO SAML/SCIM (Doc 199)** â­ | `docs/tecnicos/20260216c-199_Platform_SSO_SAML_SCIM_v1_Claude.md` |
| **Data Governance (Doc 200)** â­ | `docs/tecnicos/20260216c-200_Platform_Data_Governance_v1_Claude.md` |
| **AuditorÃ­a N1 Readiness (Doc 201)** â­ | `docs/tecnicos/20260216a-201_Auditoria_N1_ClaudeCode_Readiness_v1_Claude.md` |
| **AuditorÃ­a N2 Readiness (Doc 202)** â­ | `docs/tecnicos/20260216b-202_Auditoria_N2_ClaudeCode_Readiness_v1_Claude.md` |
| **AuditorÃ­a N3 Readiness (Doc 203)** â­ | `docs/tecnicos/20260216c-203_Auditoria_N3_ClaudeCode_Readiness_v1_Claude.md` |
| **Aprendizajes Tenant Export + Backup** â­ | `docs/tecnicos/aprendizajes/2026-02-16_tenant_export_backup_automatizado.md` |
| **Plan Elevacion JarabaLex Vertical Independiente** â­ | `docs/implementacion/20260216-Elevacion_JarabaLex_Vertical_Independiente_v1.md` |
| **Aprendizajes Elevacion JarabaLex** â­ | `docs/tecnicos/aprendizajes/2026-02-16_jarabalex_elevacion_vertical_independiente.md` |
| **Aprendizajes FASE 11 + Compliance Legal N1** â­ | `docs/tecnicos/aprendizajes/2026-02-16_fase11_fiscal_integration_compliance_legal_n1.md` |
| **Aprendizajes Gap-filling + ComplianceAggregator** â­ | `docs/tecnicos/aprendizajes/2026-02-16_gap_filling_compliance_aggregator.md` |

---

## ğŸ“Š Plan Maestro v3.0 (AuditorÃ­a 2026-01-23)

| Bloque | DescripciÃ³n | Horas |
|--------|-------------|-------|
| **A** | Gaps AuditorÃ­a: SEPE, Frontend, AgroConecta, ExpansiÃ³n | 1,690h |
| **B** | Copiloto v3: Osterwalder/Blank | 96h |
| **C** | Journey Engine: 19 avatares, 7 estados | 530h |
| **D** | Admin Center: 8 mÃ³dulos premium | 635h |
| **E** | Training System: 6 peldaÃ±os certificaciÃ³n | 124h |
| **F** | AI Content Hub: Blog, Newsletter, AI Writing | 340-410h |
| **G** | AI Skills System: EspecializaciÃ³n agentes IA | 200-250h |
| **TOTAL** | **7 bloques, 24 meses** | **~4,500h** |

---

| 2026-02-18 | **48.0.0** | **Auditoria Integridad Planes 20260217 â€” Gaps medium resueltos:** 10 PHPUnit test files para 5 modulos N2 Growth Ready (~100 test methods total). jaraba_funding: OpportunityTrackerServiceTest (11 tests) + BudgetAnalyzerServiceTest (9 tests). jaraba_multiregion: TaxCalculatorServiceTest (17 tests) + ViesValidatorServiceTest (12 tests). jaraba_institutional: ProgramManagerServiceTest + StoFichaGeneratorServiceTest. jaraba_agents: AgentOrchestratorServiceTest (22 tests) + GuardrailsEnforcerServiceTest (24 tests). jaraba_predictive: ChurnPredictorServiceTest (10 tests) + LeadScorerServiceTest (11 tests). ServiciosConecta strict_types 31 files (37/37). CopilotApiController proactive API ComercioConecta. Aprendizaje #97. |
| 2026-02-18 | **47.0.0** | **Auditoria Integridad Planes 20260217 â€” 2 gaps criticos resueltos:** Auditoria de integridad de 4 planes contra codebase. ComercioConecta: `declare(strict_types=1)` anadido a 177 PHP files (compliance 178/178). ServiciosConecta: 6 MJML email templates creados en jaraba_email (onboarding_profesional, activacion, reengagement, upsell_starter, upsell_pro, retention). PB blocks ComercioConecta verificados existentes (11/11). Aprendizaje #96. |
| 2026-02-17 | **46.0.0** | **Plan Elevacion ComercioConecta Clase Mundial v1 â€” Sprint 1-3 completado (6o vertical elevado):** jaraba_comercio_conecta elevado a Clase Mundial (18 fases en 3 sprints). Nuevo modulo anadido al registro seccion 7.1 con 42 Content Entities, 25 Services, 9 Controllers. Tabla 12.3 actualizada con ComercioConecta (18 fases + ServiciosConecta 14 fases). Sprint 1: 14 fases elevacion (FeatureGate, CopilotBridge, Journey, Health, Experiment, 6 MJML, 11 PB). Sprint 2: F6-F9 (28 entidades: orders, portales, search, engagement). Sprint 3: F10 (10 entidades: shipping, POS, admin, analytics). 7 servicios transversales ecosistema_jaraba_core + 18 servicios locales. 178 PHP files. Aprendizaje #95. |
| 2026-02-17 | **45.0.0** | **Plan Elevacion ServiciosConecta Clase Mundial v1 â€” 14 fases, 26/26 paridad (7o vertical):** ServiciosConecta elevado de 5/26 (19.2%) a 26/26 (100%). Modulo actualizado en seccion 7.1 (6 entities, 5 services, Clase Mundial badge, 14 fases detalle, 15 PB, SaaS plans). 8 servicios transversales ecosistema_jaraba_core (FeatureGate, CopilotBridge, EmailSequence, CrossVertical, Journey, HealthScore, CopilotAgent, Experiment). 4 FreemiumVerticalLimit + 8 UpgradeTrigger types + 2 FunnelDefinitions. SCSS compliance (5 Tailwindâ†’var(--ej-*), color-mix). 15 PB templates (11 fix + 4 premium). ReviewService + ReviewServicios entity. Bug fix releaseSlot(). Plan: `20260217-Plan_Elevacion_ServiciosConecta_Clase_Mundial_v1.md`. Aprendizaje #94. |
| 2026-02-17 | **44.0.0** | **N2 MACRO-FASE 3 Growth Ready Platform â€” 5 modulos N2:** jaraba_funding v2 refactorizado (3 entities, 5 services). 4 modulos nuevos anadidos al registro seccion 7.1: jaraba_multiregion (4 entities, 5 services, expansion EU), jaraba_institutional (3 entities, 5 services, FSE/FUNDAE), jaraba_agents (5 entities, 12 services, multi-agente L0-L4), jaraba_predictive (3 entities, 7 services, PredictionBridge PHPâ†’Python). 262 ficheros, 18 entidades, 34 servicios, 80 rutas REST. 77 modulos custom. Aprendizaje #93. |
| 2026-02-17 | **43.0.0** | **JarabaLex Legal Practice Platform Completa â€” FASE A2-C3:** 5 modulos nuevos anadidos al registro seccion 7.1 (jaraba_legal_calendar, jaraba_legal_billing, jaraba_legal_vault, jaraba_legal_lexnet, jaraba_legal_templates). Diagnostico Lead Magnet (LegalLandingController). JarabaLexCopilotAgent 6 modos en jaraba_ai_agents. 15 test files. 73 modulos custom. Aprendizaje #92. |
| 2026-02-17 | **42.0.0** | **Plan Elevacion AgroConecta Clase Mundial v1 â€” 14 fases + 11 PB premium:** AgroConecta elevado a Clase Mundial (14/14 fases). Modulo actualizado en seccion 7.1 (18 Services, Clase Mundial badge, 14 fases detalle). Tabla 12.3 actualizada con AgroConecta (14/14 + detalle 14 fases + PB premium). 7 servicios nuevos (FeatureGate, EmailSequence, CrossVertical, Journey, Health, Experiment, CopilotBridge). 12 FreemiumVerticalLimit + 8 UpgradeTrigger types + 4 FunnelDefinitions. 95 rgbaâ†’color-mix en 16 SCSS. 11 templates PB premium (jaraba_icon, schema.org, FAQ JSON-LD, LocalBusiness). 6 MJML email templates. Aprendizaje #91. |
| 2026-02-16 | **41.0.0** | **FASE A1 jaraba_legal_cases â€” Legal Practice Platform:** Nuevo modulo jaraba_legal_cases anadido al registro seccion 7.1. 4 Content Entities (ClientCase, CaseActivity append-only, ClientInquiry, InquiryTriage). 4 Services, 3 Controllers, 11 API REST endpoints. 2 zero-region page templates. 47 ficheros. Aprendizaje #90. |
| 2026-02-16 | **40.0.0** | **Plan Elevacion JarabaLex v1 â€” 14 Fases Clase Mundial:** jaraba_legal_intelligence elevado de Vertical Independiente a Clase Mundial (14/14 fases). Modulo actualizado en seccion 7.1 (icon checkmark, 10 services, Copilot Agent, FeatureGate, 5 MJML, 3 funnels). Copilot JarabaLex 6 modos anadido a seccion 8.1. Tabla 12.3 actualizada a 14/14 + detalle 14 fases. Aprendizaje #89. |
| 2026-02-16 | **39.0.0** | **Documentation Update â€” 5 Modules Added:** jaraba_tenant_export, jaraba_privacy, jaraba_legal, jaraba_dr, ComplianceAggregatorService aÃ±adidos al registro de modulos seccion 7.1. Reglas ZERO-REGION-001/002/003 en Directrices v39.0.0. Aprendizaje #88. |

> **VersiÃ³n:** 92.0.0 | **Fecha:** 2026-02-28 | **Autor:** IA Asistente


## 15. Registro de Cambios

| Fecha | VersiÃ³n | DescripciÃ³n |
|-------|---------|-------------|
| 2026-02-28 | **92.0.0** | **Sistema de Coherencia Juridica LCIS 9 Capas â€” Validacion Normativa + Anti-Sycophancy + Multi-Turn:** Nuevo ASCII box SISTEMA DE COHERENCIA JURIDICA (LCIS) en seccion 12.6. 9 servicios PHP en `jaraba_legal_intelligence/src/LegalCoherence/`: LegalCoherenceKnowledgeBase (L1, 9 niveles NORMATIVE_HIERARCHY derecho_ue_primarioâ†’circulares, 6 FORAL_LAW_REGIMES, 7 STATE_EXCLUSIVE_COMPETENCES Art.149.1, 30+ NORM_TYPE_PATTERNS regex, pesos authority 0.98-0.20), LegalIntentClassifierService (L2, gate 5 intents LEGAL_DIRECT/IMPLICIT/REFERENCE/COMPLIANCE/NON_LEGAL, scoring keywords con thresholds 0.85/0.15, shortcircuits acciones legales + jarabalex, bonus vertical), NormativeGraphEnricher (L3, authority-aware RAG ranking formula 0.55 semantic + 0.30 authority + 0.15 recency, derogation filter, territory warnings, CCAA competence bonus), LegalCoherencePromptRule (L4, 8+1 reglas R1-R8 + R9 territorial, COHERENCE_PROMPT full + COHERENCE_PROMPT_SHORT, applyWithTerritory() con foral law auto-detection, requiresCoherence()/useShortVersion()), LegalConstitutionalGuardrailService (L5), LegalCoherenceValidatorService (L6, 7 checks: hierarchy_inversion/organic_law/eu_primacy/competence/vigencia/contradiction/sycophancy + antinomies, PENALTIES scoring critical=-0.30 to low=-0.05, action regenerate max 2 retries/block/warn/allow, anti-sycophancy V8 premise validation), LegalCoherenceVerifierService (L7), LegalDisclaimerEnforcementService (L8, non-removable disclaimer, fallback without LegalDisclaimerService, coherence score display threshold 70%), LegalConversationContext (MT, extractAssertions para competencia/primacia/vigencia/reserva_lo/retroactividad/jerarquia, checkCrossTurnCoherence, MAX_TURNS=20, MAX_ASSERTIONS=50). 7 ficheros de test: 149 tests, 277 assertions, 0 errores. EU AI Act compliance HIGH RISK Annex III art.8. 6 reglas nuevas en Directrices v103.0.0. Aprendizaje #153. |
| 2026-02-28 | **91.0.0** | **Unificacion Landing JarabaLex + Despachos â€” 5 Modulos Habilitados + 18 FreemiumVerticalLimit + LexNET + SEO:** Unificacion de `/despachos` en `/jarabalex` via 301 redirect (`Url::fromRoute()`). 5 modulos legales habilitados (jaraba_legal_calendar, jaraba_legal_vault, jaraba_legal_billing, jaraba_legal_lexnet, jaraba_legal_templates). 18 nuevos FreemiumVerticalLimit configs (6 feature_keys Ã— 3 planes: max_cases, vault_storage_mb, calendar_deadlines, billing_invoices_month, lexnet_submissions_month, template_generations_month â€” total 36). JarabaLexFeatureGateService +6 FEATURE_TRIGGER_MAP entries. UpgradeTriggerService +6 trigger types (11 total) con mensajes y iconos. 3 SaasPlan YAMLs actualizados (starter/pro/enterprise con legal modules). jarabalex() reescrito con 8 features (LexNET killer differentiator, expedientes, agenda, facturacion, boveda), 10 FAQs, pain points despacho, pricing preview con limites reales. despachos() convertido a 301 redirect. legalRedirect() actualizado. Megamenu: "Despachos" â†’ "JarabaLex". PageAttachmentsHooks: SEO meta description + Schema.org SoftwareApplication JSON-LD para /jarabalex (RouteMatchInterface inyectado). Theme: landing.legal anadido a $vertical_routes. Fix: 5 controllers PHP 8.4 readonly property conflict con ControllerBase (CONTROLLER-READONLY-001). Fix: VaultApiController syntax error. 2 reglas nuevas en Directrices v102.0.0: LEGAL-LANDING-UNIFIED-001, CONTROLLER-READONLY-001. Aprendizaje #152. |
| 2026-02-28 | **90.0.0** | **Centro de Ayuda Clase Mundial â€” /ayuda con 25 FAQs + Busqueda Unificada FAQ+KB:** Nuevo ASCII box CENTRO DE AYUDA CLASE MUNDIAL en seccion 8.3. Modulo `jaraba_tenant_knowledge` elevado: HelpCenterController refactorizado (getCategoryMeta(), buildFaqPageSchema(), buildBreadcrumbSchema(), buildHelpCenterSeoHead(), getKbArticleCount(), searchApi unificado FAQ+KB). 8 categorias SaaS multi-vertical (getting_started, account, features, billing, ai_copilot, integrations, security, troubleshooting). 25 FAQs seed platform-wide via update_10003 (tenant_id=NULL). Template: hero con trust signals, quick links via Url::fromRoute(), KB cross-link, CTA con botones accionables. Busqueda unificada: FAQ+KB con hasDefinition() guard, slug-based KB URLs, campo type en JSON, JS drupalSettings searchApiUrl. SEO: FAQPage + BreadcrumbList + QAPage JSON-LD, OG/Twitter meta tags, canonical. SCSS: quick-links grid, kb-promo banner, contact buttons, animations con prefers-reduced-motion + no-js fallback. Integracion: jaraba_support (quick links), Knowledge Base (cross-link + busqueda), FAQ Bot widget, footer link. 10 ficheros modificados. Aprendizaje #151. |
| 2026-02-27 | **88.0.0** | **NavegaciÃ³n Ecosistema + Pricing Labels â€” Megamenu Selectivo + formatFeatureLabels():** CorrecciÃ³n de 6 regresiones de navegaciÃ³n del ecosistema: megamenu restringido a SaaS principal via `header_megamenu|default(false)` con inyecciÃ³n PHP selectiva en `preprocess_page()`, megamenu transparente corregido con `var(--header-bg, #ffffff)` fallback, menu items alineados via normalizaciÃ³n button/anchor CSS, barra ecosistema footer activada por defecto con 4 links, mobile overlay condicional por `use_megamenu`, pricing features con labels humanos via `MetaSitePricingService::formatFeatureLabels()` (mapa 28 machine names â†’ labels traducibles, almacenamiento dual features/features_raw). Starter tier con features base default cuando vacÃ­o (basic_profile, community, one_vertical, email_support). 2 reglas: MEGAMENU-CONTROL-001 (P1), PRICING-LABEL-001 (P1). Aprendizaje #149. |
| 2026-02-27 | **87.0.0** | **Demo Vertical PLG 100% Clase Mundial â€” Guided Tour + Storytelling AI + Progressive Disclosure:** Nuevo ASCII box DEMO VERTICAL PLG. Subsistema demo en ecosistema_jaraba_core (~4,000 LOC): DemoController (765 LOC, 8 metodos: landing/start/dashboard/storytelling/playground/regenerate/track/convert), DemoInteractiveService (1,523 LOC, 10 perfiles, metricas sinteticas, session management demo_sessions table, analytics aggregation demo_analytics table, 11 historias por perfil), DemoFeatureGateService (149 LOC, usage tracking), DemoJourneyProgressionService (319 LOC, disclosure levels basicâ†’intermediateâ†’advanced, nudge system), GuidedTourService (demo_welcome 4 pasos, user_completed_tours table). 4 JS libraries self-contained (dashboard chart+tracking+conversion+countdown, guided-tour overlay+spotlight+popovers+keyboard, storytelling fetch+copy+feedback, ai-playground copilot+scenarios+typing). 5 templates + 3 partials DRY. drupalSettings injection chain: demo.sessionId + demoTour (GuidedTourService) + demoStorytelling.regenerateUrl (Url::fromRoute) + demoPlayground.copilotEndpoint (Url::fromRoute). User journey: /demo â†’ profile select â†’ dashboard (tour auto-start) â†’ magic actions â†’ storytelling (AI regenerate) â†’ progressive disclosure â†’ conversion modal â†’ /registro/{vertical}. 24 unit tests, 84 assertions. SCSS _demo.scss 1,180 LOC compilado. 2 reglas nuevas en Directrices v96.0.0: SCSS-COMPILE-VERIFY-001, RUNTIME-VERIFY-001. Aprendizaje #146. |
| 2026-02-27 | **86.0.0** | **jaraba_support Clase Mundial â€” Soporte Omnicanal + SLA Engine + AI Agent + SSE + HMAC Attachments:** Nuevo ASCII box SOPORTE AL CLIENTE CLASE MUNDIAL. Modulo `jaraba_support` implementado completo en 10 fases. Arquitectura: 7 Content Entities (SupportTicket con state machine 6 estados openâ†’in_progressâ†’waiting_customerâ†’resolvedâ†’closed + escalated lateral, TicketMessage, TicketAttachment, TicketWatcher, TicketTag, TicketAiClassification, TicketAiResolution) + 2 Config Entities (SlaPolicy con id {plan_tier}_{priority}, SupportSettings). 18 servicios: TicketService (state machine con VALID_TRANSITIONS + first_responded_at tracking), SlaEngineService (attachSlaToTicket resolve policy â†’ calculateDeadline con BusinessHoursService, processSlaCron check breached/warned), BusinessHoursService (loadSchedule desde ConfigEntity, isDayInSchedule timezone-aware, isHoliday, addBusinessHours minuto a minuto con max 365 iteraciones), TicketRoutingService (multi-factor scoring: skills +50, vertical +30, workload inversely proportional +20, experience bonus +15 para critical/high), AttachmentService (upload con FileSystemInterface::saveData, validation MIME/extension/size/double-extension 16 dangerous exts), AttachmentScanService (ClamAV nSCAN via unix socket + 4-layer heuristic fallback: dangerous ext, double-ext, suspicious content 8KB, MIME mismatch), AttachmentUrlService (HMAC SHA-256 signed URLs base64 JSON token 1h expiry, 3-tier auth admin/reporter/assignee, BinaryFileResponse con security headers), TicketNotificationService (5 metodos: created/newMessage/slaWarning/slaBreached escalation/resolved con CSAT link), TicketMergeService (transferencia mensajes/adjuntos/watchers con duplicate detection + system message), CsatSurveyService (schedule 1h delay, submit 1-5 clamp, low satisfaction warning), SupportHealthScoreService (5 componentes: volume trend, SLA compliance, CSAT, escalation rate, resolution speed, churn alert <40), TicketStreamService (DB-backed SSE con support_ticket_events, agent+watcher ticket merging, viewer registration), SupportCronService (5 tareas: SLA/scans/auto-close 7d/CSAT surveys/purge 24h), SupportAgentSmartAgent (Gen 2, 5 acciones fast/balanced/premium). SupportApiController 12+ endpoints REST. SupportStreamController SSE. hook_schema 2 tablas auxiliares + update_10001. 22 unit tests / 111 assertions. Aprendizaje #145. |
| 2026-02-27 | **85.0.0** | **Sprint 5 IA Clase Mundial 100/100 â€” Gen2 Complete + SemanticCache + MultiModal + CWV + Locking:** Auditoria IA 30/30 completada (score 100/100). 11 agentes Gen 2 (0 Gen 1 remaining): SmartMarketing, Storytelling, CustomerExperience, Support, ProducerCopilot, Sales, MerchantCopilot, SmartEmployabilityCopilot, SmartLegalCopilot, SmartContentWriter + LearningPathAgent (jaraba_lms). Nuevos servicios: AgentBenchmarkService (golden datasets + AgentBenchmarkResult entity), PromptVersionService + PromptTemplate ConfigEntity (versioning + rollback), BrandVoiceProfile ContentEntity (per-tenant brand voice persistence), PersonalizationEngineService (6 source orchestration). SemanticCache integrado en CopilotOrchestrator (GET before LLM, SET after). MultiModalBridgeService COMPLETE: analyzeImage (GPT-4o Vision), transcribeAudio (Whisper), synthesizeSpeech (TTS-1/TTS-1-HD), generateImage (DALL-E 3). Page Builder concurrent edit locking: optimistic locking via `changed` + X-Entity-Changed, edit_lock_uid/edit_lock_expires fields, 3 API endpoints acquire/release/status, JS heartbeat. CWV: 7 CSS bundles (code splitting), cwv-tracking.js PerformanceObserver (LCP/CLS/INP/FCP/TTFB), fetchpriority="high" 10 hero templates, AVIF+WebP responsive images, responsive_image() Twig function. |
| 2026-02-27 | **84.0.0** | **DOC-GUARD + Kernel Test Resilience + jaraba_workflows:** Nuevo ASCII box WORKFLOW AUTOMATION ENGINE en seccion 7.1. Modulo `jaraba_workflows` (S4-04) documentado: WorkflowRule entity (trigger-based actions), WorkflowExecutionService (event_dispatcher + observability opcional), 15 ficheros. Fix Kernel tests: servicios AI cross-module (`@ai.provider`, `@jaraba_ai_agents.*`) cambiados a `@?` (optional) en jaraba_content_hub + jaraba_lms para prevenir ServiceNotFoundException. ContentWriterAgent + ContentEmbeddingService con constructores nullable. Regla KERNEL-OPTIONAL-AI-001 en Directrices v91.0.0. DOC-GUARD-001: pre-commit hook + CI verification de umbrales de documentos maestros. Aprendizaje #142. |
| 2026-02-27 | **81.0.0** | **Reviews & Comments Clase Mundial â€” AuditorÃ­a + Plan ConsolidaciÃ³n 10 Verticales:** Nuevo ASCII box REVIEWS & COMMENTS CLASE MUNDIAL. AuditorÃ­a exhaustiva de 4 sistemas de calificaciones heterogÃ©neos (comercio_review, review_agro, review_servicios, session_review) con 20 hallazgos: 4 seguridad (tenant_id apunta a taxonomy en vez de group, 2 entidades sin tenant_id), 5 bugs (campo $text indefinido, clase inexistente, entidad reading_history inexistente, hook_cron ausente, bÃºsqueda pÃºblica ausente), 4 arquitectura (duplicaciÃ³n de cÃ³digo en 3 servicios, nomenclatura inconsistente status/state, Q&A sin respuesta de provider, lÃ³gica de negocio en controladores), 3 directrices (presave sin hasService, slug hardcoded, accessCheck ausente), 4 brechas clase mundial (sin Schema.org AggregateRating, sin frontend visual, sin moderaciÃ³n IA, sin invitaciones post-transacciÃ³n). Plan de implementaciÃ³n con ReviewableEntityTrait (5 campos compartidos + helpers con fallback), 5 servicios transversales (moderation, aggregation, schema.org, invitation, AI summary), 2 entidades nuevas (course_review para LMS, content_comment para Content Hub threading), 6 Twig partials, 350+ lÃ­neas SCSS, star-rating.js widget, GrapesJS review-block plugin. Cobertura de 10 verticales canÃ³nicos: comercioconecta, agroconecta, serviciosconecta, mentoring, formacion, jaraba_content_hub + empleabilidad, emprendimiento, jarabalex, andalucia_ei (extensibles). 3 reglas nuevas: REVIEW-TRAIT-001, REVIEW-MODERATION-001, SCHEMA-AGGREGATE-001. Aprendizaje #140. |
| 2026-02-26 | **79.0.0** | **RemediaciÃ³n de Secretos â€” SECRET-MGMT-001 + git-filter-repo:** Nuevo ASCII box GESTIÃ“N DE SECRETOS. Arquitectura de 3 capas: (1) config/sync/ con YAML sanitizados (valores vacÃ­os para campos sensibles), (2) config/deploy/settings.secrets.php con 14 $config overrides desde getenv() (OAuth Google/LinkedIn/Microsoft, SMTP IONOS, reCAPTCHA v3, Stripe), (3) variables de entorno (.env local gitignored + Lando env_file injection, panel hosting producciÃ³n). Flujo config:import/export seguro: YAML vacÃ­os â†’ BD â†’ $config override runtime-only â†’ export nunca expone secretos. Limpieza historial git con git-filter-repo --blob-callback (10 secretos eliminados de 459 commits, force push). 1 regla nueva: SECRET-MGMT-001 (P0). Aprendizaje #138. |
| 2026-02-27 | **83.0.0** | **Reviews & Comments Clase Mundial â€” Sprint 11: 18/18 Brechas Implementadas (ElevaciÃ³n 55%â†’80%+):** 18 brechas en 3 sprints. Sprint 11.1 Table Stakes: ReviewHelpfulnessService (Wilson Lower Bound z=1.96), ReviewApiController (filtering/sorting/owner response), verified purchase badges. Sprint 11.2 Differentiators: ReviewAnalyticsService + ReviewAnalyticsDashboardController (Chart.js trend/doughnut), photo gallery (lightbox JS), FakeReviewDetectionService (jaraba_ai_agents, multi-signal scoring), ReviewSeoController (JSON-LD + microdata + pagination), ReviewSentimentService (presave hook), ReviewTenantSettings ConfigEntity (18 campos configurables per-tenant), ReviewNotificationService (presave hooks). Sprint 11.3 ConsolidaciÃ³n: ReviewTranslationService (language detection ES/EN/PT-BR), ReviewGamificationService (6 actions, 5 tiers bronzeâ†’diamond, 6 badges, leaderboard, self-creating tables), ReviewImportExportService (CSV/JSON), ReviewAbTestService (5 experiments, consistent hashing crc32), ReviewVideoService (MIME validation 100MB), ReviewPublicApiController (3 GET endpoints, max 50/page, approved-only), ReviewWebhookService (6 event types, HMAC sha256 signatures, queue-based async delivery, max 3 retries). Entity lifecycle hooks en ecosistema_jaraba_core.module: presave (sentiment + fake detection enrichment), insert (aggregation + notification + gamification + webhook), update (aggregation + status change + webhook). update_9021 para tablas gamification/AB/webhook. 14 nuevos servicios + 4 controladores + 1 ConfigEntity + review-analytics.js + review-seo-page.html.twig. 7 test files nuevos (44 tests). Total suite: 3.342 tests / 0 errores. Aprendizaje #141. |
| 2026-02-27 | **82.0.0** | **Reviews & Comments Clase Mundial â€” Implementacion Completa 10 Fases + 18 Brechas:** Nuevo ASCII box REVIEWS SYSTEM ARCHITECTURE. ReviewableEntityTrait compartido (5 campos + 8 metodos) aplicado a 6 entidades en 4 verticales. 2 entidades nuevas: CourseReview (jaraba_formacion), ContentComment (jaraba_content_hub). 5 servicios transversales en ecosistema_jaraba_core: ReviewModerationService (6 entity types, STATUS_FIELD_MAP), ReviewAggregationService (RATING/TARGET/STATUS_FIELD_MAP, cache tags, denormalizacion), ReviewSchemaOrgService (JSON-LD AggregateRating + ReviewList). 2 servicios en jaraba_ai_agents: ReviewAiSummaryService (ModelRouterService fast tier), ReviewInvitationService (templates MJML). Frontend: page--reviews.html.twig + 5 parciales + _reviews.scss (design tokens) + star-rating.js. GrapesJS Review Widget Block. Schema.org SEO con JSON-LD. Security: tenant_id entity_referenceâ†’group, access handlers DI, CSRF. 68 unit tests (PHPUnit 11 + PHP 8.4 patterns). Auditoria post-implementacion: 55% cobertura (target 80%+). 18 brechas en Fase 11 (156-218h). Aprendizaje #140. |
| 2026-02-26 | **78.0.0** | **Meta-Sitios Analytics Stack â€” GTM/GA4 + A/B Testing + i18n Hreflang + Heatmap:** Nuevo bloque arquitectonico "META-SITES ANALYTICS STACK (4 CAPAS)": (1) Conversion Tracking con 6 behaviors dataLayer, (2) A/B Testing frontend con cookies y DOM manipulation, (3) Heatmap con jaraba_heatmap/tracker, (4) GTM/GA4 con Consent Mode v2 GDPR. SEO internacional con hreflang ES/EN/x-default. PWA preexistente verificada. 4 librerias condicionadas con meta_site. 5 reglas nuevas en Directrices v83.0.0. |
| 2026-02-26 | **77.0.0** | **Auditoria IA Clase Mundial â€” 25 Gaps hacia Paridad con Lideres del Mercado:** Nuevo ASCII box AUDITORIA IA CLASE MUNDIAL. 25 gaps auditados contra Salesforce Agentforce, HubSpot Breeze, Shopify Sidekick, Intercom Fin. 7 refinamiento (Onboarding AI, Pricing Metering, Demo Playground, Dashboard GEO, llms.txt MCP, Schema.org GEO, Dark Mode AI) + 16 nuevos (Command Bar Cmd+K con CommandRegistryService tagged services, Inline AI con SmartBaseAgent fast tier + sparkle buttons, Proactive Intelligence ContentEntity + QueueWorker cron, Voice AI Web Speech API client-side, A2A Protocol extending MCP JSON-RPC 2.0 con Agent Card /.well-known/agent.json, Vision/Multimodal MultiModalBridgeService implementacion, 40+ unit + 15+ kernel + 7 prompt regression tests, Blog slugs ParamConverter + ContentArticle tenant_id, 5 vertical AI: SkillInferenceService + AdaptiveLearningService AI activation + DemandForecastingService + GrapesJS AI Writer + ServiceMatchingService Qdrant wiring, Design System ComponentDocumentationController) + 2 infraestructura (Cost Attribution AIObservabilityâ†’TenantMetering, Horizontal Scaling Redis worker pool). 4 sprints, 320-440h. Plan: `docs/implementacion/2026-02-26_Plan_Implementacion_Auditoria_IA_Clase_Mundial_v1.md`. Aprendizaje #134. |
| 2026-02-26 | **76.0.0** | **AI Elevation 10 GAPs â€” Streaming Real + MCP Server + Native Tools:** Nuevo ASCII box AI ELEVATION 10 GAPs. GAP-01: StreamingOrchestratorService extiende CopilotOrchestratorService, ChatInput::setStreamedOutput(TRUE) para streaming real, PHP Generator con eventos chunk/cached/done/error, buffer 80 chars + PII masking incremental. GAP-09: ToolRegistry::generateNativeToolsInput() convierte a ToolsInput/ToolsFunctionInput/ToolsPropertyInput, SmartBaseAgent::callAiApiWithNativeTools() con ChatInput::setChatTools(), fallback a text-based. GAP-08: McpServerController POST /api/v1/mcp JSON-RPC 2.0 con initialize/tools-list/tools-call/ping, MCP 2025-11-25. GAP-02: TraceContextService trace_id UUID + span_id. GAP-03/10: Buffer PII masking cross-chunk. GAP-07: AgentLongTermMemoryService Qdrant + BD. 3 ficheros nuevos + 4 modificados. 7 reglas nuevas. Aprendizaje #133. |
| 2026-02-26 | **75.0.0** | **AI Remediation Plan â€” 28 Fixes, 3 Phases:** Nuevo ASCII box AI REMEDIATION STACK. Fase 1 (P0): AIIdentityRule clase estatica centralizada, brand voice fallback, guardrails pipeline ALLOW/MODIFY/BLOCK/FLAG, SmartBaseAgent contrato restaurado (routing+observability+guardrails), CopilotOrchestratorService 8 modos reales, streaming SSE con MIME correcto y eventos tipados, AgentOrchestrator simplificado, feedback loop con threshold. Fase 2 (P1): RAG prompt injection filter, embedding cache, A/B testing framework, tenant brand voice YAML, content approval workflow entity, campaign calendar entity, performance dashboard, Qdrant graceful fallback, auto-disable por error rate, vertical context normalizado. Fase 3 (P2): ModelRouterService con regex bilingue EN+ES (FIX-019), model pricing a YAML config con schema (FIX-020), observability conectada en BrandVoiceTrainer+WorkflowExecutor (FIX-021), AIOpsService con metricas reales /proc+BD (FIX-022), feedback widget JSâ†”PHP alineado (FIX-023), streaming semantico por parrafos (FIX-024), Gen 0/1 agents documentados (FIX-025), @? UnifiedPromptBuilder optional DI (FIX-026), canonical verticals 10 nombres (FIX-027), PII espanol DNI/NIE/IBAN/NIF/+34 (FIX-028). 55 ficheros, +3678/-236 lineas. 5 reglas nuevas. Regla de oro #45. Aprendizaje #127. |
| 2026-02-25 | **74.0.0** | **Premium Forms Migration 237 + USR-004 User Edit Redirect:** Nuevo ASCII box PREMIUM ENTITY FORMS. `PremiumEntityFormBase` como clase abstracta estandar para todos los formularios de entidad (237 forms en 50 modulos). 4 patrones de migracion (A: Simple, B: Computed, C: DI, D: Custom Logic). Glass-card UI con navigation pills y sticky action bar. SCSS `_premium-forms.scss`. 0 `ContentEntityForm` restantes en modulos custom. Fix USR-004: redirect de `/user/{id}/edit` a perfil canonico tras save. Regla PREMIUM-FORMS-PATTERN-001 (P1). Aprendizaje #125. |
| 2026-02-26 | **79.0.0** | **Meta-Sitios MultilingÃ¼e â€” i18n EN+PT-BR + Language Switcher:** Nuevo soporte multilingÃ¼e completo para los 3 meta-sitios. PageContent entity ya es `translatable = TRUE` â€” modulo `jaraba_i18n` con `AITranslationService` (translateBatch/translateEntity con brand voice) y `TranslationManagerService` (createTranslation, stats, dashboard) como infraestructura existente. Script `translate-metasite-pages.php` crea traducciones batch: 46 traducciones generadas (EN para pepejaraba+jarabaimpact+PED, PT-BR para jarabaimpact). Manejo especial de canvas_data (GrapesJS JSON â†’ extraer components[].content + attributes, traducir, re-ensamblar), content_data (JSON recursivo con skip patterns para IDs/URLs/colores), rendered_html (regex text nodes â†’ batch translate â†’ replace). Hreflang dinamico: `_hreflang-meta.html.twig` itera `available_languages` (inyectado desde preprocess_html via `getTranslationLanguages()`). Language Switcher: `_language-switcher.html.twig` dropdown glassmorphism con banderas emoji, `language-switcher.js` (toggle/ESC/arrow keys), SCSS con dark variant + responsive. Preprocess hook inyecta `available_languages` + `current_langcode` en PageContent meta-site context. PT-BR: `drush language:add pt-br` â†’ 12.038 traducciones Drupal importadas. 2 reglas nuevas en Directrices v87.0.0. Aprendizaje #139. |
| 2026-02-25 | **73.0.0** | **Meta-Site Icon Emoji Remediation + PathProcessor Enhancement:** Icon System: nueva categoria `business/` con 12 SVGs (6 conceptuales + 6 duotone) para meta-sitio pepejaraba.com. 11 emojis Unicode eliminados de canvas_data (4 paginas). Seccion Icon System ampliada: categorias verticales, auditoria canvas_data, reglas ICON-EMOJI-001 + ICON-CANVAS-INLINE-001. PathProcessor: prioridad actualizada a 250, nuevo `resolveHomepage()` con MetaSiteResolverService. MetaSiteResolverService: 3-strategy domain resolution (Domain Access + Tenant.domain + subdomain prefix) documentada. Meta-sitio pepejaraba.com (9 paginas) anadido junto a jarabaimpact.com. Aprendizaje #124. |
| 2026-02-25 | **72.0.0** | **Elevacion Empleabilidad + Andalucia EI Plan Maestro + Meta-Site Rendering:** 3 ASCII boxes nuevos. Empleabilidad: CandidateProfileForm premium con 6 secciones, ProfileSectionForm generico CRUD, photo entity_referenceâ†’image, date timestampâ†’datetime, 5 CV PNGs, seccion idiomas, ProfileCompletionService con entity queries. Andalucia EI Plan Maestro 8 fases: P0/P1 fixes, 11 bloques PB verticales, landing conversion, portal participante, ExpedienteDocumento (19 categorias), mensajeria integration, AI automation (CopilotContextProvider + AdaptiveDifficultyEngine + 4 nudges), SEO. Meta-Site: MetaSiteResolverService, Schema.org tenant-aware, title tag override, header/footer/nav desde SiteConfig. CRM: 5 forms a PremiumEntityFormBase. 71+ ficheros. Aprendizaje #123. |
| 2026-02-25 | **71.0.0** | **Remediacion Tenant 11 Fases:** 2 ASCII boxes nuevos: TENANT BRIDGE (TenantBridgeService con 4 metodos, consumidores, error handling, regla TENANT-BRIDGE-001) y TENANT ISOLATION (PageContentAccessControlHandler con DI + isSameTenant(), DefaultEntityAccessControlHandler rename, PathProcessor tenant-aware, TenantContextService enhanced nullable). 14 correcciones billing entity type en 6 ficheros. CI pipeline con kernel-test job (MariaDB 10.11). 5 tests nuevos. Scripts movidos a scripts/maintenance/. Reglas TENANT-BRIDGE-001, TENANT-ISOLATION-ACCESS-001, CI-KERNEL-001. Aprendizaje #122. |
| 2026-02-24 | **70.0.0** | **Meta-Sitio jarabaimpact.com â€” PathProcessor + Content:** Nuevo `PathProcessorPageContent` (InboundPathProcessorInterface, prioridad 200) para resolver path_alias de entidades PageContent a rutas /page/{id}. 7 pÃ¡ginas institucionales creadas y publicadas con contenido en espaÃ±ol via GrapesJS. APIs: PATCH /config (tÃ­tulos + aliases), POST /publish (publicaciÃ³n), GrapesJS store (contenido). Regla PATH-ALIAS-PROCESSOR-001. Aprendizaje #120. |
| 2026-02-24 | **69.0.0** | **Auditoria Horizontal â€” Strict Equality + CAN-SPAM MJML:** Primera auditoria cross-cutting del SaaS. 52 instancias de `==` reemplazadas por `(int) === (int)` en 39 access handlers de 21 modulos (ACCESS-STRICT-001). 28 plantillas MJML horizontales con compliance CAN-SPAM completo: mj-preview, postal Juncaril, font Outfit, paleta de marca unificada (#1565C0 como azul primario, 6 colores universales reemplazados). Colores semanticos preservados. Secciones de arquitectura: Access Handlers + Email CAN-SPAM. 5 reglas nuevas. Aprendizaje #119. |
| 2026-02-24 | **68.0.0** | **Empleabilidad Profile Premium â€” Fase Final:** Nueva entidad `CandidateEducation` (ContentEntity completa con AdminHtmlRouteProvider, field_ui_base_route, 6 rutas admin, SettingsForm, update hook 10002). Fix XSS `\|raw` â†’ `\|safe_html` en template de perfil premium. Controller fallback cleanup â†’ render array con template premium. Seccion de arquitectura Empleabilidad documentada (6 entidades, 7 secciones glassmorphism, ProfileController resiliente). 3 ficheros creados, 6 modificados. Aprendizaje #118. |
| 2026-02-24 | **67.0.0** | **Entity Admin UI Remediation Complete:** 286 entidades auditadas, 175 Field UI tabs, CI 100% green. |
| 2026-02-24 | **66.0.0** | **Icon System â€” Zero Chinchetas:** Sistema de iconos `jaraba_icon()` auditado y completado. 305 pares unicos verificados en todo el codebase con 0 chinchetas restantes. ~170 SVGs/symlinks nuevos en 8 bridge categories. 32 llamadas con convencion rota corregidas en 4 modulos (jaraba_interactive, jaraba_i18n, jaraba_facturae, jaraba_resources). 177 templates Page Builder verificados. 2 symlinks circulares y 1 roto reparados. Reglas ICON-CONVENTION-001, ICON-DUOTONE-001, ICON-COLOR-001. |
| 2026-02-23 | **64.0.0** | **Andalucia +ei Launch Readiness:** Correccion de 8 incidencias bloqueantes para la 2a edicion. Fix critico: `{{ messages }}` en template de solicitud (formulario tragaba errores silenciosamente). 6 emojis reemplazados por `jaraba_icon()`. 5 rutas nuevas para paginas legales/informativas (`/politica-privacidad`, `/terminos-uso`, `/politica-cookies`, `/sobre-nosotros`, `/contacto`). Controladores con `theme_get_setting()` para contenido configurable. 3 templates zero-region. Footer con URLs canonicas en espanol. Badge "6 verticales" corregido. TAB 14 en theme settings para contenido legal. 13 ficheros modificados. Reglas FORM-MSG-001, LEGAL-ROUTE-001, LEGAL-CONFIG-001. Aprendizaje #110. |
| 2026-02-23 | **63.0.0** | **AI Identity Enforcement + Competitor Isolation:** Blindaje de identidad IA implementado en toda la plataforma. `BaseAgent.buildSystemPrompt()` inyecta regla de identidad como parte #0 (heredada por 14+ agentes). `CopilotOrchestratorService` antepone `$identityRule` a los 8 modos. `PublicCopilotController` incluye bloque IDENTIDAD INQUEBRANTABLE. Servicios standalone (FaqBotService, ServiciosConectaCopilotAgent, CoachIaService) con regla manual. Eliminadas 5 menciones de competidores en prompts de IA. 12 archivos modificados. Reglas AI-IDENTITY-001, AI-COMPETITOR-001. |
| 2026-02-23 | **62.2.0** | **Sticky Header Global:** `.landing-header` migrado de `position: fixed` a `position: sticky` por defecto. Solo `body.landing-page`/`body.page-front` mantienen `fixed`. Eliminados padding-top compensatorios fragiles de `.main-content`, `.user-main`, `.error-page`. Toolbar admin ajustado globalmente (`top: 39px/79px`). 4 archivos SCSS modificados. Regla CSS-STICKY-001. |
| 2026-02-23 | **62.0.0** | **Precios Configurables v2.1:** 2 ConfigEntities (`SaasPlanTier` + `SaasPlanFeatures`) como fuente de verdad para tiers, features y limites. `PlanResolverService` broker central con cascade especificoâ†’defaultâ†’NULL. Integracion en QuotaManagerService, PlanValidator y BillingWebhookController. 21 seed YAMLs + update hook 9019. Admin UI en `/admin/config/jaraba/plan-tiers` y `plan-features`. Drush command `jaraba:validate-plans`. 14 archivos nuevos + 11 editados. |
| 2026-02-20 | **61.0.0** | **Secure Messaging Implementado (Doc 178):** Modulo `jaraba_messaging` implementado al completo con 104 archivos. 4 entidades PHP (SecureConversation + ConversationParticipant ContentEntities, SecureMessage + MessageAuditLog custom tables), 3 modelos (SecureMessageDTO readonly, EncryptedPayload, IntegrityReport), 18 servicios + 7 access checks, 7 controladores REST, 4 WebSocket (Ratchet server + ConnectionManager + MessageHandler + AuthMiddleware), 8 ECA plugins (3 eventos + 3 condiciones + 2 acciones), 9 Twig templates (zero-region), 11 SCSS + 4 JS. Cifrado AES-256-GCM server-side + Argon2id KDF. SHA-256 hash chain audit. RGPD Art.20 export. Cursor-based pagination. |
| 2026-02-20 | 60.0.0 | **Secure Messaging Plan (Doc 178):** Plan de implementacion para `jaraba_messaging`. 64+ archivos planificados en 6 sprints. |
| 2026-02-20 | 59.0.0 | **ServiciosConecta Sprint S3 â€” Booking Engine Operativo:** Fix critico de `createBooking()` API (field mapping booking_date/offering_id/uid, validaciones provider activo+aprobado, offering ownership, advance_booking_min, client data, price, meeting_url Jitsi). Implementacion de `isSlotAvailable()`, `markSlotBooked()` y `hasCollision()` (refactored) en AvailabilityService. Fix `updateBooking()` state machine (cancelled_client/cancelled_provider, role enforcement provider-only para confirm/complete/no_show). Fix cron reminder duplicates (flags reminder_24h_sent/reminder_1h_sent). Fix hook_entity_update (booking_date, getOwnerId, cancelled_ prefix). 3 archivos modificados, 0 nuevos. |
| 2026-02-20 | 58.0.0 | **Vertical Retention Playbooks (Doc 179):** Implementacion completa del motor de retencion verticalizado en `jaraba_customer_success`. 2 entidades nuevas (VerticalRetentionProfile con 16 campos JSON, SeasonalChurnPrediction append-only), 2 servicios (VerticalRetentionService con evaluacion estacional, SeasonalChurnService con predicciones ajustadas), 7 endpoints API REST, dashboard FOC con heatmap, 5 perfiles verticales con calendarios de 12 meses, QueueWorker cron. 25 archivos nuevos + 11 modificados. |
| 2026-02-20 | 57.0.0 | **Page Builder Preview Audit:** AuditorÃ­a completa de los 4 escenarios del Page Builder (Biblioteca, Canvas Editor, Canvas Insert, PÃ¡gina PÃºblica). 66 imÃ¡genes de preview premium glassmorphism 3D generadas y desplegadas para 6 verticales (AgroConecta 11, ComercioConecta 11, Empleabilidad 11, Emprendimiento 11, ServiciosConecta 11, JarabaLex 11). Inventario: 219 bloques, 31 categorÃ­as, 4 duplicados detectados. |
| 2026-02-20 | 56.0.0 | **Gemini Remediation:** Auditoria y correccion de ~40 archivos. Restauracion de seguridad CSRF en APIs Copilot (patron `_csrf_request_header_token`), fix XSS en Twig (`\|safe_html`), PWA meta tags duales, TranslatableMarkup cast, role check granular, email XSS escape. Stack de seguridad API reforzado. |
| 2026-02-18 | 55.0.0 | **Page Builder Template Consistency:** 129 templates resynced con preview_image, metadatos corregidos, preview_data rico para 55 verticales. Pipelines Canvas Editor y Template Picker unificados (status filter, icon keys, default category). Update hook 9006 aplicado. Fix de `applyUpdates()` eliminado en Drupal 10+ para Legal Intelligence. |
| 2026-02-18 | 54.0.0 | **CI/CD Hardening:** CorrecciÃ³n de trivy.yaml (claves `scan.skip-dirs`), deploy resiliente con fallback SSH. Security Scan y Deploy en verde. |
| 2026-02-18 | 53.0.0 | **The Unified & Stabilized SaaS:** ConsolidaciÃ³n final de las 5 fases. ImplementaciÃ³n del Stack de Cumplimiento Fiscal N1. EstabilizaciÃ³n masiva de 370+ tests unitarios. |
| 2026-02-18 | 52.0.0 | **The Living SaaS:** Lanzamiento de los Bloques O y P. Inteligencia ZKP con Privacidad Diferencial e Interfaz Adaptativa (Ambient UX). |

> **VersiÃ³n:** 92.0.0 | **Fecha:** 2026-02-28 | **Autor:** IA Asistente
