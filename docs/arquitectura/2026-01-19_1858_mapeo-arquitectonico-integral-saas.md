# üèõÔ∏è MAPEO ARQUITECT√ìNICO INTEGRAL
## Jaraba Impact Platform SaaS

**Fecha de creaci√≥n:** 2026-01-19 18:58  
**√öltima actualizaci√≥n:** 2026-01-19 18:58  
**Autor:** IA Asistente (Antigravity - An√°lisis Multi-Perspectiva)  
**Versi√≥n:** 1.0.0  

---

## üìë Tabla de Contenidos (TOC)

1. [Resumen Ejecutivo](#1-resumen-ejecutivo)
2. [Arquitectura de Negocio](#2-arquitectura-de-negocio)
3. [Arquitectura T√©cnica](#3-arquitectura-t√©cnica)
4. [Arquitectura Funcional](#4-arquitectura-funcional)
5. [Arquitectura de Inteligencia Artificial](#5-arquitectura-de-inteligencia-artificial)
6. [Arquitectura de Experiencia de Usuario](#6-arquitectura-de-experiencia-de-usuario)
7. [Arquitectura SEO/GEO](#7-arquitectura-seogeo)
8. [Verticales de Negocio](#8-verticales-de-negocio)
9. [Estado de Madurez y Roadmap](#9-estado-de-madurez-y-roadmap)
10. [Registro de Cambios](#10-registro-de-cambios)

---

## 1. Resumen Ejecutivo

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   üå± JARABA IMPACT PLATFORM                                                  ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ   "La primera plataforma de comercio dise√±ada para que                       ‚îÇ
‚îÇ    la Inteligencia Artificial venda tus productos"                           ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ   Productores Locales  ‚îÄ‚îÄ‚ñ∂  Plataforma AI-First  ‚îÄ‚îÄ‚ñ∂  Consumidores           ‚îÇ
‚îÇ   üßë‚Äçüåæ ü´í üç∑ üßÄ                 ü§ñ üíª üìä               üë• üõí üíö                ‚îÇ
‚îÇ                                                                              ‚îÇ
‚îÇ   NIVEL DE MADUREZ: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 5.0/5.0 CERTIFICADO                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 1.1 Prop√≥sito de la Plataforma
Jaraba Impact Platform es una plataforma SaaS multi-tenant que conecta productores locales con consumidores conscientes, utilizando inteligencia artificial para comercializaci√≥n automatizada, certificaci√≥n digital con trazabilidad y optimizaci√≥n para motores de IA (GEO).

### 1.2 M√©tricas Clave del Sistema

| Dimensi√≥n | M√©tricas |
|-----------|----------|
| **M√≥dulos Custom** | 13 m√≥dulos (618+ archivos) |
| **Entidades de Negocio** | 45+ Content Entities |
| **Agentes IA** | 10+ agentes especializados |
| **Verticales** | 2 activas (Empleabilidad, Emprendimiento) |
| **Plan SaaS** | 3 tiers (B√°sico, Profesional, Enterprise) |

---

## 2. Arquitectura de Negocio

### 2.1 Modelo de Negocio SaaS

```mermaid
graph TD
    subgraph "Capa de Plataforma"
        P[Jaraba Platform] --> V1[Vertical: AgroConecta]
        P --> V2[Vertical: Empleabilidad]
        P --> V3[Vertical: Emprendimiento]
    end
    
    subgraph "Capa de Tenants"
        V1 --> T1[Tenant: Aceites del Sur]
        V1 --> T2[Tenant: Vinos de Jerez]
        V2 --> T3[Tenant: Portal Empleo Madrid]
        V3 --> T4[Tenant: Incubadora Andaluc√≠a]
    end
    
    subgraph "Capa de Productores/Usuarios"
        T1 --> PR1[Productores]
        T3 --> C1[Candidatos]
        T4 --> E1[Emprendedores]
    end
```

### 2.2 Jerarqu√≠a Multi-Tenant

| Nivel | Entidad | Prop√≥sito |
|-------|---------|-----------|
| **1. Plataforma** | `Jaraba Platform` | Infraestructura core compartida |
| **2. Vertical** | `Vertical` Entity | Segmento de negocio (AgroConecta, Empleabilidad) |
| **3. Tenant** | `Tenant` Entity | Organizaci√≥n cliente (Cooperativa, D.O., Portal) |
| **4. Usuario Final** | `Productor` / `Candidate` | Usuarios operativos dentro del tenant |

### 2.3 Planes SaaS

| Plan | Productores | Almacenamiento | Features |
|------|-------------|----------------|----------|
| **B√°sico** | Hasta 5 | 1 GB | Tienda b√°sica, 1 Agente IA |
| **Profesional** | Hasta 25 | 10 GB | Multi-tienda, 5 Agentes IA, Analytics |
| **Enterprise** | Ilimitado | 100 GB | API completa, Firma FNMT, Blockchain |

### 2.4 Estrategia PLG (Product-Led Growth)

| Fase | Componentes |
|------|-------------|
| **A: Onboarding (<60s TTV)** | Diagn√≥stico Express, Clasificaci√≥n Intent IA, UX Adaptativo |
| **B: Expansion** | Usage Signals, Automated Upselling, Referral Loops |
| **C: Monetizaci√≥n** | Outcome-Based Pricing, Resource Metering, ROI Dashboards |

---

## 3. Arquitectura T√©cnica

### 3.1 Stack Tecnol√≥gico

| Capa | Tecnolog√≠a | Versi√≥n |
|------|------------|---------|
| **Backend** | Drupal | 11.3.2 |
| **Runtime** | PHP | 8.4.15 |
| **E-commerce** | Commerce | 3.x |
| **Pagos** | Stripe Connect | v13.0 |
| **Base de Datos** | MariaDB | 10.11 LTS |
| **Cache** | Redis | 7.x |
| **Vector DB** | Qdrant | 1.16 |
| **AI Providers** | OpenAI, Anthropic, Google | GPT-4o, Claude 3.5, Gemini |

### 3.2 Arquitectura de M√≥dulos Custom

| M√≥dulo | Archivos | Prop√≥sito |
|--------|----------|-----------|
| `ecosistema_jaraba_core` | 293 | Core multi-tenant, entidades, contexto |
| `jaraba_candidate` | 36 | Perfiles profesionales, CV Builder |
| `jaraba_commerce` | 7 | Commerce 3.x + Stripe Connect |
| `jaraba_diagnostic` | 31 | Diagn√≥sticos de negocio/candidato |
| `jaraba_foc` | 34 | Financial Operations Center |
| `jaraba_geo` | 12 | Geolocalizaci√≥n (Est√°ndar 28.31) |
| `jaraba_job_board` | 57 | ATS, Matching, Employer management |
| `jaraba_lms` | 47 | LMS, Enrollment, Video, xAPI |
| `jaraba_matching` | 18 | Hybrid Matching Engine (Qdrant + Rules) |
| `jaraba_mentoring` | 25 | Marketplace de mentor√≠a, Jitsi |
| `jaraba_paths` | 27 | Itinerarios de digitalizaci√≥n |
| `jaraba_rag` | 24 | RAG Knowledge Base, Qdrant |
| `jaraba_social_commerce` | 7 | Social feeds, Make.com |

### 3.3 Modelo Multi-Tenant

> **Arquitectura**: Single-Instance + Group Module + Domain Access
> 
> Multisite est√° **expl√≠citamente prohibido** para mantener efectos de red, queries cruzadas y mantenimiento simplificado.

### 3.4 Servicios Core del Framework

| Servicio | Responsabilidad |
|----------|-----------------|
| `TenantContextService` | Resoluci√≥n de identidad por Host/Route/User |
| `FeatureService` | Activaci√≥n runtime de features por tier |
| `AgentOrchestrator` | Coordinaci√≥n de agentes IA |
| `EmbeddingService` | Generaci√≥n de vectores OpenAI |
| `QdrantMatchingClient` | B√∫squeda sem√°ntica h√≠brida |

### 3.5 Infraestructura DevOps

| Pipeline | Descripci√≥n |
|----------|-------------|
| **CI** | Linting (PHPCS) ‚Üí PHPStan (Level 5) ‚Üí Trivy ‚Üí PHPUnit |
| **Staging** | Auto-deploy on merge to `develop` |
| **Production** | Tag-triggered Blue-Green deploy |
| **Entornos** | Local (Lando), Staging, Production (IONOS) |

---

## 4. Arquitectura Funcional

### 4.1 Entidades de Negocio Core

| Entidad | Tipo | M√≥dulo | Prop√≥sito |
|---------|------|--------|-----------|
| `Vertical` | Content | core | Segmento de negocio |
| `SaasPlan` | Config | core | L√≠mites y features por tier |
| `Tenant` | Content | core | Organizaci√≥n cliente |
| `Feature` | Config | core | Capacidades activables |
| `AIAgent` | Config | core | Definici√≥n de agentes |
| `Productor` | Content | core | Usuario productivo del tenant |

### 4.2 Flujos de Automatizaci√≥n

| Blueprint | Prop√≥sito | Mecanismo | Estado |
|-----------|-----------|-----------|--------|
| ECA-LMS-001 | Auto-Enrollment Post-Diagn√≥stico | `DiagnosticEnrollmentService` | ‚úÖ |
| ECA-LMS-003 | Emisi√≥n de Certificado (Open Badge) | `_jaraba_lms_auto_issue_badge` | ‚úÖ |
| ECA-APP-001 | Nueva Aplicaci√≥n (Snapshot/Score) | `ApplicationNotificationService` | ‚úÖ |
| ECA-APP-003 | Contrataci√≥n Exitosa (Impacto) | `ImpactCreditService` | ‚úÖ |

### 4.3 Sistema de Permisos RBAC

| M√≥dulo | Permisos | Ejemplos |
|--------|----------|----------|
| **LMS** | 15 | administer lms, enroll others, issue certificates |
| **JOB BOARD** | 18 | feature job postings, manage job applications |
| **CANDIDATE** | 14 | build own cv, verify candidate profiles |
| **Total** | **47** | Sistema granular por entidad |

---

## 5. Arquitectura de Inteligencia Artificial

### 5.1 Framework de Orquestaci√≥n de Agentes

| Componente | Funci√≥n |
|------------|---------|
| `AgentOrchestrator` | Descubrimiento, rutado, gesti√≥n de contexto |
| `BaseAgent` | Brand Voice, Seasonal Intelligence, Provider Adapter |
| `ai_agent` Config Entity | Gesti√≥n Zero-Code desde UI |

### 5.2 Agentes Especializados

| Agente | Dominio |
|--------|---------|
| `StorytellingAgent` | Narrativas de producto |
| `MarketingAgent` | Campa√±as y contenido |
| `CustomerExperienceAgent` | Atenci√≥n al cliente |
| `CareerCoachAgent` | An√°lisis CV, preparaci√≥n entrevistas |
| `RecruiterAssistantAgent` | Screening, ranking, JD optimization |
| `LearningTutorAgent` | Dudas, motivaci√≥n, progreso |
| `SyntheticCFOAgent` | An√°lisis financiero |
| `ProducerCopilot` | Asistencia contextual |

### 5.3 Niveles de Autonom√≠a

| Nivel | Nombre | Comportamiento |
|-------|--------|----------------|
| **1** | Suggest | Sugiere acciones, requiere aprobaci√≥n |
| **2** | Assisted | Ejecuta con confirmaci√≥n |
| **3** | Supervised | Ejecuta y reporta |
| **4** | Autonomous | Ejecuta silenciosamente |
| **5** | Silent | Acci√≥n invisible |

### 5.4 RAG Knowledge Base (Qdrant)

| Caracter√≠stica | Implementaci√≥n |
|----------------|----------------|
| **Vector DB** | Qdrant 1.16 (1536D OpenAI) |
| **Indexaci√≥n** | Autom√°tica on entity_insert |
| **B√∫squeda** | H√≠brida (40% Semantic + 60% Rules) |

---

## 6. Arquitectura de Experiencia de Usuario

### 6.1 Sistema de Dise√±o (4 Capas)

| Capa | Nombre | Funci√≥n |
|------|--------|---------|
| **1** | ADN | SCSS Modular, estructura sem√°ntica |
| **2** | Control | Admin UI (color pickers, fonts) |
| **3** | Puente | `preprocess_html()` ‚Üí CSS Custom Properties |
| **4** | Render | `var(--ej-*)` en runtime |

### 6.2 Est√°ndares de Interfaz

| Est√°ndar | ID | Descripci√≥n |
|----------|---|-------------|
| Premium Iconography | 28.19 | 100 assets SVG |
| Vector i18n Verification | 28.19.1 | 100% texto traducible |
| Brand Visual Resonance | 28.20 | Coherencia visual cross-tenant |
| High-Fidelity Empty States | 28.6 | Estados vac√≠os con CTAs |
| RBAC Baseline | 28.5 | Acceso por roles |

---

## 7. Arquitectura SEO/GEO

### 7.1 Estrategia GEO (Generative Engine Optimization)

> **Objetivo**: "La IA vende por nosotros" v√≠a Answer Capsules y Schema.org

### 7.2 Implementaci√≥n T√©cnica GEO

| Elemento | Implementaci√≥n |
|----------|----------------|
| **Answer Capsules** | Res√∫menes estructurados para LLMs |
| **Schema.org** | JSON-LD en productos y organizaciones |
| **robots.txt** | 9 AI crawlers permitidos |
| **Templates GEO** | `commerce-product--geo.html.twig` (100% SSR) |

### 7.3 Crawlers IA Soportados

ChatGPT, ClaudeBot, PerplexityBot, Google-Extended, Amazonbot, Meta-ExternalAgent, YouBot, SearchGPT

---

## 8. Verticales de Negocio

### 8.1 Vertical: Empleabilidad Digital (Luc√≠a 45+)

| Aspecto | Estado |
|---------|--------|
| **Progreso** | 100% L√≥gica operativa |
| **M√≥dulos** | jaraba_lms, jaraba_job_board, jaraba_candidate, jaraba_matching |
| **Features** | LMS Video (xAPI), Job Board ATS, Matching H√≠brido, CV Builder, Open Badges 3.0, Gamificaci√≥n |

### 8.2 Vertical: Emprendimiento Digital (Javier)

| Aspecto | Estado |
|---------|--------|
| **Progreso** | ~40% (Fases 1-2 + Sprint 2 de Fase 3) |
| **M√≥dulos** | jaraba_diagnostic, jaraba_paths, jaraba_mentoring |
| **Features Operativas** | Diagn√≥stico Negocio, Itinerarios Digitalizaci√≥n, Mentoring (Jitsi) |
| **Pendiente** | Business Model Canvas, MVP Validation, Comunidad |

---

## 9. Estado de Madurez y Roadmap

### 9.1 Nivel de Madurez Arquitect√≥nica

| Nivel | Estado |
|-------|--------|
| **5.0 / 5.0** | CERTIFICADO (Ene 2026) |
| Infraestructura | 100% declarativa |
| Self-healing | Validado (Multi Game Days) |
| AIOps | Predictivo activo |
| MTTR | Reducido 95% |

### 9.2 Roadmap Q1 2027

| Iniciativa | Estado |
|------------|--------|
| PLG 2.0 | ‚úÖ |
| API-First | ‚úÖ |
| Mobile-First (PWA) | ‚úÖ |
| Auto-Learning IA | üîÑ |
| Matching Sem√°ntico | ‚úÖ |
| Open Badges 3.0 | ‚úÖ |

---

## 10. Registro de Cambios

| Fecha | Versi√≥n | Descripci√≥n |
|-------|---------|-------------|
| 2026-01-19 | 1.0.0 | Creaci√≥n inicial - Mapeo arquitect√≥nico integral desde 6 perspectivas |

---

> **Documento generado:** 2026-01-19  
> **Nivel de Certificaci√≥n:** 5.0/5.0 Arquitectura Adaptativa
