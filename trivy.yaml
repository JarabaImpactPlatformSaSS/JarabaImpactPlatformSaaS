# Trivy Configuration File
# ═══════════════════════════════════════════════════════════════════

# Escaneo de sistema de archivos
scan:
  type: 'fs'
  ref: '.'

# Scanners activos
scanners:
  - vuln
  - secret

# Configuración de vulnerabilidades
vulnerability:
  ignore-policy: .trivyignore

# Gravedad que bloquea la build
severity:
  - HIGH
  - CRITICAL

# Exclusiones de directorios
# Excluimos dependencias de terceros (Drupal core, contrib, vendor, node_modules)
# ya que sus vulnerabilidades no son controlables por nuestro codigo.
# Nuestros modulos custom (web/modules/custom/*) SI se escanean.
exclude-dirs:
  - web/core
  - web/modules/contrib
  - vendor
  - node_modules
  - .git

# Exclusiones de archivos específicos
exclude-files:
  - web/modules/contrib/commerce_stripe/.cspell-project-words.txt
  - .trivyignore
  - trivy.yaml

# Configuración de secretos
secret:
  # Reglas de excepción para secretos
  allow-rules:
    - id: stripe-secret-token
    - id: generic-api-key
