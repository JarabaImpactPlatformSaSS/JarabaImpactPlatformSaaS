--- a/src/Provider/LinkedIn.php	2026-02-25 13:29:58.335377657 +0100
+++ b/src/Provider/LinkedIn.php	2026-02-25 13:30:24.931170145 +0100
@@ -2,68 +2,29 @@
 
 namespace League\OAuth2\Client\Provider;
 
-use Exception;
-use InvalidArgumentException;
 use League\OAuth2\Client\Grant\AbstractGrant;
 use League\OAuth2\Client\Provider\Exception\IdentityProviderException;
-use League\OAuth2\Client\Provider\Exception\LinkedInAccessDeniedException;
 use League\OAuth2\Client\Token\AccessToken;
 use League\OAuth2\Client\Token\LinkedInAccessToken;
 use League\OAuth2\Client\Tool\BearerAuthorizationTrait;
 use Psr\Http\Message\ResponseInterface;
 
+/**
+ * LinkedIn OAuth 2.0 provider using OpenID Connect.
+ */
 class LinkedIn extends AbstractProvider
 {
     use BearerAuthorizationTrait;
 
     /**
-     * Default scopes
+     * Default scopes - OpenID Connect.
      *
      * @var array
      */
-    public $defaultScopes = ['r_liteprofile', 'r_emailaddress'];
+    public $defaultScopes = ['openid', 'profile', 'email'];
 
     /**
-     * Requested fields in scope, seeded with default values
-     *
-     * @var array
-     * @see https://developer.linkedin.com/docs/fields/basic-profile
-     */
-    protected $fields = [
-        'id', 'firstName', 'lastName', 'localizedFirstName', 'localizedLastName',
-        'profilePicture(displayImage~:playableStreams)',
-    ];
-
-    /**
-     * Constructs an OAuth 2.0 service provider.
-     *
-     * @param array $options An array of options to set on this provider.
-     *     Options include `clientId`, `clientSecret`, `redirectUri`, and `state`.
-     *     Individual providers may introduce more options, as needed.
-     * @param array $collaborators An array of collaborators that may be used to
-     *     override this provider's default behavior. Collaborators include
-     *     `grantFactory`, `requestFactory`, and `httpClient`.
-     *     Individual providers may introduce more collaborators, as needed.
-     */
-    public function __construct(array $options = [], array $collaborators = [])
-    {
-        if (isset($options['fields']) && !is_array($options['fields'])) {
-            throw new InvalidArgumentException('The fields option must be an array');
-        }
-
-        parent::__construct($options, $collaborators);
-    }
-
-
-    /**
-     * Creates an access token from a response.
-     *
-     * The grant that was used to fetch the response can be used to provide
-     * additional context.
-     *
-     * @param  array $response
-     * @param  AbstractGrant $grant
-     * @return AccessTokenInterface
+     * {@inheritdoc}
      */
     protected function createAccessToken(array $response, AbstractGrant $grant)
     {
@@ -71,9 +32,7 @@
     }
 
     /**
-     * Get the string used to separate scopes.
-     *
-     * @return string
+     * {@inheritdoc}
      */
     protected function getScopeSeparator()
     {
@@ -81,9 +40,7 @@
     }
 
     /**
-     * Get authorization url to begin OAuth flow
-     *
-     * @return string
+     * {@inheritdoc}
      */
     public function getBaseAuthorizationUrl()
     {
@@ -91,9 +48,7 @@
     }
 
     /**
-     * Get access token url to retrieve token
-     *
-     * @return string
+     * {@inheritdoc}
      */
     public function getBaseAccessTokenUrl(array $params)
     {
@@ -101,45 +56,15 @@
     }
 
     /**
-     * Get provider url to fetch user details
-     *
-     * @param  AccessToken $token
-     *
-     * @return string
+     * {@inheritdoc}
      */
     public function getResourceOwnerDetailsUrl(AccessToken $token)
     {
-        $query = http_build_query([
-            'projection' => '(' . implode(',', $this->fields) . ')'
-        ]);
-
-        return 'https://api.linkedin.com/v2/me?' . urldecode($query);
+        return 'https://api.linkedin.com/v2/userinfo';
     }
 
     /**
-     * Get provider url to fetch user details
-     *
-     * @param  AccessToken $token
-     *
-     * @return string
-     */
-    public function getResourceOwnerEmailUrl(AccessToken $token)
-    {
-        $query = http_build_query([
-            'q' => 'members',
-            'projection' => '(elements*(state,primary,type,handle~))'
-        ]);
-
-        return 'https://api.linkedin.com/v2/clientAwareMemberHandles?' . urldecode($query);
-    }
-
-    /**
-     * Get the default scopes used by this provider.
-     *
-     * This should not be a complete list of all scopes, but the minimum
-     * required for the provider user interface!
-     *
-     * @return array
+     * {@inheritdoc}
      */
     protected function getDefaultScopes()
     {
@@ -147,18 +72,10 @@
     }
 
     /**
-     * Check a provider response for errors.
-     *
-     * @param  ResponseInterface $response
-     * @param  array $data Parsed response data
-     * @return void
-     * @throws IdentityProviderException
-     * @see https://developer.linkedin.com/docs/guide/v2/error-handling
+     * {@inheritdoc}
      */
     protected function checkResponse(ResponseInterface $response, $data)
     {
-        $this->checkResponseUnauthorized($response, $data);
-
         if ($response->getStatusCode() >= 400) {
             throw new IdentityProviderException(
                 isset($data['message']) ? $data['message'] : $response->getReasonPhrase(),
@@ -169,108 +86,18 @@
     }
 
     /**
-     * Check a provider response for unauthorized errors.
-     *
-     * @param  ResponseInterface $response
-     * @param  array $data Parsed response data
-     * @return void
-     * @throws LinkedInAccessDeniedException
-     * @see https://developer.linkedin.com/docs/guide/v2/error-handling
-     */
-    protected function checkResponseUnauthorized(ResponseInterface $response, $data)
-    {
-        if (isset($data['status']) && $data['status'] === 403) {
-            throw new LinkedInAccessDeniedException(
-                isset($data['message']) ? $data['message'] : $response->getReasonPhrase(),
-                isset($data['status']) ? $data['status'] : $response->getStatusCode(),
-                $response
-            );
-        }
-    }
-
-    /**
-     * Generate a user object from a successful user details request.
-     *
-     * @param array $response
-     * @param AccessToken $token
-     * @return LinkedInResourceOwner
+     * {@inheritdoc}
      */
     protected function createResourceOwner(array $response, AccessToken $token)
     {
-        // If current accessToken is not authorized with r_emailaddress scope,
-        // getResourceOwnerEmail will throw LinkedInAccessDeniedException, it will be caught here,
-        // and then the email will be set to null
-        // When email is not available due to chosen scopes, other providers simply set it to null, let's do the same.
-        try {
-            $email = $this->getResourceOwnerEmail($token);
-        } catch (LinkedInAccessDeniedException $exception) {
-            $email = null;
-        }
-        $response['email'] = $email;
         return new LinkedInResourceOwner($response);
     }
 
     /**
-     * Returns the requested fields in scope.
-     *
-     * @return array
+     * {@inheritdoc}
      */
-    public function getFields()
+    public function getState()
     {
-        return $this->fields;
-    }
-
-    /**
-     * Attempts to fetch resource owner's email address via separate API request.
-     *
-     * @param  AccessToken $token [description]
-     * @return string|null
-     * @throws IdentityProviderException
-     */
-    public function getResourceOwnerEmail(AccessToken $token)
-    {
-        $emailUrl = $this->getResourceOwnerEmailUrl($token);
-        $emailRequest = $this->getAuthenticatedRequest(self::METHOD_GET, $emailUrl, $token);
-        $emailResponse = $this->getParsedResponse($emailRequest);
-
-        return $this->extractEmailFromResponse($emailResponse);
-    }
-
-    /**
-     * Updates the requested fields in scope.
-     *
-     * @param  array   $fields
-     *
-     * @return LinkedIn
-     */
-    public function withFields(array $fields)
-    {
-        $this->fields = $fields;
-
-        return $this;
-    }
-
-    /**
-     * Attempts to extract the email address from a valid email api response.
-     *
-     * @param  array  $response
-     * @return string|null
-     */
-    protected function extractEmailFromResponse($response = [])
-    {
-        try {
-            $confirmedEmails = array_filter($response['elements'], function ($element) {
-                return
-                    strtoupper($element['type']) === 'EMAIL'
-                    && strtoupper($element['state']) === 'CONFIRMED'
-                    && $element['primary'] === true
-                    && isset($element['handle~']['emailAddress'])
-                ;
-            });
-
-            return $confirmedEmails[0]['handle~']['emailAddress'];
-        } catch (Exception $e) {
-            return null;
-        }
+        return $this->state;
     }
 }
--- a/src/Provider/LinkedInResourceOwner.php	2026-02-25 13:30:08.111983363 +0100
+++ b/src/Provider/LinkedInResourceOwner.php	2026-02-25 13:30:24.931170145 +0100
@@ -1,50 +1,42 @@
-<?php namespace League\OAuth2\Client\Provider;
+<?php
+
+namespace League\OAuth2\Client\Provider;
 
 use League\OAuth2\Client\Tool\ArrayAccessorTrait;
 
 /**
- * @property array $response
- * @property string $uid
+ * LinkedIn resource owner using OpenID Connect userinfo response.
+ *
+ * Response format from /v2/userinfo:
+ * {
+ *   "sub": "...",
+ *   "name": "First Last",
+ *   "given_name": "First",
+ *   "family_name": "Last",
+ *   "picture": "https://...",
+ *   "email": "user@example.com",
+ *   "email_verified": true
+ * }
  */
 class LinkedInResourceOwner extends GenericResourceOwner
 {
-
     use ArrayAccessorTrait;
 
     /**
-     * Raw response
-     *
      * @var array
      */
     protected $response = [];
 
     /**
-     * Sorted profile pictures
-     *
-     * @var array
-     */
-    protected $sortedProfilePictures = [];
-
-    /**
-     * @var string|null
-     */
-    private $email;
-
-    /**
      * Creates new resource owner.
-     *
-     * @param array  $response
      */
-    public function __construct(array $response = array())
+    public function __construct(array $response = [])
     {
         $this->response = $response;
-        $this->setSortedProfilePictures();
     }
 
     /**
-     * Gets resource owner attribute by key. The key supports dot notation.
-     *
-     * @return mixed
+     * Gets resource owner attribute by key.
      */
     public function getAttribute($key)
     {
@@ -52,153 +44,55 @@
     }
 
     /**
-     * Get user first name
-     *
-     * @return string|null
+     * Get user first name.
      */
     public function getFirstName()
     {
-        return $this->getAttribute('localizedFirstName');
+        return $this->getAttribute('given_name');
     }
 
     /**
-     * Get user user id
-     *
-     * @return string|null
+     * Get user id (OpenID Connect "sub" claim).
      */
     public function getId()
     {
-        return $this->getAttribute('id');
+        return $this->getAttribute('sub');
     }
 
     /**
-     * Get specific image by size
-     *
-     * @param integer $size
-     * @return array|null
-     */
-    public function getImageBySize($size)
-    {
-        $pictures = array_filter($this->sortedProfilePictures, function ($picture) use ($size) {
-            return isset($picture['width']) && $picture['width'] == $size;
-        });
-
-        return count($pictures) ? $pictures[0] : null;
-    }
-
-    /**
-     * Get available user image sizes
-     *
-     * @return array
-     */
-    public function getImageSizes()
-    {
-        return array_map(function ($picture) {
-            return $this->getValueByKey($picture, 'width');
-        }, $this->sortedProfilePictures);
-    }
-
-    /**
-     * Get user image url
-     *
-     * @return string|null
+     * Get user image url.
      */
     public function getImageUrl()
     {
-        $pictures = $this->getSortedProfilePictures();
-        $picture = array_pop($pictures);
-
-        return $picture ? $this->getValueByKey($picture, 'url') : null;
+        return $this->getAttribute('picture');
     }
 
     /**
-     * Get user last name
-     *
-     * @return string|null
+     * Get user last name.
      */
     public function getLastName()
     {
-        return $this->getAttribute('localizedLastName');
+        return $this->getAttribute('family_name');
     }
 
     /**
-     * Returns the sorted collection of profile pictures.
-     *
-     * @return array
+     * Get user email.
      */
-    public function getSortedProfilePictures()
+    public function getEmail()
     {
-        return $this->sortedProfilePictures;
+        return $this->getAttribute('email');
     }
 
     /**
-     * Get user url
-     *
-     * @return string|null
+     * Get user url (not available via OpenID Connect).
      */
     public function getUrl()
     {
-        $vanityName = $this->getAttribute('vanityName');
-
-        return $vanityName ? sprintf('https://www.linkedin.com/in/%s', $vanityName) : null;
-    }
-
-    /**
-     * Get user email, if available
-     *
-     * @return string|null
-     */
-    public function getEmail()
-    {
-        return $this->getAttribute('email');
-    }
-
-    /**
-     * Attempts to sort the collection of profile pictures included in the profile
-     * before caching them in the resource owner instance.
-     *
-     * @return void
-     */
-    private function setSortedProfilePictures()
-    {
-        $pictures = $this->getAttribute('profilePicture.displayImage~.elements');
-        if (is_array($pictures)) {
-            $pictures = array_filter($pictures, function ($element) {
-                // filter to public images only
-                return
-                    isset($element['data']['com.linkedin.digitalmedia.mediaartifact.StillImage'])
-                    && strtoupper($element['authorizationMethod']) === 'PUBLIC'
-                    && isset($element['identifiers'][0]['identifier'])
-                ;
-            });
-            // order images by width, LinkedIn profile pictures are always squares, so that should be good enough
-            usort($pictures, function ($elementA, $elementB) {
-                $wA = $elementA['data']['com.linkedin.digitalmedia.mediaartifact.StillImage']['storageSize']['width'];
-                $wB = $elementB['data']['com.linkedin.digitalmedia.mediaartifact.StillImage']['storageSize']['width'];
-                return $wA - $wB;
-            });
-            $pictures = array_map(function ($element) {
-                // this is an URL, no idea how many of identifiers there can be, so take the first one.
-                $url = $element['identifiers'][0]['identifier'];
-                $type = $element['identifiers'][0]['mediaType'];
-                $width = $element['data']['com.linkedin.digitalmedia.mediaartifact.StillImage']['storageSize']['width'];
-                return [
-                    'width' => $width,
-                    'url' => $url,
-                    'contentType' => $type,
-                ];
-            }, $pictures);
-        } else {
-            $pictures = [];
-        }
-
-        $this->sortedProfilePictures = $pictures;
+        return null;
     }
 
     /**
      * Return all of the owner details available as an array.
-     *
-     * @return array
      */
     public function toArray()
     {
